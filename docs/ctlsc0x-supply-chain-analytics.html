<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 CTLSC0x - Supply Chain Analytics | A CTLSCx Exercises in R</title>
  <meta name="description" content="Trying to learn NERD Network design ?" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 CTLSC0x - Supply Chain Analytics | A CTLSCx Exercises in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/Eduardodudu/CTLSCx" />
  
  <meta property="og:description" content="Trying to learn NERD Network design ?" />
  <meta name="github-repo" content="Eduardodudu/CTLSCx" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 CTLSC0x - Supply Chain Analytics | A CTLSCx Exercises in R" />
  
  <meta name="twitter:description" content="Trying to learn NERD Network design ?" />
  

<meta name="author" content="Eduardo Almeida" />


<meta name="date" content="2019-07-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="ctlsc0x-supply-chain-analytics.html"><a href="ctlsc0x-supply-chain-analytics.html"><i class="fa fa-check"></i><b>1</b> CTLSC0x - Supply Chain Analytics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ctlsc0x-supply-chain-analytics.html"><a href="ctlsc0x-supply-chain-analytics.html#week2---unconstrained-constrained-optimization"><i class="fa fa-check"></i><b>1.1</b> Week2 - Unconstrained &amp; Constrained Optimization</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="ctlsc0x-supply-chain-analytics.html"><a href="ctlsc0x-supply-chain-analytics.html#recitation"><i class="fa fa-check"></i><b>1.1.1</b> Recitation</a></li>
<li class="chapter" data-level="1.1.2" data-path="ctlsc0x-supply-chain-analytics.html"><a href="ctlsc0x-supply-chain-analytics.html#practice-problems"><i class="fa fa-check"></i><b>1.1.2</b> Practice Problems</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="ctlsc0x-supply-chain-analytics.html"><a href="ctlsc0x-supply-chain-analytics.html#week3---ips-milps-network-design"><i class="fa fa-check"></i><b>1.2</b> Week3 - IPs, MILPs &amp; Network Design</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ctlsc0x-supply-chain-analytics.html"><a href="ctlsc0x-supply-chain-analytics.html#lesson-1---ips-milps"><i class="fa fa-check"></i><b>1.2.1</b> Lesson 1 - IPs &amp; MILPs</a></li>
<li class="chapter" data-level="1.2.2" data-path="ctlsc0x-supply-chain-analytics.html"><a href="ctlsc0x-supply-chain-analytics.html#recitations"><i class="fa fa-check"></i><b>1.2.2</b> Recitations</a></li>
<li class="chapter" data-level="1.2.3" data-path="ctlsc0x-supply-chain-analytics.html"><a href="ctlsc0x-supply-chain-analytics.html#practice-problems-1"><i class="fa fa-check"></i><b>1.2.3</b> Practice Problems</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ctlsc0x-supply-chain-analytics.html"><a href="ctlsc0x-supply-chain-analytics.html#week4---algorithms-approximations"><i class="fa fa-check"></i><b>1.3</b> Week4 - Algorithms &amp; Approximations</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ctlsc0x-supply-chain-analytics.html"><a href="ctlsc0x-supply-chain-analytics.html#lesson-1---algorithms"><i class="fa fa-check"></i><b>1.3.1</b> Lesson 1 - Algorithms</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A CTLSCx Exercises in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ctlsc0x---supply-chain-analytics" class="section level1" number="1">
<h1><span class="header-section-number">Chapter 1</span> CTLSC0x - Supply Chain Analytics</h1>
<div id="week2---unconstrained-constrained-optimization" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Week2 - Unconstrained &amp; Constrained Optimization</h2>
<div id="recitation" class="section level3" number="1.1.1">
<h3><span class="header-section-number">1.1.1</span> Recitation</h3>
<div id="unconstrained" class="section level4" number="1.1.1.1">
<h4><span class="header-section-number">1.1.1.1</span> Unconstrained</h4>
<p>Straigthforward exercises in modeling optimization without index vectors.</p>
<p><span class="math display">\[
\textbf{Equation 1:} \ \ Minimze \ \ y = x^2+2*x-3
\]</span></p>
<p>Since is an unconstrained quadratic optimization with a single variable, base R package optimizer can solve it</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="ctlsc0x-supply-chain-analytics.html#cb1-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){x<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>x<span class="dv">-3</span>}</span>
<span id="cb1-2"><a href="ctlsc0x-supply-chain-analytics.html#cb1-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">optimize</span>(f,<span class="at">interval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>), <span class="at">maximum =</span> F)</span>
<span id="cb1-3"><a href="ctlsc0x-supply-chain-analytics.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## $minimum
## [1] -1
## 
## $objective
## [1] -4</code></pre>
<p>Let’s check the result in the plot</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="ctlsc0x-supply-chain-analytics.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Data created for plot, using mutate on the function</span></span>
<span id="cb3-2"><a href="ctlsc0x-supply-chain-analytics.html#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb3-3"><a href="ctlsc0x-supply-chain-analytics.html#cb3-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="ctlsc0x-supply-chain-analytics.html#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">f</span>(x))</span>
<span id="cb3-5"><a href="ctlsc0x-supply-chain-analytics.html#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="ctlsc0x-supply-chain-analytics.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Ploting with a marker on the optimal solution</span></span>
<span id="cb3-7"><a href="ctlsc0x-supply-chain-analytics.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(data, <span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>y, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="ctlsc0x-supply-chain-analytics.html#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>(<span class="at">y =</span> result<span class="sc">$</span>objective, <span class="at">x =</span> result<span class="sc">$</span>minimum)</span></code></pre></div>
<div id="htmlwidget-7ab4f44605c56ab9b4b2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-7ab4f44605c56ab9b4b2">{"x":{"visdat":{"3a5061423210":["function () ","plotlyVisDat"]},"cur_data":"3a5061423210","attrs":{"3a5061423210":{"x":{},"y":{},"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3a5061423210.1":{"x":-1,"y":-4,"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"x"},"yaxis":{"domain":[0,1],"automargin":true,"title":"y"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10],"y":[77,60,45,32,21,12,5,0,-3,-4,-3,0,5,12,21,32,45,60,77,96,117],"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-1],"y":[-4],"mode":"markers","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><span class="math display">\[
\textbf{Equation 2:} \ \ Maximize \ \ z =-x^2+2*x-y^2
\]</span></p>
<p>In this equation there is 2 variables, for this case it can be used the base R package optim.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="ctlsc0x-supply-chain-analytics.html#cb4-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){<span class="sc">-</span>x[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>x[<span class="dv">1</span>]<span class="sc">-</span>x[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>}</span>
<span id="cb4-2"><a href="ctlsc0x-supply-chain-analytics.html#cb4-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), f)</span>
<span id="cb4-3"><a href="ctlsc0x-supply-chain-analytics.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## $par
## [1]  4996334736823209367660028284644608202640064886266268428
## [2] 26841715791435261610666442462228268624462880624020808440
## 
## $value
## [1] -745441067430571406480480462840082246886080068688280484046020260262848202268640042268242440482008024480008626200
## 
## $counts
## function gradient 
##      501       NA 
## 
## $convergence
## [1] 1
## 
## $message
## NULL</code></pre>
</div>
<div id="constrained" class="section level4" number="1.1.1.2">
<h4><span class="header-section-number">1.1.1.2</span> Constrained</h4>
<div id="banner-chemicals" class="section level5" number="1.1.1.2.1">
<h5><span class="header-section-number">1.1.1.2.1</span> Banner Chemicals</h5>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="ctlsc0x-supply-chain-analytics.html#cb6-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;Profit&quot;</span>,<span class="st">&quot;Plant&quot;</span>,<span class="st">&quot;Additive A&quot;</span>, <span class="st">&quot;Additive B&quot;</span>), <span class="at">High =</span> <span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>),</span>
<span id="cb6-2"><a href="ctlsc0x-supply-chain-analytics.html#cb6-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Supreme =</span> <span class="fu">c</span>(<span class="dv">200</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">Capacity =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">110</span>, <span class="dv">300</span>, <span class="dv">280</span>))</span>
<span id="cb6-3"><a href="ctlsc0x-supply-chain-analytics.html#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="ctlsc0x-supply-chain-analytics.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Banner Chemicals&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-5">Table 1.1: </span>Banner Chemicals
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
High
</th>
<th style="text-align:right;">
Supreme
</th>
<th style="text-align:right;">
Capacity
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Profit
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Plant
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
110
</td>
</tr>
<tr>
<td style="text-align:left;">
Additive A
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
300
</td>
</tr>
<tr>
<td style="text-align:left;">
Additive B
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
280
</td>
</tr>
</tbody>
</table>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Maximize} &amp; \ y = \sum_{i\in M}^{ }p_i\cdot x_i \\
\textbf{subject to}\\
    &amp; \sum_{i\in M} x_i \le\ C \\
    &amp; \sum_{i\in M} a_{i,j} \cdot x_i \le\ A_j, \ \ \forall j \in N \\
    &amp; x_i \ge 0 \\
    \\
    
\textbf{Where} \\

&amp; i = \text{Products in M} \\
&amp; j = \text{Additives in N} \\
&amp; p_i = \text{Profit margin for product i} \\
&amp; C = \text{Plant capacity} \\
&amp; A_j = \text{Additive j available} \\
&amp; a_{i,j} = \text{Quantity of additive j required per barrel of product i} \\
&amp; x_i = \text{Quantity of product i to produce} \\

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="ctlsc0x-supply-chain-analytics.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb7-2"><a href="ctlsc0x-supply-chain-analytics.html#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="ctlsc0x-supply-chain-analytics.html#cb7-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of products High and Supreme</span></span>
<span id="cb7-4"><a href="ctlsc0x-supply-chain-analytics.html#cb7-4" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fu">filter</span>(data, Type <span class="sc">==</span> <span class="st">&quot;Plant&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Capacity) <span class="sc">%&gt;%</span> .<span class="sc">$</span>Capacity</span>
<span id="cb7-5"><a href="ctlsc0x-supply-chain-analytics.html#cb7-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">filter</span>(data, Type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Additive A&quot;</span>,<span class="st">&quot;Additive B&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(High, Supreme))</span>
<span id="cb7-6"><a href="ctlsc0x-supply-chain-analytics.html#cb7-6" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">filter</span>(data, Type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Additive A&quot;</span>,<span class="st">&quot;Additive B&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Capacity) <span class="sc">%&gt;%</span> .<span class="sc">$</span>Capacity</span>
<span id="cb7-7"><a href="ctlsc0x-supply-chain-analytics.html#cb7-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">filter</span>(data, Type <span class="sc">==</span> <span class="st">&quot;Profit&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(High, Supreme) <span class="sc">%&gt;%</span> <span class="fu">gather</span>() <span class="sc">%&gt;%</span> .<span class="sc">$</span>value</span>
<span id="cb7-8"><a href="ctlsc0x-supply-chain-analytics.html#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="ctlsc0x-supply-chain-analytics.html#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="ctlsc0x-supply-chain-analytics.html#cb7-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="ctlsc0x-supply-chain-analytics.html#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of profit</span></span>
<span id="cb7-12"><a href="ctlsc0x-supply-chain-analytics.html#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-13"><a href="ctlsc0x-supply-chain-analytics.html#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="ctlsc0x-supply-chain-analytics.html#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># minimize travel distance</span></span>
<span id="cb7-15"><a href="ctlsc0x-supply-chain-analytics.html#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(p[i]<span class="sc">*</span>x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-16"><a href="ctlsc0x-supply-chain-analytics.html#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="ctlsc0x-supply-chain-analytics.html#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># you cannot exceed the Plant Capacity</span></span>
<span id="cb7-18"><a href="ctlsc0x-supply-chain-analytics.html#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> C) <span class="sc">%&gt;%</span></span>
<span id="cb7-19"><a href="ctlsc0x-supply-chain-analytics.html#cb7-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-20"><a href="ctlsc0x-supply-chain-analytics.html#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#You cannot exceed aditivie capacity</span></span>
<span id="cb7-21"><a href="ctlsc0x-supply-chain-analytics.html#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i] <span class="sc">*</span> a[j,i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> A[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb7-22"><a href="ctlsc0x-supply-chain-analytics.html#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="ctlsc0x-supply-chain-analytics.html#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#How to check for the constraints</span></span>
<span id="cb7-24"><a href="ctlsc0x-supply-chain-analytics.html#cb7-24" aria-hidden="true" tabindex="-1"></a>model<span class="sc">$</span>constraints</span></code></pre></div>
<pre><code>## [[1]]
## $lhs
## expression(x[1L] + x[2L])
## 
## $sense
## [1] &quot;&lt;=&quot;
## 
## $rhs
## expression(110)
## 
## attr(,&quot;class&quot;)
## [1] &quot;model_constraint&quot;
## 
## [[2]]
## $lhs
## expression(c(High = 3) * x[1L] + c(Supreme = 2) * x[2L])
## 
## $sense
## [1] &quot;&lt;=&quot;
## 
## $rhs
## expression(300)
## 
## attr(,&quot;class&quot;)
## [1] &quot;model_constraint&quot;
## 
## [[3]]
## $lhs
## expression(x[1L] * c(High = 1) + c(Supreme = 3) * x[2L])
## 
## $sense
## [1] &quot;&lt;=&quot;
## 
## $rhs
## expression(280)
## 
## attr(,&quot;class&quot;)
## [1] &quot;model_constraint&quot;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="ctlsc0x-supply-chain-analytics.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#How to check for the Objective</span></span>
<span id="cb9-2"><a href="ctlsc0x-supply-chain-analytics.html#cb9-2" aria-hidden="true" tabindex="-1"></a>model<span class="sc">$</span>objective </span></code></pre></div>
<pre><code>## $expression
## expression(80 * x[1L] + 200 * x[2L])
## 
## $original_expression
## expression(sum_expr(p[i] * x[i], i = 1:n))
## 
## $sense
## [1] &quot;max&quot;
## 
## attr(,&quot;class&quot;)
## [1] &quot;model_objective&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="ctlsc0x-supply-chain-analytics.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb11-2"><a href="ctlsc0x-supply-chain-analytics.html#cb11-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## &lt;SOLVER MSG&gt;  ----
## GLPK Simplex Optimizer, v4.47
## 3 rows, 2 columns, 6 non-zeros
## *     0: obj =  0.000000000e+000  infeas = 0.000e+000 (0)
## *     2: obj =  1.900000000e+004  infeas = 0.000e+000 (0)
## OPTIMAL SOLUTION FOUND
## GLPK Integer Optimizer, v4.47
## 3 rows, 2 columns, 6 non-zeros
## 2 integer variables, none of which are binary
## Integer optimization begins...
## +     2: mip =     not found yet &lt;=              +inf        (1; 0)
## +     2: &gt;&gt;&gt;&gt;&gt;  1.900000000e+004 &lt;=  1.900000000e+004   0.0% (1; 0)
## +     2: mip =  1.900000000e+004 &lt;=     tree is empty   0.0% (0; 1)
## INTEGER OPTIMAL SOLUTION FOUND
## &lt;!SOLVER MSG&gt; ----</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="ctlsc0x-supply-chain-analytics.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb13-2"><a href="ctlsc0x-supply-chain-analytics.html#cb13-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 19000</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="ctlsc0x-supply-chain-analytics.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb15-2"><a href="ctlsc0x-supply-chain-analytics.html#cb15-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] 
##   25   85</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="ctlsc0x-supply-chain-analytics.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Duals</span></span>
<span id="cb17-2"><a href="ctlsc0x-supply-chain-analytics.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#get_column_duals(result) Not working</span></span></code></pre></div>
</div>
</div>
</div>
<div id="practice-problems" class="section level3" number="1.1.2">
<h3><span class="header-section-number">1.1.2</span> Practice Problems</h3>
<div id="handmade-baskets" class="section level4" number="1.1.2.1">
<h4><span class="header-section-number">1.1.2.1</span> Handmade Baskets</h4>
<p><span class="math display">\[
P = (x/73)^2-(x/95)+0.92
\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="ctlsc0x-supply-chain-analytics.html#cb18-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="cf">function</span>(x){(x<span class="sc">/</span><span class="dv">73</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">-</span>(x<span class="sc">/</span><span class="dv">95</span>)<span class="sc">+</span><span class="fl">0.92</span>}</span>
<span id="cb18-2"><a href="ctlsc0x-supply-chain-analytics.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="ctlsc0x-supply-chain-analytics.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Data created for plot, using mutate on the function</span></span>
<span id="cb18-4"><a href="ctlsc0x-supply-chain-analytics.html#cb18-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">1</span>)</span>
<span id="cb18-5"><a href="ctlsc0x-supply-chain-analytics.html#cb18-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="ctlsc0x-supply-chain-analytics.html#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">P</span>(x))</span>
<span id="cb18-7"><a href="ctlsc0x-supply-chain-analytics.html#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="ctlsc0x-supply-chain-analytics.html#cb18-8" aria-hidden="true" tabindex="-1"></a>min <span class="ot">=</span> data[data<span class="sc">$</span>y <span class="sc">==</span> <span class="fu">min</span>(data<span class="sc">$</span>y),] <span class="co">#cheating :P</span></span>
<span id="cb18-9"><a href="ctlsc0x-supply-chain-analytics.html#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="ctlsc0x-supply-chain-analytics.html#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Ploting with a marker on the optimal solution</span></span>
<span id="cb18-11"><a href="ctlsc0x-supply-chain-analytics.html#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(data, <span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>y, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="ctlsc0x-supply-chain-analytics.html#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>(<span class="at">y =</span> min<span class="sc">$</span>y, <span class="at">x =</span> min<span class="sc">$</span>x)</span></code></pre></div>
<div id="htmlwidget-63b311b8228ff8c4164b" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-63b311b8228ff8c4164b">{"x":{"visdat":{"3a50585430ef":["function () ","plotlyVisDat"]},"cur_data":"3a50585430ef","attrs":{"3a50585430ef":{"x":{},"y":{},"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3a50585430ef.1":{"x":28,"y":0.772382692516617,"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"x"},"yaxis":{"domain":[0,1],"automargin":true,"title":"y"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-100,-99,-98,-97,-96,-95,-94,-93,-92,-91,-90,-89,-88,-87,-86,-85,-84,-83,-82,-81,-80,-79,-78,-77,-76,-75,-74,-73,-72,-71,-70,-69,-68,-67,-66,-65,-64,-63,-62,-61,-60,-59,-58,-57,-56,-55,-54,-53,-52,-51,-50,-49,-48,-47,-46,-45,-44,-43,-42,-41,-40,-39,-38,-37,-36,-35,-34,-33,-32,-31,-30,-29,-28,-27,-26,-25,-24,-23,-22,-21,-20,-19,-18,-17,-16,-15,-14,-13,-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200],"y":[3.84915625524686,3.80128709839903,3.75379324648645,3.70667469950914,3.65993145746709,3.61356352036029,3.56757088818876,3.52195356095248,3.47671153865147,3.43184482128572,3.38735340885522,3.34323730135999,3.29949649880001,3.2561310011753,3.21314080848584,3.17052592073165,3.12828633791271,3.08642206002904,3.04493308708062,3.00381941906747,2.96308105598957,2.92271799784693,2.88273024463956,2.84311779636744,2.80388065303059,2.76501881462899,2.72653228116266,2.68842105263158,2.65068512903576,2.61332451037521,2.57633919664991,2.53972918785987,2.5034944840051,2.46763508508558,2.43215099110132,2.39704220205233,2.36230871793859,2.32795053876011,2.29396766451689,2.26036009520894,2.22712783083624,2.1942708713988,2.16178921689662,2.12968286732971,2.09795182269805,2.06659608300165,2.03561564824051,2.00501051841463,1.97478069352401,1.94492617356866,1.91544695854856,1.88634304846372,1.85761444331414,1.82926114309982,1.80128314782076,1.77368045747696,1.74645307206842,1.71960099159514,1.69312421605713,1.66702274545437,1.64129657978687,1.61594571905463,1.59097016325765,1.56636991239593,1.54214496646947,1.51829532547827,1.49482098942233,1.47172195830165,1.44899823211623,1.42664981086607,1.40467669455116,1.38307888317152,1.36185637672714,1.34100917521802,1.32053727864416,1.30044068700556,1.28071940030222,1.26137341853414,1.24240274170132,1.22380736980376,1.20558730284145,1.18774254081441,1.17027308372263,1.15317893156611,1.13646008434485,1.12011654205884,1.1041483047081,1.08855537229262,1.0733377448124,1.05849542226743,1.04402840465773,1.02993669198329,1.01622028424411,1.00287918144018,0.98991338357152,0.977322890638117,0.965107702639974,0.953267819577091,0.941803241449467,0.930713968257104,0.92,0.909661336678156,0.899697978291572,0.890109924840249,0.880897176324185,0.87205973274338,0.863597594097836,0.855510760387552,0.847799231612527,0.840463007772763,0.833502088868258,0.826916474899013,0.820706165865029,0.814871161766304,0.809411462602839,0.804327068374633,0.799617979081688,0.795284194724003,0.791325715301577,0.787742540814412,0.784534671262506,0.78170210664586,0.779244846964474,0.777162892218348,0.775456242407482,0.774124897531876,0.77316885759153,0.772588122586444,0.772382692516617,0.772552567382051,0.773097747182744,0.774018231918697,0.77531402158991,0.776985116196383,0.779031515738116,0.781453220215109,0.784250229627362,0.787422543974874,0.790970163257647,0.794893087475679,0.799191316628972,0.803864850717524,0.808913689741336,0.814337833700408,0.82013728259474,0.826312036424332,0.832862095189183,0.839787458889295,0.847088127524666,0.854764101095298,0.862815379601189,0.87124196304234,0.880043851418751,0.889221044730423,0.898773542977353,0.908701346159544,0.919004454276995,0.929682867329706,0.940736585317676,0.952165608240906,0.963969936099397,0.976149568893147,0.988704506622157,1.00163474928643,1.01494029688596,1.02862114942075,1.0426773068908,1.05710876929611,1.07191553663668,1.0870976089125,1.10265498612359,1.11858766826994,1.13489565535155,1.15157894736842,1.16863754432055,1.18607144620794,1.20388065303059,1.2220651647885,1.24062498148166,1.25956010311009,1.27887052967378,1.29855626117273,1.31861729760694,1.33905363897641,1.35986528528113,1.38105223652112,1.40261449269637,1.42455205380688,1.44686491985264,1.46955309083367,1.49261656674996,1.51605534760151,1.53986943338831,1.56405882411038,1.58862351976771,1.61356352036029,1.63887882588814,1.66456943635125,1.69063535174961,1.71707657208324,1.74389309735212,1.77108492755627,1.79865206269568,1.82659450277034,1.85491224778027,1.88360529772545,1.9126736526059,1.94211731242161,1.97193627717257,2.0021305468588,2.03270012148028,2.06364500103703,2.09496518552903,2.1266606749563,2.15873146931882,2.19117756861661,2.22399897284965,2.25719568201796,2.29076769612152,2.32471501516034,2.35903763913443,2.39373556804377,2.42880880188838,2.46425734066824,2.50008118438336,2.53628033303375,2.57285478661939,2.6098045451403,2.64712960859646,2.68482997698788,2.72290565031456,2.76135662857651,2.80018291177371,2.83938449990617,2.8789613929739,2.91891359097688,2.95924109391512,2.99994390178862,3.04102201459739,3.08247543234141,3.12430415502069,3.16650818263523,3.20908751518504,3.2520421526701,3.29537209509042,3.339077342446,3.38315789473684,3.42761375196294,3.47244491412431,3.51765138122093,3.56323315325281,3.60919023021995,3.65552261212235,3.70223029896001,3.74931329073293,3.79677158744111,3.84460518908455,3.89281409566325,3.94139830717721,3.99035782362643,4.03969264501091,4.08940277133065,4.13948820258565,4.18994893877591,4.24078497990143,4.29199632596221,4.34358297695825,4.39554493288955,4.44788219375611,4.50059475955793,4.55368263029501,4.60714580596735,4.66098428657495,4.71519807211781,4.76978716259593,4.8247515580093,4.88009125835794,4.93580626364184,4.991896573861,5.04836218901542,5.1052031091051,5.16241933413003,5.22001086409023,5.27797769898569,5.33631983881641,5.39503728358238,5.45413003328362,5.51359808792012,5.57344144749188,5.63366011199889,5.69425408144117,5.75522335581871,5.8165679351315,5.87828781937956,5.94038300856288,6.00285350268146,6.06569930173529,6.12892040572439,6.19251681464875,6.25648852850836,6.32083554730324],"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[28],"y":[0.772382692516617],"mode":"markers","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="ctlsc0x-supply-chain-analytics.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Part 1: Price Functio</span></span>
<span id="cb19-2"><a href="ctlsc0x-supply-chain-analytics.html#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="ctlsc0x-supply-chain-analytics.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Question1: How much will it charge with 5 basket&#39;s order ?</span></span>
<span id="cb19-4"><a href="ctlsc0x-supply-chain-analytics.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">P</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.8720597</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="ctlsc0x-supply-chain-analytics.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Question2: What is the first derivative of the price function?</span></span>
<span id="cb21-2"><a href="ctlsc0x-supply-chain-analytics.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(Ryacas)</span></span>
<span id="cb21-3"><a href="ctlsc0x-supply-chain-analytics.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- Sym(&quot;x&quot;)</span></span>
<span id="cb21-4"><a href="ctlsc0x-supply-chain-analytics.html#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># s &lt;- expression((x/73)^2-(x/95)+0.92)</span></span>
<span id="cb21-5"><a href="ctlsc0x-supply-chain-analytics.html#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># deriv(s,x) #Didn&#39;t work TO DO</span></span>
<span id="cb21-6"><a href="ctlsc0x-supply-chain-analytics.html#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb21-7"><a href="ctlsc0x-supply-chain-analytics.html#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># #Question3: Second Derivative</span></span>
<span id="cb21-8"><a href="ctlsc0x-supply-chain-analytics.html#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- Sym(&quot;x&quot;)</span></span>
<span id="cb21-9"><a href="ctlsc0x-supply-chain-analytics.html#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># s &lt;- expression(-1/95 + (2*x)/5329)</span></span>
<span id="cb21-10"><a href="ctlsc0x-supply-chain-analytics.html#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># deriv(s,x) #worked</span></span>
<span id="cb21-11"><a href="ctlsc0x-supply-chain-analytics.html#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="ctlsc0x-supply-chain-analytics.html#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Question4: Lowest Unit Price</span></span>
<span id="cb21-13"><a href="ctlsc0x-supply-chain-analytics.html#cb21-13" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">optimize</span>(P,<span class="at">interval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">100</span>), <span class="at">maximum =</span> F)</span>
<span id="cb21-14"><a href="ctlsc0x-supply-chain-analytics.html#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## $minimum
## [1] 28.04737
## 
## $objective
## [1] 0.7723823</code></pre>
</div>
<div id="maximizing-storage" class="section level4" number="1.1.2.2">
<h4><span class="header-section-number">1.1.2.2</span> Maximizing Storage</h4>
<p><span class="math display">\[
\begin{align*}
\textbf{Minimize} &amp; \ Z = x \cdot y \\
\textbf{Subject to} \\
&amp; 2 \cdot x+2 \cdot y = 26.7
\end{align*}
\]</span></p>
<p><span class="math display">\[
\begin{align*}
\textbf{Minimize} &amp; \ Z\ =x\cdot\ \left(\frac{\left(26.7-2\cdot x\right)}{2}\right)\\
\end{align*}
\]</span></p>
<p>Solving:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="ctlsc0x-supply-chain-analytics.html#cb23-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){x<span class="sc">*</span>((<span class="fl">26.7</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>x)<span class="sc">/</span><span class="dv">2</span>)}</span>
<span id="cb23-2"><a href="ctlsc0x-supply-chain-analytics.html#cb23-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">optimize</span>(f,<span class="at">interval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">100</span>), <span class="at">maximum =</span> T)</span>
<span id="cb23-3"><a href="ctlsc0x-supply-chain-analytics.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## $maximum
## [1] 6.675
## 
## $objective
## [1] 44.55562</code></pre>
<p>Let’s check the result in the plot</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="ctlsc0x-supply-chain-analytics.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Data created for plot, using mutate on the function</span></span>
<span id="cb25-2"><a href="ctlsc0x-supply-chain-analytics.html#cb25-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">100</span>,<span class="fl">0.1</span>)</span>
<span id="cb25-3"><a href="ctlsc0x-supply-chain-analytics.html#cb25-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="ctlsc0x-supply-chain-analytics.html#cb25-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">f</span>(x))</span>
<span id="cb25-5"><a href="ctlsc0x-supply-chain-analytics.html#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="ctlsc0x-supply-chain-analytics.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Ploting with a marker on the optimal solution</span></span>
<span id="cb25-7"><a href="ctlsc0x-supply-chain-analytics.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(data, <span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>y, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="ctlsc0x-supply-chain-analytics.html#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>(<span class="at">y =</span> result<span class="sc">$</span>objective, <span class="at">x =</span> result<span class="sc">$</span>maximum)</span></code></pre></div>
<div id="htmlwidget-9f7ab8c87e79f6cfdfd7" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9f7ab8c87e79f6cfdfd7">{"x":{"visdat":{"3a504aac5dad":["function () ","plotlyVisDat"]},"cur_data":"3a504aac5dad","attrs":{"3a504aac5dad":{"x":{},"y":{},"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3a504aac5dad.1":{"x":6.675,"y":44.555625,"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"x"},"yaxis":{"domain":[0,1],"automargin":true,"title":"y"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-100,-99.9,-99.8,-99.7,-99.6,-99.5,-99.4,-99.3,-99.2,-99.1,-99,-98.9,-98.8,-98.7,-98.6,-98.5,-98.4,-98.3,-98.2,-98.1,-98,-97.9,-97.8,-97.7,-97.6,-97.5,-97.4,-97.3,-97.2,-97.1,-97,-96.9,-96.8,-96.7,-96.6,-96.5,-96.4,-96.3,-96.2,-96.1,-96,-95.9,-95.8,-95.7,-95.6,-95.5,-95.4,-95.3,-95.2,-95.1,-95,-94.9,-94.8,-94.7,-94.6,-94.5,-94.4,-94.3,-94.2,-94.1,-94,-93.9,-93.8,-93.7,-93.6,-93.5,-93.4,-93.3,-93.2,-93.1,-93,-92.9,-92.8,-92.7,-92.6,-92.5,-92.4,-92.3,-92.2,-92.1,-92,-91.9,-91.8,-91.7,-91.6,-91.5,-91.4,-91.3,-91.2,-91.1,-91,-90.9,-90.8,-90.7,-90.6,-90.5,-90.4,-90.3,-90.2,-90.1,-90,-89.9,-89.8,-89.7,-89.6,-89.5,-89.4,-89.3,-89.2,-89.1,-89,-88.9,-88.8,-88.7,-88.6,-88.5,-88.4,-88.3,-88.2,-88.1,-88,-87.9,-87.8,-87.7,-87.6,-87.5,-87.4,-87.3,-87.2,-87.1,-87,-86.9,-86.8,-86.7,-86.6,-86.5,-86.4,-86.3,-86.2,-86.1,-86,-85.9,-85.8,-85.7,-85.6,-85.5,-85.4,-85.3,-85.2,-85.1,-85,-84.9,-84.8,-84.7,-84.6,-84.5,-84.4,-84.3,-84.2,-84.1,-84,-83.9,-83.8,-83.7,-83.6,-83.5,-83.4,-83.3,-83.2,-83.1,-83,-82.9,-82.8,-82.7,-82.6,-82.5,-82.4,-82.3,-82.2,-82.1,-82,-81.9,-81.8,-81.7,-81.6,-81.5,-81.4,-81.3,-81.2,-81.1,-81,-80.9,-80.8,-80.7,-80.6,-80.5,-80.4,-80.3,-80.2,-80.1,-80,-79.9,-79.8,-79.7,-79.6,-79.5,-79.4,-79.3,-79.2,-79.1,-79,-78.9,-78.8,-78.7,-78.6,-78.5,-78.4,-78.3,-78.2,-78.1,-78,-77.9,-77.8,-77.7,-77.6,-77.5,-77.4,-77.3,-77.2,-77.1,-77,-76.9,-76.8,-76.7,-76.6,-76.5,-76.4,-76.3,-76.2,-76.1,-76,-75.9,-75.8,-75.7,-75.6,-75.5,-75.4,-75.3,-75.2,-75.1,-75,-74.9,-74.8,-74.7,-74.6,-74.5,-74.4,-74.3,-74.2,-74.1,-74,-73.9,-73.8,-73.7,-73.6,-73.5,-73.4,-73.3,-73.2,-73.1,-73,-72.9,-72.8,-72.7,-72.6,-72.5,-72.4,-72.3,-72.2,-72.1,-72,-71.9,-71.8,-71.7,-71.6,-71.5,-71.4,-71.3,-71.2,-71.1,-71,-70.9,-70.8,-70.7,-70.6,-70.5,-70.4,-70.3,-70.2,-70.1,-70,-69.9,-69.8,-69.7,-69.6,-69.5,-69.4,-69.3,-69.2,-69.1,-69,-68.9,-68.8,-68.7,-68.6,-68.5,-68.4,-68.3,-68.2,-68.1,-68,-67.9,-67.8,-67.7,-67.6,-67.5,-67.4,-67.3,-67.2,-67.1,-67,-66.9,-66.8,-66.7,-66.6,-66.5,-66.4,-66.3,-66.2,-66.1,-66,-65.9,-65.8,-65.7,-65.6,-65.5,-65.4,-65.3,-65.2,-65.1,-65,-64.9,-64.8,-64.7,-64.6,-64.5,-64.4,-64.3,-64.2,-64.1,-64,-63.9,-63.8,-63.7,-63.6,-63.5,-63.4,-63.3,-63.2,-63.1,-63,-62.9,-62.8,-62.7,-62.6,-62.5,-62.4,-62.3,-62.2,-62.1,-62,-61.9,-61.8,-61.7,-61.6,-61.5,-61.4,-61.3,-61.2,-61.1,-61,-60.9,-60.8,-60.7,-60.6,-60.5,-60.4,-60.3,-60.2,-60.1,-60,-59.9,-59.8,-59.7,-59.6,-59.5,-59.4,-59.3,-59.2,-59.1,-59,-58.9,-58.8,-58.7,-58.6,-58.5,-58.4,-58.3,-58.2,-58.1,-58,-57.9,-57.8,-57.7,-57.6,-57.5,-57.4,-57.3,-57.2,-57.1,-57,-56.9,-56.8,-56.7,-56.6,-56.5,-56.4,-56.3,-56.2,-56.1,-56,-55.9,-55.8,-55.7,-55.6,-55.5,-55.4,-55.3,-55.2,-55.1,-55,-54.9,-54.8,-54.7,-54.6,-54.5,-54.4,-54.3,-54.2,-54.1,-54,-53.9,-53.8,-53.7,-53.6,-53.5,-53.4,-53.3,-53.2,-53.1,-53,-52.9,-52.8,-52.7,-52.6,-52.5,-52.4,-52.3,-52.2,-52.1,-52,-51.9,-51.8,-51.7,-51.6,-51.5,-51.4,-51.3,-51.2,-51.1,-51,-50.9,-50.8,-50.7,-50.6,-50.5,-50.4,-50.3,-50.2,-50.1,-50,-49.9,-49.8,-49.7,-49.6,-49.5,-49.4,-49.3,-49.2,-49.1,-49,-48.9,-48.8,-48.7,-48.6,-48.5,-48.4,-48.3,-48.2,-48.1,-48,-47.9,-47.8,-47.7,-47.6,-47.5,-47.4,-47.3,-47.2,-47.1,-47,-46.9,-46.8,-46.7,-46.6,-46.5,-46.4,-46.3,-46.2,-46.1,-46,-45.9,-45.8,-45.7,-45.6,-45.5,-45.4,-45.3,-45.2,-45.1,-45,-44.9,-44.8,-44.7,-44.6,-44.5,-44.4,-44.3,-44.2,-44.1,-44,-43.9,-43.8,-43.7,-43.6,-43.5,-43.4,-43.3,-43.2,-43.1,-43,-42.9,-42.8,-42.7,-42.6,-42.5,-42.4,-42.3,-42.2,-42.1,-42,-41.9,-41.8,-41.7,-41.6,-41.5,-41.4,-41.3,-41.2,-41.1,-41,-40.9,-40.8,-40.7,-40.6,-40.5,-40.4,-40.3,-40.2,-40.1,-40,-39.9,-39.8,-39.7,-39.6,-39.5,-39.4,-39.3,-39.2,-39.1,-39,-38.9,-38.8,-38.7,-38.6,-38.5,-38.4,-38.3,-38.2,-38.1,-38,-37.9,-37.8,-37.7,-37.6,-37.5,-37.4,-37.3,-37.2,-37.1,-37,-36.9,-36.8,-36.7,-36.6,-36.5,-36.4,-36.3,-36.2,-36.1,-36,-35.9,-35.8,-35.7,-35.6,-35.5,-35.4,-35.3,-35.2,-35.1,-35,-34.9,-34.8,-34.7,-34.6,-34.5,-34.4,-34.3,-34.2,-34.1,-34,-33.9,-33.8,-33.7,-33.6,-33.5,-33.4,-33.3,-33.2,-33.1,-33,-32.9,-32.8,-32.7,-32.6,-32.5,-32.4,-32.3,-32.2,-32.1,-32,-31.9,-31.8,-31.7,-31.6,-31.5,-31.4,-31.3,-31.2,-31.1,-31,-30.9,-30.8,-30.7,-30.6,-30.5,-30.4,-30.3,-30.2,-30.1,-30,-29.9,-29.8,-29.7,-29.6,-29.5,-29.4,-29.3,-29.2,-29.1,-29,-28.9,-28.8,-28.7,-28.6,-28.5,-28.4,-28.3,-28.2,-28.1,-28,-27.9,-27.8,-27.7,-27.6,-27.5,-27.4,-27.3,-27.2,-27.1,-27,-26.9,-26.8,-26.7,-26.6,-26.5,-26.4,-26.3,-26.2,-26.1,-26,-25.9,-25.8,-25.7,-25.6,-25.5,-25.4,-25.3,-25.2,-25.1,-25,-24.9,-24.8,-24.7,-24.6,-24.5,-24.4,-24.3,-24.2,-24.1,-24,-23.9,-23.8,-23.7,-23.6,-23.5,-23.4,-23.3,-23.2,-23.1,-23,-22.9,-22.8,-22.7,-22.6,-22.5,-22.4,-22.3,-22.2,-22.1,-22,-21.9,-21.8,-21.7,-21.6,-21.5,-21.4,-21.3,-21.2,-21.1,-21,-20.9,-20.8,-20.7,-20.6,-20.5,-20.4,-20.3,-20.2,-20.1,-20,-19.9,-19.8,-19.7,-19.6,-19.5,-19.4,-19.3,-19.2,-19.1,-19,-18.9,-18.8,-18.7,-18.6,-18.5,-18.4,-18.3,-18.2,-18.1,-18,-17.9,-17.8,-17.7,-17.6,-17.5,-17.4,-17.3,-17.2,-17.1,-17,-16.9,-16.8,-16.7,-16.6,-16.5,-16.4,-16.3,-16.2,-16.1,-16,-15.9,-15.8,-15.7,-15.6,-15.5,-15.4,-15.3,-15.2,-15.1,-15,-14.9,-14.8,-14.7,-14.6,-14.5,-14.4,-14.3,-14.2,-14.1,-14,-13.9,-13.8,-13.7,-13.6,-13.5,-13.4,-13.3,-13.2,-13.1,-13,-12.9,-12.8,-12.7,-12.6,-12.5,-12.4,-12.3,-12.2,-12.1,-12,-11.9,-11.8,-11.7,-11.6,-11.5,-11.4,-11.3,-11.2,-11.1,-11,-10.9,-10.8,-10.7,-10.6,-10.5,-10.4,-10.3,-10.2,-10.1,-10,-9.89999999999999,-9.8,-9.69999999999999,-9.59999999999999,-9.5,-9.39999999999999,-9.3,-9.19999999999999,-9.09999999999999,-9,-8.89999999999999,-8.8,-8.69999999999999,-8.59999999999999,-8.5,-8.39999999999999,-8.3,-8.19999999999999,-8.09999999999999,-8,-7.89999999999999,-7.8,-7.69999999999999,-7.59999999999999,-7.5,-7.39999999999999,-7.3,-7.19999999999999,-7.09999999999999,-7,-6.89999999999999,-6.8,-6.69999999999999,-6.59999999999999,-6.5,-6.39999999999999,-6.3,-6.19999999999999,-6.09999999999999,-6,-5.89999999999999,-5.8,-5.69999999999999,-5.59999999999999,-5.5,-5.39999999999999,-5.3,-5.19999999999999,-5.09999999999999,-5,-4.89999999999999,-4.8,-4.69999999999999,-4.59999999999999,-4.5,-4.39999999999999,-4.3,-4.19999999999999,-4.09999999999999,-4,-3.89999999999999,-3.8,-3.69999999999999,-3.59999999999999,-3.5,-3.39999999999999,-3.3,-3.19999999999999,-3.09999999999999,-3,-2.89999999999999,-2.8,-2.69999999999999,-2.59999999999999,-2.5,-2.39999999999999,-2.3,-2.19999999999999,-2.09999999999999,-2,-1.89999999999999,-1.8,-1.69999999999999,-1.59999999999999,-1.5,-1.39999999999999,-1.3,-1.19999999999999,-1.09999999999999,-1,-0.899999999999991,-0.799999999999997,-0.699999999999989,-0.599999999999994,-0.5,-0.399999999999991,-0.299999999999997,-0.199999999999989,-0.0999999999999943,0,0.100000000000009,0.200000000000003,0.300000000000011,0.400000000000006,0.5,0.600000000000009,0.700000000000003,0.800000000000011,0.900000000000006,1,1.10000000000001,1.2,1.30000000000001,1.40000000000001,1.5,1.60000000000001,1.7,1.80000000000001,1.90000000000001,2,2.10000000000001,2.2,2.30000000000001,2.40000000000001,2.5,2.60000000000001,2.7,2.80000000000001,2.90000000000001,3,3.10000000000001,3.2,3.30000000000001,3.40000000000001,3.5,3.60000000000001,3.7,3.80000000000001,3.90000000000001,4,4.10000000000001,4.2,4.30000000000001,4.40000000000001,4.5,4.60000000000001,4.7,4.80000000000001,4.90000000000001,5,5.10000000000001,5.2,5.30000000000001,5.40000000000001,5.5,5.60000000000001,5.7,5.80000000000001,5.90000000000001,6,6.10000000000001,6.2,6.30000000000001,6.40000000000001,6.5,6.60000000000001,6.7,6.80000000000001,6.90000000000001,7,7.10000000000001,7.2,7.30000000000001,7.40000000000001,7.5,7.60000000000001,7.7,7.80000000000001,7.90000000000001,8,8.10000000000001,8.2,8.30000000000001,8.40000000000001,8.5,8.60000000000001,8.7,8.80000000000001,8.90000000000001,9,9.10000000000001,9.2,9.30000000000001,9.40000000000001,9.5,9.60000000000001,9.7,9.80000000000001,9.90000000000001,10,10.1,10.2,10.3,10.4,10.5,10.6,10.7,10.8,10.9,11,11.1,11.2,11.3,11.4,11.5,11.6,11.7,11.8,11.9,12,12.1,12.2,12.3,12.4,12.5,12.6,12.7,12.8,12.9,13,13.1,13.2,13.3,13.4,13.5,13.6,13.7,13.8,13.9,14,14.1,14.2,14.3,14.4,14.5,14.6,14.7,14.8,14.9,15,15.1,15.2,15.3,15.4,15.5,15.6,15.7,15.8,15.9,16,16.1,16.2,16.3,16.4,16.5,16.6,16.7,16.8,16.9,17,17.1,17.2,17.3,17.4,17.5,17.6,17.7,17.8,17.9,18,18.1,18.2,18.3,18.4,18.5,18.6,18.7,18.8,18.9,19,19.1,19.2,19.3,19.4,19.5,19.6,19.7,19.8,19.9,20,20.1,20.2,20.3,20.4,20.5,20.6,20.7,20.8,20.9,21,21.1,21.2,21.3,21.4,21.5,21.6,21.7,21.8,21.9,22,22.1,22.2,22.3,22.4,22.5,22.6,22.7,22.8,22.9,23,23.1,23.2,23.3,23.4,23.5,23.6,23.7,23.8,23.9,24,24.1,24.2,24.3,24.4,24.5,24.6,24.7,24.8,24.9,25,25.1,25.2,25.3,25.4,25.5,25.6,25.7,25.8,25.9,26,26.1,26.2,26.3,26.4,26.5,26.6,26.7,26.8,26.9,27,27.1,27.2,27.3,27.4,27.5,27.6,27.7,27.8,27.9,28,28.1,28.2,28.3,28.4,28.5,28.6,28.7,28.8,28.9,29,29.1,29.2,29.3,29.4,29.5,29.6,29.7,29.8,29.9,30,30.1,30.2,30.3,30.4,30.5,30.6,30.7,30.8,30.9,31,31.1,31.2,31.3,31.4,31.5,31.6,31.7,31.8,31.9,32,32.1,32.2,32.3,32.4,32.5,32.6,32.7,32.8,32.9,33,33.1,33.2,33.3,33.4,33.5,33.6,33.7,33.8,33.9,34,34.1,34.2,34.3,34.4,34.5,34.6,34.7,34.8,34.9,35,35.1,35.2,35.3,35.4,35.5,35.6,35.7,35.8,35.9,36,36.1,36.2,36.3,36.4,36.5,36.6,36.7,36.8,36.9,37,37.1,37.2,37.3,37.4,37.5,37.6,37.7,37.8,37.9,38,38.1,38.2,38.3,38.4,38.5,38.6,38.7,38.8,38.9,39,39.1,39.2,39.3,39.4,39.5,39.6,39.7,39.8,39.9,40,40.1,40.2,40.3,40.4,40.5,40.6,40.7,40.8,40.9,41,41.1,41.2,41.3,41.4,41.5,41.6,41.7,41.8,41.9,42,42.1,42.2,42.3,42.4,42.5,42.6,42.7,42.8,42.9,43,43.1,43.2,43.3,43.4,43.5,43.6,43.7,43.8,43.9,44,44.1,44.2,44.3,44.4,44.5,44.6,44.7,44.8,44.9,45,45.1,45.2,45.3,45.4,45.5,45.6,45.7,45.8,45.9,46,46.1,46.2,46.3,46.4,46.5,46.6,46.7,46.8,46.9,47,47.1,47.2,47.3,47.4,47.5,47.6,47.7,47.8,47.9,48,48.1,48.2,48.3,48.4,48.5,48.6,48.7,48.8,48.9,49,49.1,49.2,49.3,49.4,49.5,49.6,49.7,49.8,49.9,50,50.1,50.2,50.3,50.4,50.5,50.6,50.7,50.8,50.9,51,51.1,51.2,51.3,51.4,51.5,51.6,51.7,51.8,51.9,52,52.1,52.2,52.3,52.4,52.5,52.6,52.7,52.8,52.9,53,53.1,53.2,53.3,53.4,53.5,53.6,53.7,53.8,53.9,54,54.1,54.2,54.3,54.4,54.5,54.6,54.7,54.8,54.9,55,55.1,55.2,55.3,55.4,55.5,55.6,55.7,55.8,55.9,56,56.1,56.2,56.3,56.4,56.5,56.6,56.7,56.8,56.9,57,57.1,57.2,57.3,57.4,57.5,57.6,57.7,57.8,57.9,58,58.1,58.2,58.3,58.4,58.5,58.6,58.7,58.8,58.9,59,59.1,59.2,59.3,59.4,59.5,59.6,59.7,59.8,59.9,60,60.1,60.2,60.3,60.4,60.5,60.6,60.7,60.8,60.9,61,61.1,61.2,61.3,61.4,61.5,61.6,61.7,61.8,61.9,62,62.1,62.2,62.3,62.4,62.5,62.6,62.7,62.8,62.9,63,63.1,63.2,63.3,63.4,63.5,63.6,63.7,63.8,63.9,64,64.1,64.2,64.3,64.4,64.5,64.6,64.7,64.8,64.9,65,65.1,65.2,65.3,65.4,65.5,65.6,65.7,65.8,65.9,66,66.1,66.2,66.3,66.4,66.5,66.6,66.7,66.8,66.9,67,67.1,67.2,67.3,67.4,67.5,67.6,67.7,67.8,67.9,68,68.1,68.2,68.3,68.4,68.5,68.6,68.7,68.8,68.9,69,69.1,69.2,69.3,69.4,69.5,69.6,69.7,69.8,69.9,70,70.1,70.2,70.3,70.4,70.5,70.6,70.7,70.8,70.9,71,71.1,71.2,71.3,71.4,71.5,71.6,71.7,71.8,71.9,72,72.1,72.2,72.3,72.4,72.5,72.6,72.7,72.8,72.9,73,73.1,73.2,73.3,73.4,73.5,73.6,73.7,73.8,73.9,74,74.1,74.2,74.3,74.4,74.5,74.6,74.7,74.8,74.9,75,75.1,75.2,75.3,75.4,75.5,75.6,75.7,75.8,75.9,76,76.1,76.2,76.3,76.4,76.5,76.6,76.7,76.8,76.9,77,77.1,77.2,77.3,77.4,77.5,77.6,77.7,77.8,77.9,78,78.1,78.2,78.3,78.4,78.5,78.6,78.7,78.8,78.9,79,79.1,79.2,79.3,79.4,79.5,79.6,79.7,79.8,79.9,80,80.1,80.2,80.3,80.4,80.5,80.6,80.7,80.8,80.9,81,81.1,81.2,81.3,81.4,81.5,81.6,81.7,81.8,81.9,82,82.1,82.2,82.3,82.4,82.5,82.6,82.7,82.8,82.9,83,83.1,83.2,83.3,83.4,83.5,83.6,83.7,83.8,83.9,84,84.1,84.2,84.3,84.4,84.5,84.6,84.7,84.8,84.9,85,85.1,85.2,85.3,85.4,85.5,85.6,85.7,85.8,85.9,86,86.1,86.2,86.3,86.4,86.5,86.6,86.7,86.8,86.9,87,87.1,87.2,87.3,87.4,87.5,87.6,87.7,87.8,87.9,88,88.1,88.2,88.3,88.4,88.5,88.6,88.7,88.8,88.9,89,89.1,89.2,89.3,89.4,89.5,89.6,89.7,89.8,89.9,90,90.1,90.2,90.3,90.4,90.5,90.6,90.7,90.8,90.9,91,91.1,91.2,91.3,91.4,91.5,91.6,91.7,91.8,91.9,92,92.1,92.2,92.3,92.4,92.5,92.6,92.7,92.8,92.9,93,93.1,93.2,93.3,93.4,93.5,93.6,93.7,93.8,93.9,94,94.1,94.2,94.3,94.4,94.5,94.6,94.7,94.8,94.9,95,95.1,95.2,95.3,95.4,95.5,95.6,95.7,95.8,95.9,96,96.1,96.2,96.3,96.4,96.5,96.6,96.7,96.8,96.9,97,97.1,97.2,97.3,97.4,97.5,97.6,97.7,97.8,97.9,98,98.1,98.2,98.3,98.4,98.5,98.6,98.7,98.8,98.9,99,99.1,99.2,99.3,99.4,99.5,99.6,99.7,99.8,99.9,100],"y":[-11335,-11313.675,-11292.37,-11271.085,-11249.82,-11228.575,-11207.35,-11186.145,-11164.96,-11143.795,-11122.65,-11101.525,-11080.42,-11059.335,-11038.27,-11017.225,-10996.2,-10975.195,-10954.21,-10933.245,-10912.3,-10891.375,-10870.47,-10849.585,-10828.72,-10807.875,-10787.05,-10766.245,-10745.46,-10724.695,-10703.95,-10683.225,-10662.52,-10641.835,-10621.17,-10600.525,-10579.9,-10559.295,-10538.71,-10518.145,-10497.6,-10477.075,-10456.57,-10436.085,-10415.62,-10395.175,-10374.75,-10354.345,-10333.96,-10313.595,-10293.25,-10272.925,-10252.62,-10232.335,-10212.07,-10191.825,-10171.6,-10151.395,-10131.21,-10111.045,-10090.9,-10070.775,-10050.67,-10030.585,-10010.52,-9990.475,-9970.45,-9950.445,-9930.46,-9910.495,-9890.55,-9870.625,-9850.72,-9830.835,-9810.97,-9791.125,-9771.3,-9751.495,-9731.71,-9711.945,-9692.2,-9672.475,-9652.77,-9633.085,-9613.42,-9593.775,-9574.15,-9554.545,-9534.96,-9515.395,-9495.85,-9476.325,-9456.82,-9437.335,-9417.87,-9398.425,-9379,-9359.595,-9340.21,-9320.845,-9301.5,-9282.175,-9262.87,-9243.585,-9224.32,-9205.075,-9185.85,-9166.645,-9147.46,-9128.295,-9109.15,-9090.025,-9070.92,-9051.835,-9032.77,-9013.725,-8994.7,-8975.695,-8956.71,-8937.745,-8918.8,-8899.875,-8880.97,-8862.085,-8843.22,-8824.375,-8805.55,-8786.745,-8767.96,-8749.195,-8730.45,-8711.725,-8693.02,-8674.335,-8655.67,-8637.025,-8618.4,-8599.795,-8581.21,-8562.645,-8544.1,-8525.575,-8507.07,-8488.585,-8470.12,-8451.675,-8433.25,-8414.845,-8396.46,-8378.095,-8359.75,-8341.425,-8323.12,-8304.835,-8286.57,-8268.325,-8250.1,-8231.895,-8213.71,-8195.545,-8177.4,-8159.275,-8141.17,-8123.085,-8105.02,-8086.975,-8068.95,-8050.945,-8032.96,-8014.995,-7997.05,-7979.125,-7961.22,-7943.335,-7925.47,-7907.625,-7889.8,-7871.995,-7854.21,-7836.445,-7818.7,-7800.975,-7783.27,-7765.585,-7747.92,-7730.275,-7712.65,-7695.045,-7677.46,-7659.895,-7642.35,-7624.825,-7607.32,-7589.835,-7572.37,-7554.925,-7537.5,-7520.095,-7502.71,-7485.345,-7468,-7450.675,-7433.37,-7416.085,-7398.82,-7381.575,-7364.35,-7347.145,-7329.96,-7312.795,-7295.65,-7278.525,-7261.42,-7244.335,-7227.27,-7210.225,-7193.2,-7176.195,-7159.21,-7142.245,-7125.3,-7108.375,-7091.47,-7074.585,-7057.72,-7040.875,-7024.05,-7007.245,-6990.46,-6973.695,-6956.95,-6940.225,-6923.52,-6906.835,-6890.17,-6873.525,-6856.9,-6840.295,-6823.71,-6807.145,-6790.6,-6774.075,-6757.57,-6741.085,-6724.62,-6708.175,-6691.75,-6675.345,-6658.96,-6642.595,-6626.25,-6609.925,-6593.62,-6577.335,-6561.07,-6544.825,-6528.6,-6512.395,-6496.21,-6480.045,-6463.9,-6447.775,-6431.67,-6415.585,-6399.52,-6383.475,-6367.45,-6351.445,-6335.46,-6319.495,-6303.55,-6287.625,-6271.72,-6255.835,-6239.97,-6224.125,-6208.3,-6192.495,-6176.71,-6160.945,-6145.2,-6129.475,-6113.77,-6098.085,-6082.42,-6066.775,-6051.15,-6035.545,-6019.96,-6004.395,-5988.85,-5973.325,-5957.82,-5942.335,-5926.87,-5911.425,-5896,-5880.595,-5865.21,-5849.845,-5834.5,-5819.175,-5803.87,-5788.585,-5773.32,-5758.075,-5742.85,-5727.645,-5712.46,-5697.295,-5682.15,-5667.025,-5651.92,-5636.835,-5621.77,-5606.725,-5591.7,-5576.695,-5561.71,-5546.745,-5531.8,-5516.875,-5501.97,-5487.085,-5472.22,-5457.375,-5442.55,-5427.745,-5412.96,-5398.195,-5383.45,-5368.725,-5354.02,-5339.335,-5324.67,-5310.025,-5295.4,-5280.795,-5266.21,-5251.645,-5237.1,-5222.575,-5208.07,-5193.585,-5179.12,-5164.675,-5150.25,-5135.845,-5121.46,-5107.095,-5092.75,-5078.425,-5064.12,-5049.835,-5035.57,-5021.325,-5007.1,-4992.895,-4978.71,-4964.545,-4950.4,-4936.275,-4922.17,-4908.085,-4894.02,-4879.975,-4865.95,-4851.945,-4837.96,-4823.995,-4810.05,-4796.125,-4782.22,-4768.335,-4754.47,-4740.625,-4726.8,-4712.995,-4699.21,-4685.445,-4671.7,-4657.975,-4644.27,-4630.585,-4616.92,-4603.275,-4589.65,-4576.045,-4562.46,-4548.895,-4535.35,-4521.825,-4508.32,-4494.835,-4481.37,-4467.925,-4454.5,-4441.095,-4427.71,-4414.345,-4401,-4387.675,-4374.37,-4361.085,-4347.82,-4334.575,-4321.35,-4308.145,-4294.96,-4281.795,-4268.65,-4255.525,-4242.42,-4229.335,-4216.27,-4203.225,-4190.2,-4177.195,-4164.21,-4151.245,-4138.3,-4125.375,-4112.47,-4099.585,-4086.72,-4073.875,-4061.05,-4048.245,-4035.46,-4022.695,-4009.95,-3997.225,-3984.52,-3971.835,-3959.17,-3946.525,-3933.9,-3921.295,-3908.71,-3896.145,-3883.6,-3871.075,-3858.57,-3846.085,-3833.62,-3821.175,-3808.75,-3796.345,-3783.96,-3771.595,-3759.25,-3746.925,-3734.62,-3722.335,-3710.07,-3697.825,-3685.6,-3673.395,-3661.21,-3649.045,-3636.9,-3624.775,-3612.67,-3600.585,-3588.52,-3576.475,-3564.45,-3552.445,-3540.46,-3528.495,-3516.55,-3504.625,-3492.72,-3480.835,-3468.97,-3457.125,-3445.3,-3433.495,-3421.71,-3409.945,-3398.2,-3386.475,-3374.77,-3363.085,-3351.42,-3339.775,-3328.15,-3316.545,-3304.96,-3293.395,-3281.85,-3270.325,-3258.82,-3247.335,-3235.87,-3224.425,-3213,-3201.595,-3190.21,-3178.845,-3167.5,-3156.175,-3144.87,-3133.585,-3122.32,-3111.075,-3099.85,-3088.645,-3077.46,-3066.295,-3055.15,-3044.025,-3032.92,-3021.835,-3010.77,-2999.725,-2988.7,-2977.695,-2966.71,-2955.745,-2944.8,-2933.875,-2922.97,-2912.085,-2901.22,-2890.375,-2879.55,-2868.745,-2857.96,-2847.195,-2836.45,-2825.725,-2815.02,-2804.335,-2793.67,-2783.025,-2772.4,-2761.795,-2751.21,-2740.645,-2730.1,-2719.575,-2709.07,-2698.585,-2688.12,-2677.675,-2667.25,-2656.845,-2646.46,-2636.095,-2625.75,-2615.425,-2605.12,-2594.835,-2584.57,-2574.325,-2564.1,-2553.895,-2543.71,-2533.545,-2523.4,-2513.275,-2503.17,-2493.085,-2483.02,-2472.975,-2462.95,-2452.945,-2442.96,-2432.995,-2423.05,-2413.125,-2403.22,-2393.335,-2383.47,-2373.625,-2363.8,-2353.995,-2344.21,-2334.445,-2324.7,-2314.975,-2305.27,-2295.585,-2285.92,-2276.275,-2266.65,-2257.045,-2247.46,-2237.895,-2228.35,-2218.825,-2209.32,-2199.835,-2190.37,-2180.925,-2171.5,-2162.095,-2152.71,-2143.345,-2134,-2124.675,-2115.37,-2106.085,-2096.82,-2087.575,-2078.35,-2069.145,-2059.96,-2050.795,-2041.65,-2032.525,-2023.42,-2014.335,-2005.27,-1996.225,-1987.2,-1978.195,-1969.21,-1960.245,-1951.3,-1942.375,-1933.47,-1924.585,-1915.72,-1906.875,-1898.05,-1889.245,-1880.46,-1871.695,-1862.95,-1854.225,-1845.52,-1836.835,-1828.17,-1819.525,-1810.9,-1802.295,-1793.71,-1785.145,-1776.6,-1768.075,-1759.57,-1751.085,-1742.62,-1734.175,-1725.75,-1717.345,-1708.96,-1700.595,-1692.25,-1683.925,-1675.62,-1667.335,-1659.07,-1650.825,-1642.6,-1634.395,-1626.21,-1618.045,-1609.9,-1601.775,-1593.67,-1585.585,-1577.52,-1569.475,-1561.45,-1553.445,-1545.46,-1537.495,-1529.55,-1521.625,-1513.72,-1505.835,-1497.97,-1490.125,-1482.3,-1474.495,-1466.71,-1458.945,-1451.2,-1443.475,-1435.77,-1428.085,-1420.42,-1412.775,-1405.15,-1397.545,-1389.96,-1382.395,-1374.85,-1367.325,-1359.82,-1352.335,-1344.87,-1337.425,-1330,-1322.595,-1315.21,-1307.845,-1300.5,-1293.175,-1285.87,-1278.585,-1271.32,-1264.075,-1256.85,-1249.645,-1242.46,-1235.295,-1228.15,-1221.025,-1213.92,-1206.835,-1199.77,-1192.725,-1185.7,-1178.695,-1171.71,-1164.745,-1157.8,-1150.875,-1143.97,-1137.085,-1130.22,-1123.375,-1116.55,-1109.745,-1102.96,-1096.195,-1089.45,-1082.725,-1076.02,-1069.335,-1062.67,-1056.025,-1049.4,-1042.795,-1036.21,-1029.645,-1023.1,-1016.575,-1010.07,-1003.585,-997.12,-990.675,-984.25,-977.845,-971.46,-965.095,-958.75,-952.424999999999,-946.12,-939.835,-933.57,-927.325,-921.099999999999,-914.895,-908.71,-902.545,-896.4,-890.275,-884.17,-878.085,-872.02,-865.975,-859.949999999999,-853.945,-847.959999999999,-841.995,-836.05,-830.125,-824.22,-818.334999999999,-812.47,-806.625,-800.799999999999,-794.995,-789.209999999999,-783.445,-777.7,-771.975,-766.27,-760.584999999999,-754.92,-749.275,-743.65,-738.045,-732.459999999999,-726.895,-721.35,-715.825,-710.32,-704.834999999999,-699.37,-693.925,-688.5,-683.095,-677.709999999999,-672.345,-667,-661.675,-656.37,-651.084999999999,-645.82,-640.575,-635.35,-630.145,-624.959999999999,-619.795,-614.65,-609.525,-604.42,-599.334999999999,-594.27,-589.225,-584.2,-579.195,-574.209999999999,-569.245,-564.3,-559.375,-554.47,-549.584999999999,-544.72,-539.875,-535.05,-530.245,-525.459999999999,-520.695,-515.95,-511.225,-506.52,-501.834999999999,-497.17,-492.525,-487.9,-483.295,-478.71,-474.145,-469.6,-465.075,-460.57,-456.085,-451.62,-447.175,-442.75,-438.345,-433.96,-429.595,-425.25,-420.925,-416.62,-412.335,-408.07,-403.825,-399.6,-395.395,-391.21,-387.045,-382.9,-378.775,-374.67,-370.585,-366.52,-362.475,-358.45,-354.445,-350.46,-346.495,-342.55,-338.625,-334.72,-330.835,-326.97,-323.125,-319.3,-315.495,-311.71,-307.945,-304.2,-300.475,-296.77,-293.085,-289.42,-285.775,-282.15,-278.545,-274.96,-271.395,-267.85,-264.325,-260.82,-257.335,-253.87,-250.425,-247,-243.595,-240.21,-236.845,-233.5,-230.175,-226.87,-223.585,-220.32,-217.075,-213.85,-210.645,-207.46,-204.295,-201.15,-198.025,-194.92,-191.835,-188.77,-185.725,-182.7,-179.695,-176.71,-173.745,-170.8,-167.875,-164.97,-162.085,-159.22,-156.375,-153.55,-150.745,-147.96,-145.195,-142.45,-139.725,-137.02,-134.335,-131.67,-129.025,-126.4,-123.795,-121.21,-118.645,-116.1,-113.575,-111.07,-108.585,-106.12,-103.675,-101.25,-98.8449999999999,-96.4599999999997,-94.0949999999999,-91.75,-89.4249999999998,-87.1199999999999,-84.8349999999998,-82.5699999999999,-80.325,-78.0999999999998,-75.8949999999999,-73.7099999999998,-71.5449999999999,-69.4,-67.2749999999998,-65.1699999999999,-63.0849999999998,-61.0199999999999,-58.975,-56.9499999999998,-54.945,-52.9599999999998,-50.9949999999999,-49.05,-47.1249999999998,-45.2199999999999,-43.3349999999998,-41.4699999999999,-39.625,-37.7999999999998,-35.9949999999999,-34.2099999999998,-32.4449999999999,-30.7,-28.9749999999999,-27.2699999999999,-25.5849999999998,-23.9199999999999,-22.275,-20.6499999999999,-19.045,-17.4599999999998,-15.8949999999999,-14.35,-12.8249999999999,-11.32,-9.83499999999983,-8.36999999999992,-6.925,-5.49999999999988,-4.09499999999996,-2.70999999999984,-1.34499999999992,0,1.32500000000011,2.63000000000004,3.91500000000014,5.18000000000007,6.425,7.6500000000001,8.85500000000003,10.0400000000001,11.2050000000001,12.35,13.4750000000001,14.58,15.6650000000001,16.7300000000001,17.775,18.8000000000001,19.805,20.7900000000001,21.7550000000001,22.7,23.6250000000001,24.53,25.4150000000001,26.28,27.125,27.9500000000001,28.755,29.5400000000001,30.305,31.05,31.7750000000001,32.48,33.1650000000001,33.83,34.475,35.1000000000001,35.705,36.2900000000001,36.855,37.4,37.925,38.43,38.9150000000001,39.38,39.825,40.25,40.655,41.04,41.405,41.75,42.075,42.38,42.665,42.93,43.175,43.4,43.605,43.79,43.955,44.1,44.225,44.33,44.415,44.48,44.525,44.55,44.555,44.54,44.505,44.45,44.375,44.28,44.165,44.03,43.875,43.7,43.505,43.29,43.055,42.8,42.525,42.23,41.915,41.58,41.225,40.85,40.455,40.0399999999999,39.605,39.15,38.675,38.18,37.6649999999999,37.13,36.575,35.9999999999999,35.405,34.7899999999999,34.155,33.5,32.8249999999999,32.13,31.4149999999999,30.68,29.925,29.1499999999999,28.355,27.5399999999999,26.7049999999999,25.85,24.9749999999999,24.08,23.1649999999999,22.2299999999999,21.275,20.2999999999999,19.305,18.2899999999999,17.2549999999999,16.2,15.1249999999999,14.03,12.9149999999999,11.7799999999999,10.625,9.44999999999989,8.25499999999996,7.03999999999986,5.80499999999992,4.55,3.27499999999989,1.97999999999996,0.664999999999845,-0.670000000000081,-2.025,-3.40000000000012,-4.79500000000005,-6.21000000000017,-7.64500000000009,-9.1,-10.5750000000001,-12.07,-13.5850000000002,-15.1200000000001,-16.675,-18.2500000000001,-19.8450000000001,-21.4600000000002,-23.0950000000001,-24.75,-26.4250000000001,-28.1200000000001,-29.8350000000002,-31.5700000000001,-33.325,-35.1000000000002,-36.8950000000001,-38.7100000000002,-40.5450000000001,-42.4,-44.2750000000002,-46.1700000000001,-48.0850000000002,-50.0200000000001,-51.975,-53.9500000000002,-55.9450000000001,-57.9600000000002,-59.9950000000001,-62.05,-64.1250000000002,-66.2200000000001,-68.3350000000002,-70.4700000000001,-72.625,-74.8000000000002,-76.9950000000001,-79.2100000000003,-81.4450000000001,-83.7,-85.9750000000002,-88.2700000000001,-90.5850000000003,-92.9200000000001,-95.275,-97.6500000000002,-100.045,-102.46,-104.895,-107.35,-109.825,-112.32,-114.835,-117.37,-119.925,-122.5,-125.095,-127.71,-130.345,-133,-135.675,-138.37,-141.085,-143.82,-146.575,-149.35,-152.145,-154.96,-157.795,-160.65,-163.525,-166.42,-169.335,-172.27,-175.225,-178.2,-181.195,-184.21,-187.245,-190.3,-193.375,-196.47,-199.585,-202.72,-205.875,-209.05,-212.245,-215.46,-218.695,-221.95,-225.225,-228.52,-231.835,-235.17,-238.525,-241.9,-245.295,-248.71,-252.145,-255.6,-259.075,-262.57,-266.085,-269.62,-273.175,-276.75,-280.345,-283.96,-287.595,-291.25,-294.925,-298.62,-302.335,-306.07,-309.825,-313.6,-317.395,-321.21,-325.045,-328.9,-332.775,-336.67,-340.585,-344.52,-348.475,-352.45,-356.445,-360.46,-364.495,-368.55,-372.625,-376.72,-380.835,-384.97,-389.125,-393.3,-397.495,-401.71,-405.945,-410.2,-414.475,-418.770000000001,-423.085,-427.42,-431.775,-436.15,-440.545000000001,-444.96,-449.395,-453.85,-458.325,-462.820000000001,-467.335000000001,-471.87,-476.425,-481,-485.595000000001,-490.21,-494.845,-499.5,-504.175,-508.870000000001,-513.585,-518.32,-523.075,-527.85,-532.645000000001,-537.46,-542.295,-547.15,-552.025,-556.920000000001,-561.835,-566.77,-571.725,-576.7,-581.695000000001,-586.71,-591.745,-596.8,-601.875,-606.970000000001,-612.085,-617.22,-622.375,-627.55,-632.745000000001,-637.96,-643.195,-648.45,-653.725,-659.020000000001,-664.335000000001,-669.67,-675.025,-680.4,-685.795000000001,-691.210000000001,-696.645,-702.1,-707.575,-713.070000000001,-718.585000000001,-724.12,-729.675,-735.25,-740.845000000001,-746.460000000001,-752.095,-757.75,-763.425,-769.120000000001,-774.835000000001,-780.57,-786.325,-792.1,-797.895000000001,-803.710000000001,-809.545,-815.4,-821.275,-827.170000000001,-833.085000000001,-839.02,-844.975,-850.95,-856.945000000001,-862.960000000001,-868.995,-875.05,-881.125,-887.220000000001,-893.335000000001,-899.47,-905.625,-911.8,-917.995000000001,-924.210000000001,-930.445,-936.7,-942.975,-949.270000000001,-955.585000000001,-961.92,-968.275,-974.65,-981.045000000001,-987.460000000001,-993.895,-1000.35,-1006.825,-1013.32,-1019.835,-1026.37,-1032.925,-1039.5,-1046.095,-1052.71,-1059.345,-1066,-1072.675,-1079.37,-1086.085,-1092.82,-1099.575,-1106.35,-1113.145,-1119.96,-1126.795,-1133.65,-1140.525,-1147.42,-1154.335,-1161.27,-1168.225,-1175.2,-1182.195,-1189.21,-1196.245,-1203.3,-1210.375,-1217.47,-1224.585,-1231.72,-1238.875,-1246.05,-1253.245,-1260.46,-1267.695,-1274.95,-1282.225,-1289.52,-1296.835,-1304.17,-1311.525,-1318.9,-1326.295,-1333.71,-1341.145,-1348.6,-1356.075,-1363.57,-1371.085,-1378.62,-1386.175,-1393.75,-1401.345,-1408.96,-1416.595,-1424.25,-1431.925,-1439.62,-1447.335,-1455.07,-1462.825,-1470.6,-1478.395,-1486.21,-1494.045,-1501.9,-1509.775,-1517.67,-1525.585,-1533.52,-1541.475,-1549.45,-1557.445,-1565.46,-1573.495,-1581.55,-1589.625,-1597.72,-1605.835,-1613.97,-1622.125,-1630.3,-1638.495,-1646.71,-1654.945,-1663.2,-1671.475,-1679.77,-1688.085,-1696.42,-1704.775,-1713.15,-1721.545,-1729.96,-1738.395,-1746.85,-1755.325,-1763.82,-1772.335,-1780.87,-1789.425,-1798,-1806.595,-1815.21,-1823.845,-1832.5,-1841.175,-1849.87,-1858.585,-1867.32,-1876.075,-1884.85,-1893.645,-1902.46,-1911.295,-1920.15,-1929.025,-1937.92,-1946.835,-1955.77,-1964.725,-1973.7,-1982.695,-1991.71,-2000.745,-2009.8,-2018.875,-2027.97,-2037.085,-2046.22,-2055.375,-2064.55,-2073.745,-2082.96,-2092.195,-2101.45,-2110.725,-2120.02,-2129.335,-2138.67,-2148.025,-2157.4,-2166.795,-2176.21,-2185.645,-2195.1,-2204.575,-2214.07,-2223.585,-2233.12,-2242.675,-2252.25,-2261.845,-2271.46,-2281.095,-2290.75,-2300.425,-2310.12,-2319.835,-2329.57,-2339.325,-2349.1,-2358.895,-2368.71,-2378.545,-2388.4,-2398.275,-2408.17,-2418.085,-2428.02,-2437.975,-2447.95,-2457.945,-2467.96,-2477.995,-2488.05,-2498.125,-2508.22,-2518.335,-2528.47,-2538.625,-2548.8,-2558.995,-2569.21,-2579.445,-2589.7,-2599.975,-2610.27,-2620.585,-2630.92,-2641.275,-2651.65,-2662.045,-2672.46,-2682.895,-2693.35,-2703.825,-2714.32,-2724.835,-2735.37,-2745.925,-2756.5,-2767.095,-2777.71,-2788.345,-2799,-2809.675,-2820.37,-2831.085,-2841.82,-2852.575,-2863.35,-2874.145,-2884.96,-2895.795,-2906.65,-2917.525,-2928.42,-2939.335,-2950.27,-2961.225,-2972.2,-2983.195,-2994.21,-3005.245,-3016.3,-3027.375,-3038.47,-3049.585,-3060.72,-3071.875,-3083.05,-3094.245,-3105.46,-3116.695,-3127.95,-3139.225,-3150.52,-3161.835,-3173.17,-3184.525,-3195.9,-3207.295,-3218.71,-3230.145,-3241.6,-3253.075,-3264.57,-3276.085,-3287.62,-3299.175,-3310.75,-3322.345,-3333.96,-3345.595,-3357.25,-3368.925,-3380.62,-3392.335,-3404.07,-3415.825,-3427.6,-3439.395,-3451.21,-3463.045,-3474.9,-3486.775,-3498.67,-3510.585,-3522.52,-3534.475,-3546.45,-3558.445,-3570.46,-3582.495,-3594.55,-3606.625,-3618.72,-3630.835,-3642.97,-3655.125,-3667.3,-3679.495,-3691.71,-3703.945,-3716.2,-3728.475,-3740.77,-3753.085,-3765.42,-3777.775,-3790.15,-3802.545,-3814.96,-3827.395,-3839.85,-3852.325,-3864.82,-3877.335,-3889.87,-3902.425,-3915,-3927.595,-3940.21,-3952.845,-3965.5,-3978.175,-3990.87,-4003.585,-4016.32,-4029.075,-4041.85,-4054.645,-4067.46,-4080.295,-4093.15,-4106.025,-4118.92,-4131.835,-4144.77,-4157.725,-4170.7,-4183.695,-4196.71,-4209.745,-4222.8,-4235.875,-4248.97,-4262.085,-4275.22,-4288.375,-4301.55,-4314.745,-4327.96,-4341.195,-4354.45,-4367.725,-4381.02,-4394.335,-4407.67,-4421.025,-4434.4,-4447.795,-4461.21,-4474.645,-4488.1,-4501.575,-4515.07,-4528.585,-4542.12,-4555.675,-4569.25,-4582.845,-4596.46,-4610.095,-4623.75,-4637.425,-4651.12,-4664.835,-4678.57,-4692.325,-4706.1,-4719.895,-4733.71,-4747.545,-4761.4,-4775.275,-4789.17,-4803.085,-4817.02,-4830.975,-4844.95,-4858.945,-4872.96,-4886.995,-4901.05,-4915.125,-4929.22,-4943.335,-4957.47,-4971.625,-4985.8,-4999.995,-5014.21,-5028.445,-5042.7,-5056.975,-5071.27,-5085.585,-5099.92,-5114.275,-5128.65,-5143.045,-5157.46,-5171.895,-5186.35,-5200.825,-5215.32,-5229.835,-5244.37,-5258.925,-5273.5,-5288.095,-5302.71,-5317.345,-5332,-5346.675,-5361.37,-5376.085,-5390.82,-5405.575,-5420.35,-5435.145,-5449.96,-5464.795,-5479.65,-5494.525,-5509.42,-5524.335,-5539.27,-5554.225,-5569.2,-5584.195,-5599.21,-5614.245,-5629.3,-5644.375,-5659.47,-5674.585,-5689.72,-5704.875,-5720.05,-5735.245,-5750.46,-5765.695,-5780.95,-5796.225,-5811.52,-5826.835,-5842.17,-5857.525,-5872.9,-5888.295,-5903.71,-5919.145,-5934.6,-5950.075,-5965.57,-5981.085,-5996.62,-6012.175,-6027.75,-6043.345,-6058.96,-6074.595,-6090.25,-6105.925,-6121.62,-6137.335,-6153.07,-6168.825,-6184.6,-6200.395,-6216.21,-6232.045,-6247.9,-6263.775,-6279.67,-6295.585,-6311.52,-6327.475,-6343.45,-6359.445,-6375.46,-6391.495,-6407.55,-6423.625,-6439.72,-6455.835,-6471.97,-6488.125,-6504.3,-6520.495,-6536.71,-6552.945,-6569.2,-6585.475,-6601.77,-6618.085,-6634.42,-6650.775,-6667.15,-6683.545,-6699.96,-6716.395,-6732.85,-6749.325,-6765.82,-6782.335,-6798.87,-6815.425,-6832,-6848.595,-6865.21,-6881.845,-6898.5,-6915.175,-6931.87,-6948.585,-6965.32,-6982.075,-6998.85,-7015.645,-7032.46,-7049.295,-7066.15,-7083.025,-7099.92,-7116.835,-7133.77,-7150.725,-7167.7,-7184.695,-7201.71,-7218.745,-7235.8,-7252.875,-7269.97,-7287.085,-7304.22,-7321.375,-7338.55,-7355.745,-7372.96,-7390.195,-7407.45,-7424.725,-7442.02,-7459.335,-7476.67,-7494.025,-7511.4,-7528.795,-7546.21,-7563.645,-7581.1,-7598.575,-7616.07,-7633.585,-7651.12,-7668.675,-7686.25,-7703.845,-7721.46,-7739.095,-7756.75,-7774.425,-7792.12,-7809.835,-7827.57,-7845.325,-7863.1,-7880.895,-7898.71,-7916.545,-7934.4,-7952.275,-7970.17,-7988.085,-8006.02,-8023.975,-8041.95,-8059.945,-8077.96,-8095.995,-8114.05,-8132.125,-8150.22,-8168.335,-8186.47,-8204.625,-8222.8,-8240.995,-8259.21,-8277.445,-8295.7,-8313.975,-8332.27,-8350.585,-8368.92,-8387.275,-8405.65000000001,-8424.045,-8442.46,-8460.895,-8479.35,-8497.825,-8516.32,-8534.835,-8553.37,-8571.925,-8590.50000000001,-8609.095,-8627.71,-8646.345,-8665],"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[6.675],"y":[44.555625],"mode":"markers","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="marketing-magicpuppy" class="section level4" number="1.1.2.3">
<h4><span class="header-section-number">1.1.2.3</span> Marketing MagicPuppy</h4>
<p><span class="math display">\[
N = 1700 \left ( \frac{x}{90} - \left ( \frac{x}{90} \right ) ^2 \right )
\]</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="ctlsc0x-supply-chain-analytics.html#cb26-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="dv">1700</span><span class="sc">*</span>(x<span class="sc">/</span><span class="dv">90</span><span class="sc">-</span>(x<span class="sc">/</span><span class="dv">90</span>)<span class="sc">^</span><span class="dv">2</span>)}</span>
<span id="cb26-2"><a href="ctlsc0x-supply-chain-analytics.html#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="ctlsc0x-supply-chain-analytics.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Question1: First derivative</span></span>
<span id="cb26-4"><a href="ctlsc0x-supply-chain-analytics.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- Sym(&quot;x&quot;)</span></span>
<span id="cb26-5"><a href="ctlsc0x-supply-chain-analytics.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># s &lt;- expression(1700*(x/90-(x/90)^2))</span></span>
<span id="cb26-6"><a href="ctlsc0x-supply-chain-analytics.html#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># deriv(s,x) #Didn&#39;t work TO DO</span></span>
<span id="cb26-7"><a href="ctlsc0x-supply-chain-analytics.html#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="ctlsc0x-supply-chain-analytics.html#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="ctlsc0x-supply-chain-analytics.html#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Question2: How many units should be given away in the campaign in order to maximize its positive impact?</span></span>
<span id="cb26-10"><a href="ctlsc0x-supply-chain-analytics.html#cb26-10" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">optimize</span>(f,<span class="at">interval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>,<span class="dv">200</span>), <span class="at">maximum =</span> T)</span>
<span id="cb26-11"><a href="ctlsc0x-supply-chain-analytics.html#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## $maximum
## [1] 45
## 
## $objective
## [1] 425</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="ctlsc0x-supply-chain-analytics.html#cb28-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">1</span>)</span>
<span id="cb28-2"><a href="ctlsc0x-supply-chain-analytics.html#cb28-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="ctlsc0x-supply-chain-analytics.html#cb28-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">f</span>(x))</span>
<span id="cb28-4"><a href="ctlsc0x-supply-chain-analytics.html#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="ctlsc0x-supply-chain-analytics.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Ploting with a marker on the optimal solution</span></span>
<span id="cb28-6"><a href="ctlsc0x-supply-chain-analytics.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(data, <span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>y, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="ctlsc0x-supply-chain-analytics.html#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>(<span class="at">y =</span> result<span class="sc">$</span>objective, <span class="at">x =</span> result<span class="sc">$</span>maximum)</span></code></pre></div>
<div id="htmlwidget-9f7acd942c7192c128b6" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9f7acd942c7192c128b6">{"x":{"visdat":{"3a50700b551e":["function () ","plotlyVisDat"]},"cur_data":"3a50700b551e","attrs":{"3a50700b551e":{"x":{},"y":{},"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3a50700b551e.1":{"x":45,"y":425,"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"x"},"yaxis":{"domain":[0,1],"automargin":true,"title":"y"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-50,-49,-48,-47,-46,-45,-44,-43,-42,-41,-40,-39,-38,-37,-36,-35,-34,-33,-32,-31,-30,-29,-28,-27,-26,-25,-24,-23,-22,-21,-20,-19,-18,-17,-16,-15,-14,-13,-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],"y":[-1469.13580246914,-1429.46913580247,-1390.22222222222,-1351.3950617284,-1312.98765432099,-1275,-1237.43209876543,-1200.28395061728,-1163.55555555556,-1127.24691358025,-1091.35802469136,-1055.88888888889,-1020.83950617284,-986.20987654321,-952,-918.20987654321,-884.839506172839,-851.888888888889,-819.358024691358,-787.246913580247,-755.555555555556,-724.283950617284,-693.432098765432,-663,-632.987654320988,-603.395061728395,-574.222222222222,-545.469135802469,-517.135802469136,-489.222222222222,-461.728395061728,-434.654320987654,-408,-381.765432098765,-355.950617283951,-330.555555555555,-305.58024691358,-281.024691358025,-256.888888888889,-233.172839506173,-209.876543209877,-187,-164.543209876543,-142.506172839506,-120.888888888889,-99.6913580246914,-78.9135802469136,-58.5555555555556,-38.6172839506173,-19.0987654320988,0,18.679012345679,36.9382716049383,54.7777777777778,72.1975308641975,89.1975308641975,105.777777777778,121.938271604938,137.679012345679,153,167.901234567901,182.382716049383,196.444444444444,210.086419753086,223.308641975309,236.111111111111,248.493827160494,260.456790123457,272,283.123456790123,293.827160493827,304.111111111111,313.975308641975,323.41975308642,332.444444444444,341.049382716049,349.234567901235,357,364.345679012346,371.271604938272,377.777777777778,383.864197530864,389.530864197531,394.777777777778,399.604938271605,404.012345679012,408,411.567901234568,414.716049382716,417.444444444444,419.753086419753,421.641975308642,423.111111111111,424.160493827161,424.79012345679,425,424.79012345679,424.16049382716,423.111111111111,421.641975308642,419.753086419753,417.444444444445,414.716049382716,411.567901234568,408,404.012345679012,399.604938271605,394.777777777778,389.530864197531,383.864197530864,377.777777777778,371.271604938272,364.345679012346,357,349.234567901235,341.049382716049,332.444444444445,323.41975308642,313.975308641975,304.111111111111,293.827160493827,283.123456790124,272,260.456790123457,248.493827160494,236.111111111111,223.308641975309,210.086419753086,196.444444444444,182.382716049383,167.901234567901,153,137.679012345679,121.938271604938,105.777777777778,89.1975308641975,72.1975308641975,54.7777777777778,36.9382716049383,18.6790123456789,0,-19.0987654320986,-38.617283950617,-58.5555555555556,-78.9135802469138,-99.6913580246914,-120.888888888889,-142.506172839506,-164.543209876543,-187,-209.876543209877],"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[45],"y":[425],"mode":"markers","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="curebase-cancer-institute" class="section level4" number="1.1.2.4">
<h4><span class="header-section-number">1.1.2.4</span> CureBase Cancer Institute</h4>
<p><span class="math display">\[
W = \left ( m^{x^{2}} \right )\left ( n^{-x} \right )\left ( z^7 \right )
\]</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="ctlsc0x-supply-chain-analytics.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Question what is the value of  x  at the maximum value of  W , given that  m=0.06 ,  n=0.14 ,  z=0.15 ?)</span></span>
<span id="cb29-2"><a href="ctlsc0x-supply-chain-analytics.html#cb29-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fl">0.06</span><span class="sc">^</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(<span class="fl">0.14</span><span class="sc">^</span>(<span class="sc">-</span>x))<span class="sc">*</span><span class="fl">0.15</span><span class="sc">^</span><span class="dv">7</span>}</span>
<span id="cb29-3"><a href="ctlsc0x-supply-chain-analytics.html#cb29-3" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">optimize</span>(f,<span class="at">interval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">maximum =</span> T)</span>
<span id="cb29-4"><a href="ctlsc0x-supply-chain-analytics.html#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## $maximum
## [1] 0.3494179
## 
## $objective
## [1] 0.000002408895</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="ctlsc0x-supply-chain-analytics.html#cb31-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)</span>
<span id="cb31-2"><a href="ctlsc0x-supply-chain-analytics.html#cb31-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="ctlsc0x-supply-chain-analytics.html#cb31-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">f</span>(x))</span>
<span id="cb31-4"><a href="ctlsc0x-supply-chain-analytics.html#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="ctlsc0x-supply-chain-analytics.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Ploting with a marker on the optimal solution</span></span>
<span id="cb31-6"><a href="ctlsc0x-supply-chain-analytics.html#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(data, <span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>y, <span class="at">type =</span> <span class="st">&#39;scatter&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;lines&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="ctlsc0x-supply-chain-analytics.html#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>(<span class="at">y =</span> result<span class="sc">$</span>objective, <span class="at">x =</span> result<span class="sc">$</span>maximum)</span></code></pre></div>
<div id="htmlwidget-1db94b65fef6d38aea72" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1db94b65fef6d38aea72">{"x":{"visdat":{"3a50767b3b82":["function () ","plotlyVisDat"]},"cur_data":"3a50767b3b82","attrs":{"3a50767b3b82":{"x":{},"y":{},"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3a50767b3b82.1":{"x":0.34941788850726,"y":2.40889540332597e-06,"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"x"},"yaxis":{"domain":[0,1],"automargin":true,"title":"y"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-1,-0.9,-0.8,-0.7,-0.6,-0.5,-0.4,-0.3,-0.2,-0.1,0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1],"y":[1.43521875e-08,2.9816492840403e-08,5.85541987052786e-08,1.08698249720678e-07,1.90743648268736e-07,3.16403037288569e-07,4.96128559417562e-07,7.3537834459633e-07,1.03036351155475e-06,1.36468723560612e-06,1.70859375e-06,2.02212278287273e-06,2.26224301671235e-06,2.39240122007236e-06,2.39161792177531e-06,2.26002169491835e-06,2.01881462437991e-06,1.70468170838915e-06,1.3606711764887e-06,1.02665870551934e-06,7.32254464285714e-07],"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.34941788850726],"y":[2.40889540332597e-06],"mode":"markers","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="santas-molding-company" class="section level4" number="1.1.2.5">
<h4><span class="header-section-number">1.1.2.5</span> Santa’s Molding Company</h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="ctlsc0x-supply-chain-analytics.html#cb32-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;Profit&quot;</span>,<span class="st">&quot;Time&quot;</span>,<span class="st">&quot;Cubic Area&quot;</span>, <span class="st">&quot;index capacity&quot;</span>),</span>
<span id="cb32-2"><a href="ctlsc0x-supply-chain-analytics.html#cb32-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Toy =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">13</span>,<span class="dv">33</span>,<span class="dv">75</span>), <span class="at">doll =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">15</span>,<span class="dv">25</span>,<span class="dv">70</span>),</span>
<span id="cb32-3"><a href="ctlsc0x-supply-chain-analytics.html#cb32-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Capacity =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">1440</span>, <span class="dv">3000</span>, <span class="cn">NA</span>))</span>
<span id="cb32-4"><a href="ctlsc0x-supply-chain-analytics.html#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="ctlsc0x-supply-chain-analytics.html#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Santa’s Molding Company&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-14">Table 1.2: </span>Santa’s Molding Company
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Toy
</th>
<th style="text-align:right;">
doll
</th>
<th style="text-align:right;">
Capacity
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Profit
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Time
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
1440
</td>
</tr>
<tr>
<td style="text-align:left;">
Cubic Area
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
3000
</td>
</tr>
<tr>
<td style="text-align:left;">
index capacity
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Maximize} &amp; \ y = \sum_{i=1}^{N} p_i\cdot x_i \\
\textbf{subject to}\\
    &amp; x_i \le\ c_i  \ \ \forall i \in N \\
    &amp; \sum_{i=1}^{N} t_{i} \cdot x_i \le\ 1440 \\
    &amp; \sum_{i=1}^{N} a_{i} \cdot x_i \le\ 3000 \\
    &amp; x_i \ge 0 \\
    \\
    
\textbf{Where} \\

&amp; i = \text{Products in N} \\
&amp; p_i = \text{Profit margin for product i} \\
&amp; c_i = \text{Product daily capacity} \\
&amp; t_i = \text{Time to mold product i} \\
&amp; a_i = \text{Cubic inches of product i} \\
&amp; x_i = \text{Quantity of product i to mold} \\

\end{align*}\]</span>
$$</p>
<p>If we look closer on the dataframe, we can set constraints 2 and 3 as one with a matrix including capacity constraints, but for math notation I’ve set them differently since they are 2 different types of entities.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="ctlsc0x-supply-chain-analytics.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb33-2"><a href="ctlsc0x-supply-chain-analytics.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="ctlsc0x-supply-chain-analytics.html#cb33-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of products Toy and doll</span></span>
<span id="cb33-4"><a href="ctlsc0x-supply-chain-analytics.html#cb33-4" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fu">filter</span>(data, Type <span class="sc">==</span> <span class="st">&quot;index capacity&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Toy,doll) <span class="sc">%&gt;%</span> <span class="fu">gather</span>() <span class="sc">%&gt;%</span> .<span class="sc">$</span>value <span class="co">#index_capacity</span></span>
<span id="cb33-5"><a href="ctlsc0x-supply-chain-analytics.html#cb33-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">filter</span>(data, Type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Time&quot;</span>,<span class="st">&quot;Cubic Area&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Toy,doll)) <span class="co">#constraints left hand</span></span>
<span id="cb33-6"><a href="ctlsc0x-supply-chain-analytics.html#cb33-6" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fu">filter</span>(data, Type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Time&quot;</span>,<span class="st">&quot;Cubic Area&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Capacity) <span class="sc">%&gt;%</span> .<span class="sc">$</span>Capacity <span class="co">#constraints right hand</span></span>
<span id="cb33-7"><a href="ctlsc0x-supply-chain-analytics.html#cb33-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">filter</span>(data, Type <span class="sc">==</span> <span class="st">&quot;Profit&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Toy,doll) <span class="sc">%&gt;%</span> <span class="fu">gather</span>() <span class="sc">%&gt;%</span> .<span class="sc">$</span>value <span class="co">#profit</span></span>
<span id="cb33-8"><a href="ctlsc0x-supply-chain-analytics.html#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="ctlsc0x-supply-chain-analytics.html#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="ctlsc0x-supply-chain-analytics.html#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="ctlsc0x-supply-chain-analytics.html#cb33-11" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-12"><a href="ctlsc0x-supply-chain-analytics.html#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of profit</span></span>
<span id="cb33-13"><a href="ctlsc0x-supply-chain-analytics.html#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-14"><a href="ctlsc0x-supply-chain-analytics.html#cb33-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-15"><a href="ctlsc0x-supply-chain-analytics.html#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># minimize travel distance</span></span>
<span id="cb33-16"><a href="ctlsc0x-supply-chain-analytics.html#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(p[i]<span class="sc">*</span>x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-17"><a href="ctlsc0x-supply-chain-analytics.html#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="ctlsc0x-supply-chain-analytics.html#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># you cannot exceed the Plant Capacity</span></span>
<span id="cb33-19"><a href="ctlsc0x-supply-chain-analytics.html#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(x[i] <span class="sc">&lt;=</span> c[i], <span class="at">i=</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb33-20"><a href="ctlsc0x-supply-chain-analytics.html#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="ctlsc0x-supply-chain-analytics.html#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#You cannot exceed aditivie capacity</span></span>
<span id="cb33-22"><a href="ctlsc0x-supply-chain-analytics.html#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i] <span class="sc">*</span> a[j,i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> C[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb33-23"><a href="ctlsc0x-supply-chain-analytics.html#cb33-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-24"><a href="ctlsc0x-supply-chain-analytics.html#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb33-25"><a href="ctlsc0x-supply-chain-analytics.html#cb33-25" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>))</span>
<span id="cb33-26"><a href="ctlsc0x-supply-chain-analytics.html#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="ctlsc0x-supply-chain-analytics.html#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb33-28"><a href="ctlsc0x-supply-chain-analytics.html#cb33-28" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 2575</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="ctlsc0x-supply-chain-analytics.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb35-2"><a href="ctlsc0x-supply-chain-analytics.html#cb35-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] 
##   53   50</code></pre>
<p>Let’s solve the questions</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="ctlsc0x-supply-chain-analytics.html#cb37-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){<span class="dv">25</span><span class="sc">*</span>x<span class="sc">+</span><span class="dv">25</span><span class="sc">*</span>y}</span>
<span id="cb37-2"><a href="ctlsc0x-supply-chain-analytics.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Question 1: Graphical selection</span></span>
<span id="cb37-3"><a href="ctlsc0x-supply-chain-analytics.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Question 2: What is the value of x = 70 and y= 30</span></span>
<span id="cb37-4"><a href="ctlsc0x-supply-chain-analytics.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">P</span>(<span class="dv">70</span>,<span class="dv">30</span>)</span></code></pre></div>
<pre><code>## [1] 2500</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="ctlsc0x-supply-chain-analytics.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Question 3: What is the value of x = 50 and y= 53</span></span>
<span id="cb39-2"><a href="ctlsc0x-supply-chain-analytics.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">P</span>(<span class="dv">50</span>,<span class="dv">53</span>)</span></code></pre></div>
<pre><code>## [1] 2575</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="ctlsc0x-supply-chain-analytics.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Question 3: What is the value of x = 50 and y= 53</span></span>
<span id="cb41-2"><a href="ctlsc0x-supply-chain-analytics.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">P</span>(<span class="dv">20</span>,<span class="dv">75</span>)</span></code></pre></div>
<pre><code>## [1] 2375</code></pre>
</div>
<div id="crazy-cereal" class="section level4" number="1.1.2.6">
<h4><span class="header-section-number">1.1.2.6</span> Crazy Cereal</h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="ctlsc0x-supply-chain-analytics.html#cb43-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;Sugary&quot;</span>,<span class="st">&quot;Regular&quot;</span>,<span class="st">&quot;Capacity&quot;</span>), <span class="at">Sugar =</span> <span class="fu">c</span>(<span class="fl">0.66</span>,<span class="fl">0.21</span>,<span class="dv">2000</span>),</span>
<span id="cb43-2"><a href="ctlsc0x-supply-chain-analytics.html#cb43-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Corn_Flake =</span> <span class="fu">c</span>(<span class="fl">0.34</span>,<span class="fl">0.79</span>,<span class="dv">4000</span>), <span class="at">Profit =</span> <span class="fu">c</span>(<span class="fl">0.94</span>,<span class="fl">0.82</span>,<span class="cn">NA</span>))</span>
<span id="cb43-3"><a href="ctlsc0x-supply-chain-analytics.html#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="ctlsc0x-supply-chain-analytics.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Crazy Cereal&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-17">Table 1.3: </span>Crazy Cereal
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Sugar
</th>
<th style="text-align:right;">
Corn_Flake
</th>
<th style="text-align:right;">
Profit
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sugary
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.94
</td>
</tr>
<tr>
<td style="text-align:left;">
Regular
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.82
</td>
</tr>
<tr>
<td style="text-align:left;">
Capacity
</td>
<td style="text-align:right;">
2000.00
</td>
<td style="text-align:right;">
4000.00
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Maximize} &amp; \ y = \sum_{i=1}^{N} p_i \cdot x_{i} \\
\textbf{subject to}\\
    &amp; \sum_{i=1}^{N} x_{i} \cdot a_{i,j} \le C_j, \ j \in M \\
    &amp; x_{i} \ge 0, \ x \in \mathbb{Z} \\
    \\
    
\textbf{Where} \\

&amp; i = \text{Products in N} \\
&amp; j = \text{Components of N = M} \\
&amp; p_i = \text{Profit margin for product i} \\
&amp; a_{i,j} = \text{components for product i} \\
&amp; C_j = \text{Component capacity} \\
&amp; x_{i} = \text{Quantity of product} \\

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="ctlsc0x-supply-chain-analytics.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span></code></pre></div>
<pre><code>## Warning in rm(x): objeto &#39;x&#39; não encontrado</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="ctlsc0x-supply-chain-analytics.html#cb46-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of products Sugary and Regular</span></span>
<span id="cb46-2"><a href="ctlsc0x-supply-chain-analytics.html#cb46-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of components Sugar and Corn_Flake</span></span>
<span id="cb46-3"><a href="ctlsc0x-supply-chain-analytics.html#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="ctlsc0x-supply-chain-analytics.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Let&#39;s do some roots R instead of dplyr :)</span></span>
<span id="cb46-5"><a href="ctlsc0x-supply-chain-analytics.html#cb46-5" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fu">as.matrix</span>(data[data<span class="sc">$</span>Type <span class="sc">==</span> <span class="st">&quot;Capacity&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;Sugar&quot;</span>, <span class="st">&quot;Corn_Flake&quot;</span>)])</span>
<span id="cb46-6"><a href="ctlsc0x-supply-chain-analytics.html#cb46-6" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">as.matrix</span>(data[data<span class="sc">$</span>Type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Sugary&quot;</span>,<span class="st">&quot;Regular&quot;</span>),<span class="fu">c</span>(<span class="st">&quot;Sugar&quot;</span>, <span class="st">&quot;Corn_Flake&quot;</span>)])</span>
<span id="cb46-7"><a href="ctlsc0x-supply-chain-analytics.html#cb46-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">as.matrix</span>(data<span class="sc">$</span>Profit[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb46-8"><a href="ctlsc0x-supply-chain-analytics.html#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="ctlsc0x-supply-chain-analytics.html#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="ctlsc0x-supply-chain-analytics.html#cb46-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-11"><a href="ctlsc0x-supply-chain-analytics.html#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of profit</span></span>
<span id="cb46-12"><a href="ctlsc0x-supply-chain-analytics.html#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-13"><a href="ctlsc0x-supply-chain-analytics.html#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="ctlsc0x-supply-chain-analytics.html#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb46-15"><a href="ctlsc0x-supply-chain-analytics.html#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(p[i] <span class="sc">*</span> x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-16"><a href="ctlsc0x-supply-chain-analytics.html#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="ctlsc0x-supply-chain-analytics.html#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#You cannot exceed component capacity</span></span>
<span id="cb46-18"><a href="ctlsc0x-supply-chain-analytics.html#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i] <span class="sc">*</span> a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">&lt;=</span> C[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb46-19"><a href="ctlsc0x-supply-chain-analytics.html#cb46-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-20"><a href="ctlsc0x-supply-chain-analytics.html#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb46-21"><a href="ctlsc0x-supply-chain-analytics.html#cb46-21" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>))</span>
<span id="cb46-22"><a href="ctlsc0x-supply-chain-analytics.html#cb46-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-23"><a href="ctlsc0x-supply-chain-analytics.html#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb46-24"><a href="ctlsc0x-supply-chain-analytics.html#cb46-24" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 5116.46</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="ctlsc0x-supply-chain-analytics.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb48-2"><a href="ctlsc0x-supply-chain-analytics.html#cb48-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] 
## 1644 4355</code></pre>
</div>
<div id="jims-meat-packing-company" class="section level4" number="1.1.2.7">
<h4><span class="header-section-number">1.1.2.7</span> Jim’s Meat Packing Company</h4>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="ctlsc0x-supply-chain-analytics.html#cb50-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Cut =</span> <span class="fu">c</span>(<span class="st">&quot;Chuck&quot;</span>,<span class="st">&quot;Sirloin&quot;</span>,<span class="st">&quot;Restriction&quot;</span>), <span class="at">Lean_Meat =</span> <span class="fu">c</span>(<span class="fl">0.09</span>,<span class="fl">0.6</span>,<span class="fl">0.3</span>),</span>
<span id="cb50-2"><a href="ctlsc0x-supply-chain-analytics.html#cb50-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Fat_Meat =</span> <span class="fu">c</span>(<span class="fl">0.02</span>,<span class="fl">0.06</span>,<span class="fl">0.05</span>), <span class="at">Cost =</span> <span class="fu">c</span>(<span class="fl">9.3</span>,<span class="fl">8.4</span>,<span class="cn">NA</span>))</span>
<span id="cb50-3"><a href="ctlsc0x-supply-chain-analytics.html#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="ctlsc0x-supply-chain-analytics.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Jim&#39;s Meat&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-19">Table 1.4: </span>Jim’s Meat
</caption>
<thead>
<tr>
<th style="text-align:left;">
Cut
</th>
<th style="text-align:right;">
Lean_Meat
</th>
<th style="text-align:right;">
Fat_Meat
</th>
<th style="text-align:right;">
Cost
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Chuck
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
9.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Sirloin
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
8.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Restriction
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Minimize} &amp; \ y = \sum_{i=1}^{N} c_i \cdot x_{i} \\
\textbf{subject to}\\
    &amp; \sum_{i=1}^{N} x_{i} \cdot a_{i,j} \ge \sum_{i=1}^{N} R_j \cdot x_{i}, \ \ j \in N=1 \\
    &amp; \sum_{i=1}^{N} x_{i} \cdot a_{i,j} \le \sum_{i=1}^{N} R_j \cdot x_{i}, \ \ j \in N=2 \\
    &amp; \sum_{i=1}^{N} x_{i} \ge 50 \\
    &amp; x_{i} \ge 0, \ x \in \mathbb{Z} \\
    
    \\
    
\textbf{Where} \\

&amp; i = \text{Type of cut in N} \\
&amp; j = \text{Type of meat} \\
&amp; c_i = \text{Cost for product i} \\
&amp; a_{i,j} = \text{components for product i} \\
&amp; R_j = \text{Restriction capacity} \\
&amp; x_{i} = \text{Quantity of product} \\

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="ctlsc0x-supply-chain-analytics.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span></code></pre></div>
<pre><code>## Warning in rm(x): objeto &#39;x&#39; não encontrado</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="ctlsc0x-supply-chain-analytics.html#cb53-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of products Sugary and Regular</span></span>
<span id="cb53-2"><a href="ctlsc0x-supply-chain-analytics.html#cb53-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of components Sugar and Corn_Flake</span></span>
<span id="cb53-3"><a href="ctlsc0x-supply-chain-analytics.html#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="ctlsc0x-supply-chain-analytics.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Another way of subsetting data in R</span></span>
<span id="cb53-5"><a href="ctlsc0x-supply-chain-analytics.html#cb53-5" aria-hidden="true" tabindex="-1"></a>R <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb53-6"><a href="ctlsc0x-supply-chain-analytics.html#cb53-6" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb53-7"><a href="ctlsc0x-supply-chain-analytics.html#cb53-7" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">4</span>])</span>
<span id="cb53-8"><a href="ctlsc0x-supply-chain-analytics.html#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="ctlsc0x-supply-chain-analytics.html#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="ctlsc0x-supply-chain-analytics.html#cb53-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-11"><a href="ctlsc0x-supply-chain-analytics.html#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of profit</span></span>
<span id="cb53-12"><a href="ctlsc0x-supply-chain-analytics.html#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-13"><a href="ctlsc0x-supply-chain-analytics.html#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="ctlsc0x-supply-chain-analytics.html#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb53-15"><a href="ctlsc0x-supply-chain-analytics.html#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(c[i] <span class="sc">*</span> x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;min&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-16"><a href="ctlsc0x-supply-chain-analytics.html#cb53-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-17"><a href="ctlsc0x-supply-chain-analytics.html#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#yay</span></span>
<span id="cb53-18"><a href="ctlsc0x-supply-chain-analytics.html#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-19"><a href="ctlsc0x-supply-chain-analytics.html#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="ctlsc0x-supply-chain-analytics.html#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#You cannot exceed component capacity</span></span>
<span id="cb53-21"><a href="ctlsc0x-supply-chain-analytics.html#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i] <span class="sc">*</span> a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> <span class="fu">sum_expr</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)<span class="sc">*</span>R[j], <span class="at">j =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-22"><a href="ctlsc0x-supply-chain-analytics.html#cb53-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-23"><a href="ctlsc0x-supply-chain-analytics.html#cb53-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-24"><a href="ctlsc0x-supply-chain-analytics.html#cb53-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i] <span class="sc">*</span> a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> <span class="fu">sum_expr</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)<span class="sc">*</span>R[j], <span class="at">j =</span> <span class="dv">2</span>)</span>
<span id="cb53-25"><a href="ctlsc0x-supply-chain-analytics.html#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="ctlsc0x-supply-chain-analytics.html#cb53-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-27"><a href="ctlsc0x-supply-chain-analytics.html#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb53-28"><a href="ctlsc0x-supply-chain-analytics.html#cb53-28" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>, <span class="at">verbose =</span> F))</span>
<span id="cb53-29"><a href="ctlsc0x-supply-chain-analytics.html#cb53-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-30"><a href="ctlsc0x-supply-chain-analytics.html#cb53-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb53-31"><a href="ctlsc0x-supply-chain-analytics.html#cb53-31" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 431.7</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="ctlsc0x-supply-chain-analytics.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb55-2"><a href="ctlsc0x-supply-chain-analytics.html#cb55-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] 
##   13   37</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="ctlsc0x-supply-chain-analytics.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Duals</span></span>
<span id="cb57-2"><a href="ctlsc0x-supply-chain-analytics.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_column_duals</span>(result)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>I couldn’t find a proper function on shadow price calculation on ompr package, so lets try to calculate it ourselves!</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="ctlsc0x-supply-chain-analytics.html#cb59-1" aria-hidden="true" tabindex="-1"></a>ModelIter <span class="ot">&lt;-</span> <span class="cf">function</span>(z){</span>
<span id="cb59-2"><a href="ctlsc0x-supply-chain-analytics.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-3"><a href="ctlsc0x-supply-chain-analytics.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="ctlsc0x-supply-chain-analytics.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of profit</span></span>
<span id="cb59-5"><a href="ctlsc0x-supply-chain-analytics.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-6"><a href="ctlsc0x-supply-chain-analytics.html#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="ctlsc0x-supply-chain-analytics.html#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb59-8"><a href="ctlsc0x-supply-chain-analytics.html#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(c[i] <span class="sc">*</span> x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;min&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-9"><a href="ctlsc0x-supply-chain-analytics.html#cb59-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-10"><a href="ctlsc0x-supply-chain-analytics.html#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#yay</span></span>
<span id="cb59-11"><a href="ctlsc0x-supply-chain-analytics.html#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> z) <span class="sc">%&gt;%</span></span>
<span id="cb59-12"><a href="ctlsc0x-supply-chain-analytics.html#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="ctlsc0x-supply-chain-analytics.html#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#You cannot exceed component capacity</span></span>
<span id="cb59-14"><a href="ctlsc0x-supply-chain-analytics.html#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i] <span class="sc">*</span> a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> <span class="fu">sum_expr</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)<span class="sc">*</span>R[j], <span class="at">j =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-15"><a href="ctlsc0x-supply-chain-analytics.html#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="ctlsc0x-supply-chain-analytics.html#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i] <span class="sc">*</span> a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> <span class="fu">sum_expr</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)<span class="sc">*</span>R[j], <span class="at">j =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-17"><a href="ctlsc0x-supply-chain-analytics.html#cb59-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-18"><a href="ctlsc0x-supply-chain-analytics.html#cb59-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">solve_model</span>(<span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>, <span class="at">verbose =</span> F))</span>
<span id="cb59-19"><a href="ctlsc0x-supply-chain-analytics.html#cb59-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-20"><a href="ctlsc0x-supply-chain-analytics.html#cb59-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(model<span class="sc">$</span>objective_value)</span>
<span id="cb59-21"><a href="ctlsc0x-supply-chain-analytics.html#cb59-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-22"><a href="ctlsc0x-supply-chain-analytics.html#cb59-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-23"><a href="ctlsc0x-supply-chain-analytics.html#cb59-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-24"><a href="ctlsc0x-supply-chain-analytics.html#cb59-24" aria-hidden="true" tabindex="-1"></a>Iter_Results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">constraint =</span> <span class="fu">seq</span>(<span class="dv">48</span>,<span class="dv">55</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-25"><a href="ctlsc0x-supply-chain-analytics.html#cb59-25" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">Obj_value =</span> <span class="fu">as.numeric</span>(<span class="fu">map</span>(constraint, ModelIter)),</span>
<span id="cb59-26"><a href="ctlsc0x-supply-chain-analytics.html#cb59-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">Marginal_value =</span> <span class="fu">round</span>((Obj_value<span class="sc">-</span><span class="fu">lag</span>(Obj_value,<span class="dv">1</span>)<span class="sc">/</span>(constraint<span class="sc">-</span><span class="fu">lag</span>(constraint,<span class="dv">1</span>))),<span class="dv">2</span>))</span>
<span id="cb59-27"><a href="ctlsc0x-supply-chain-analytics.html#cb59-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-28"><a href="ctlsc0x-supply-chain-analytics.html#cb59-28" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Iter_Results, <span class="at">caption =</span> <span class="st">&quot;Result&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-21">Table 1.5: </span>Result
</caption>
<thead>
<tr>
<th style="text-align:right;">
constraint
</th>
<th style="text-align:right;">
Obj_value
</th>
<th style="text-align:right;">
Marginal_value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
414.0
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
423.3
</td>
<td style="text-align:right;">
9.3
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
431.7
</td>
<td style="text-align:right;">
8.4
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
440.1
</td>
<td style="text-align:right;">
8.4
</td>
</tr>
<tr>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
448.5
</td>
<td style="text-align:right;">
8.4
</td>
</tr>
<tr>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
457.8
</td>
<td style="text-align:right;">
9.3
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
466.2
</td>
<td style="text-align:right;">
8.4
</td>
</tr>
<tr>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
474.6
</td>
<td style="text-align:right;">
8.4
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="ctlsc0x-supply-chain-analytics.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Iter_Results<span class="sc">$</span>Marginal_value[<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(Iter_Results)]) <span class="co">#Didn&#39;t work</span></span></code></pre></div>
<pre><code>## [1] 8.85</code></pre>
<p>Marginal Value set as 8.85 got us an error, the answer was 8.63, would be good to understand what was made wrong in here.</p>
</div>
<div id="johns-shipping-company" class="section level4" number="1.1.2.8">
<h4><span class="header-section-number">1.1.2.8</span> John’s Shipping Company</h4>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="ctlsc0x-supply-chain-analytics.html#cb62-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Fuel_Type =</span> <span class="fu">c</span>(<span class="st">&quot;O_Type&quot;</span>,<span class="st">&quot;D_Type&quot;</span>,<span class="st">&quot;Restriction&quot;</span>), <span class="at">Hydrogen_Conc =</span> <span class="fu">c</span>(<span class="dv">45</span>,<span class="dv">90</span>,<span class="dv">60</span>),</span>
<span id="cb62-2"><a href="ctlsc0x-supply-chain-analytics.html#cb62-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Oxygen_Conc =</span> <span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">6</span>,<span class="dv">9</span>), <span class="at">Cost =</span> <span class="fu">c</span>(<span class="fl">1.05</span>,<span class="fl">1.34</span>,<span class="cn">NA</span>))</span>
<span id="cb62-3"><a href="ctlsc0x-supply-chain-analytics.html#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="ctlsc0x-supply-chain-analytics.html#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;John&#39;s Shipping Company&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-22">Table 1.6: </span>John’s Shipping Company
</caption>
<thead>
<tr>
<th style="text-align:left;">
Fuel_Type
</th>
<th style="text-align:right;">
Hydrogen_Conc
</th>
<th style="text-align:right;">
Oxygen_Conc
</th>
<th style="text-align:right;">
Cost
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
O_Type
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
1.05
</td>
</tr>
<tr>
<td style="text-align:left;">
D_Type
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1.34
</td>
</tr>
<tr>
<td style="text-align:left;">
Restriction
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Minimize} &amp; \ y = \sum_{i=1}^{N} c_i \cdot x_{i} \\
\textbf{subject to}\\
    &amp; \sum_{i=1}^{N} x_{i} \cdot a_{i,j} \ge \sum_{i=1}^{N} R_j \cdot x_{i}, \ \ j \in N=1 \\
    &amp; \sum_{i=1}^{N} x_{i} \cdot a_{i,j} \le \sum_{i=1}^{N} R_j \cdot x_{i}, \ \ j \in N=2 \\
    &amp; \sum_{i=1}^{N} x_{i} \ge G \\
    &amp; x_{i} \ge 0, \ x \in \mathbb{Z} \\
    
    \\
    
\textbf{Where} \\

&amp; i = \text{Type of cut in N} \\
&amp; j = \text{Type of meat} \\
&amp; c_i = \text{Cost for product i} \\
&amp; a_{i,j} = \text{components for product i} \\
&amp; R_j = \text{Restriction capacity} \\
&amp; x_{i} = \text{Quantity of product} \\
&amp; G = \text{Minimum to be produced} \\

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="ctlsc0x-supply-chain-analytics.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span></code></pre></div>
<pre><code>## Warning in rm(x): objeto &#39;x&#39; não encontrado</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="ctlsc0x-supply-chain-analytics.html#cb65-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of products Sugary and Regular</span></span>
<span id="cb65-2"><a href="ctlsc0x-supply-chain-analytics.html#cb65-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of components Sugar and Corn_Flake</span></span>
<span id="cb65-3"><a href="ctlsc0x-supply-chain-analytics.html#cb65-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="dv">10000</span> <span class="co">#minimum to be produced</span></span>
<span id="cb65-4"><a href="ctlsc0x-supply-chain-analytics.html#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="ctlsc0x-supply-chain-analytics.html#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Another way of subsetting data in R</span></span>
<span id="cb65-6"><a href="ctlsc0x-supply-chain-analytics.html#cb65-6" aria-hidden="true" tabindex="-1"></a>R <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb65-7"><a href="ctlsc0x-supply-chain-analytics.html#cb65-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb65-8"><a href="ctlsc0x-supply-chain-analytics.html#cb65-8" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">4</span>])</span>
<span id="cb65-9"><a href="ctlsc0x-supply-chain-analytics.html#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="ctlsc0x-supply-chain-analytics.html#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="ctlsc0x-supply-chain-analytics.html#cb65-11" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-12"><a href="ctlsc0x-supply-chain-analytics.html#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of profit</span></span>
<span id="cb65-13"><a href="ctlsc0x-supply-chain-analytics.html#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-14"><a href="ctlsc0x-supply-chain-analytics.html#cb65-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-15"><a href="ctlsc0x-supply-chain-analytics.html#cb65-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb65-16"><a href="ctlsc0x-supply-chain-analytics.html#cb65-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(c[i] <span class="sc">*</span> x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;min&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-17"><a href="ctlsc0x-supply-chain-analytics.html#cb65-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-18"><a href="ctlsc0x-supply-chain-analytics.html#cb65-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Produce at least the minimum required</span></span>
<span id="cb65-19"><a href="ctlsc0x-supply-chain-analytics.html#cb65-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> z) <span class="sc">%&gt;%</span></span>
<span id="cb65-20"><a href="ctlsc0x-supply-chain-analytics.html#cb65-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-21"><a href="ctlsc0x-supply-chain-analytics.html#cb65-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Minimum component required</span></span>
<span id="cb65-22"><a href="ctlsc0x-supply-chain-analytics.html#cb65-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i] <span class="sc">*</span> a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> <span class="fu">sum_expr</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)<span class="sc">*</span>R[j], <span class="at">j =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-23"><a href="ctlsc0x-supply-chain-analytics.html#cb65-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-24"><a href="ctlsc0x-supply-chain-analytics.html#cb65-24" aria-hidden="true" tabindex="-1"></a>   <span class="co">#You cannot exceed component capacity</span></span>
<span id="cb65-25"><a href="ctlsc0x-supply-chain-analytics.html#cb65-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i] <span class="sc">*</span> a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> <span class="fu">sum_expr</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)<span class="sc">*</span>R[j], <span class="at">j =</span> <span class="dv">2</span>)</span>
<span id="cb65-26"><a href="ctlsc0x-supply-chain-analytics.html#cb65-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-27"><a href="ctlsc0x-supply-chain-analytics.html#cb65-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb65-28"><a href="ctlsc0x-supply-chain-analytics.html#cb65-28" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>, <span class="at">verbose =</span> F))</span>
<span id="cb65-29"><a href="ctlsc0x-supply-chain-analytics.html#cb65-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-30"><a href="ctlsc0x-supply-chain-analytics.html#cb65-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb65-31"><a href="ctlsc0x-supply-chain-analytics.html#cb65-31" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 12433.43</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="ctlsc0x-supply-chain-analytics.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb67-2"><a href="ctlsc0x-supply-chain-analytics.html#cb67-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] 
## 3333 6667</code></pre>
</div>
<div id="a-new-office-plant" class="section level4" number="1.1.2.9">
<h4><span class="header-section-number">1.1.2.9</span> A New Office Plant</h4>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="ctlsc0x-supply-chain-analytics.html#cb69-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;Product_1&quot;</span>,<span class="st">&quot;Product_2&quot;</span>,<span class="st">&quot;Product_3&quot;</span>, <span class="st">&quot;Min&quot;</span>, <span class="st">&quot;Max&quot;</span>),</span>
<span id="cb69-2"><a href="ctlsc0x-supply-chain-analytics.html#cb69-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Nitrogen  =</span> <span class="fu">c</span>(<span class="dv">360</span>,<span class="dv">380</span>,<span class="dv">310</span>,<span class="dv">1800</span>,<span class="dv">2200</span>), <span class="at">Potassium =</span> <span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">20</span>,<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">100</span>),</span>
<span id="cb69-3"><a href="ctlsc0x-supply-chain-analytics.html#cb69-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">cost =</span> <span class="fu">c</span>(<span class="fl">1.59</span>,<span class="fl">2.19</span>,<span class="fl">2.99</span>,<span class="cn">NA</span>,<span class="cn">NA</span>))</span>
<span id="cb69-4"><a href="ctlsc0x-supply-chain-analytics.html#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="ctlsc0x-supply-chain-analytics.html#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;A New Office Plant&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-24">Table 1.7: </span>A New Office Plant
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Nitrogen
</th>
<th style="text-align:right;">
Potassium
</th>
<th style="text-align:right;">
cost
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Product_1
</td>
<td style="text-align:right;">
360
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
1.59
</td>
</tr>
<tr>
<td style="text-align:left;">
Product_2
</td>
<td style="text-align:right;">
380
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
2.19
</td>
</tr>
<tr>
<td style="text-align:left;">
Product_3
</td>
<td style="text-align:right;">
310
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
2.99
</td>
</tr>
<tr>
<td style="text-align:left;">
Min
</td>
<td style="text-align:right;">
1800
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Max
</td>
<td style="text-align:right;">
2200
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Minimize} &amp; \ y = \sum_{i=1}^{N} c_i \cdot x_{i} \\
\textbf{subject to}\\
    &amp; \sum_{i=1}^{N} x_{i} \cdot a_{i,j} \ge Min_j, \ \ j \in M \\
    &amp; \sum_{i=1}^{N} x_{i} \cdot a_{i,j} \le Max_j, \ \ j \in M \\
    &amp; x_{i} \ge 0 \\
    
\textbf{Where} \\

&amp; i = \text{Type of product in N} \\
&amp; j = \text{Type of component in M} \\
&amp; c_i = \text{Cost for product i} \\
&amp; a_{i,j} = \text{components for product i} \\
&amp; Min_j = \text{Restriction of component} \\
&amp; Max_j = \text{Restriction of component} \\
&amp; x_{i} = \text{Quantity of product} \\

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="ctlsc0x-supply-chain-analytics.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span></code></pre></div>
<pre><code>## Warning in rm(x): objeto &#39;x&#39; não encontrado</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="ctlsc0x-supply-chain-analytics.html#cb72-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of products</span></span>
<span id="cb72-2"><a href="ctlsc0x-supply-chain-analytics.html#cb72-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of components</span></span>
<span id="cb72-3"><a href="ctlsc0x-supply-chain-analytics.html#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="ctlsc0x-supply-chain-analytics.html#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb72-5"><a href="ctlsc0x-supply-chain-analytics.html#cb72-5" aria-hidden="true" tabindex="-1"></a>min <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb72-6"><a href="ctlsc0x-supply-chain-analytics.html#cb72-6" aria-hidden="true" tabindex="-1"></a>max <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb72-7"><a href="ctlsc0x-supply-chain-analytics.html#cb72-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb72-8"><a href="ctlsc0x-supply-chain-analytics.html#cb72-8" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb72-9"><a href="ctlsc0x-supply-chain-analytics.html#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="ctlsc0x-supply-chain-analytics.html#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="ctlsc0x-supply-chain-analytics.html#cb72-11" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-12"><a href="ctlsc0x-supply-chain-analytics.html#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of profit</span></span>
<span id="cb72-13"><a href="ctlsc0x-supply-chain-analytics.html#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;continuous&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-14"><a href="ctlsc0x-supply-chain-analytics.html#cb72-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-15"><a href="ctlsc0x-supply-chain-analytics.html#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb72-16"><a href="ctlsc0x-supply-chain-analytics.html#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(c[i] <span class="sc">*</span> x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;min&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-17"><a href="ctlsc0x-supply-chain-analytics.html#cb72-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-18"><a href="ctlsc0x-supply-chain-analytics.html#cb72-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Produce at least the minimum required</span></span>
<span id="cb72-19"><a href="ctlsc0x-supply-chain-analytics.html#cb72-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> min[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">%&gt;%</span></span>
<span id="cb72-20"><a href="ctlsc0x-supply-chain-analytics.html#cb72-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-21"><a href="ctlsc0x-supply-chain-analytics.html#cb72-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Dont exceed maximum required</span></span>
<span id="cb72-22"><a href="ctlsc0x-supply-chain-analytics.html#cb72-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> max[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb72-23"><a href="ctlsc0x-supply-chain-analytics.html#cb72-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-24"><a href="ctlsc0x-supply-chain-analytics.html#cb72-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb72-25"><a href="ctlsc0x-supply-chain-analytics.html#cb72-25" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>, <span class="at">verbose =</span> F))</span>
<span id="cb72-26"><a href="ctlsc0x-supply-chain-analytics.html#cb72-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-27"><a href="ctlsc0x-supply-chain-analytics.html#cb72-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb72-28"><a href="ctlsc0x-supply-chain-analytics.html#cb72-28" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 10.14286</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="ctlsc0x-supply-chain-analytics.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb74-2"><a href="ctlsc0x-supply-chain-analytics.html#cb74-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>##      x[1]      x[2]      x[3] 
## 0.4761905 4.2857143 0.0000000</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="ctlsc0x-supply-chain-analytics.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Question: How many mg of Nitrogen would your solution provide to the plant every day? (Please round your answer to integer number)</span></span>
<span id="cb76-2"><a href="ctlsc0x-supply-chain-analytics.html#cb76-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution[<span class="dv">1</span>]<span class="sc">*</span>a[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">+</span>result<span class="sc">$</span>solution[<span class="dv">2</span>]<span class="sc">*</span>a[<span class="dv">2</span>,<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## x[1] 
## 1800</code></pre>
</div>
<div id="rochaks-ink-company" class="section level4" number="1.1.2.10">
<h4><span class="header-section-number">1.1.2.10</span> Rochak’s Ink Company</h4>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="ctlsc0x-supply-chain-analytics.html#cb78-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;P_Cyan&quot;</span>,<span class="st">&quot;P_Magenta&quot;</span>,<span class="st">&quot;P_Yellow&quot;</span>,<span class="st">&quot;Max&quot;</span>),</span>
<span id="cb78-2"><a href="ctlsc0x-supply-chain-analytics.html#cb78-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Stage1  =</span> <span class="fu">c</span>(<span class="fl">0.44</span>,<span class="fl">0.51</span>,<span class="fl">0.5</span>,<span class="dv">17</span><span class="sc">*</span><span class="dv">60</span><span class="sc">^</span><span class="dv">2</span>), <span class="at">Stage2 =</span> <span class="fu">c</span>(<span class="fl">0.55</span>,<span class="fl">0.6</span>,<span class="fl">0.59</span>,<span class="dv">23</span><span class="sc">*</span><span class="dv">60</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb78-3"><a href="ctlsc0x-supply-chain-analytics.html#cb78-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Demand =</span> <span class="fu">c</span>(<span class="dv">84000</span>,<span class="dv">72000</span>,<span class="dv">93000</span>,<span class="cn">NA</span>), <span class="at">Profit =</span> <span class="fu">c</span>(<span class="fl">0.6</span>,<span class="fl">0.72</span>,<span class="fl">0.62</span>,<span class="cn">NA</span>))</span>
<span id="cb78-4"><a href="ctlsc0x-supply-chain-analytics.html#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="ctlsc0x-supply-chain-analytics.html#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Rochak&#39;s Ink Company&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-26">Table 1.8: </span>Rochak’s Ink Company
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Stage1
</th>
<th style="text-align:right;">
Stage2
</th>
<th style="text-align:right;">
Demand
</th>
<th style="text-align:right;">
Profit
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P_Cyan
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
84000
</td>
<td style="text-align:right;">
0.60
</td>
</tr>
<tr>
<td style="text-align:left;">
P_Magenta
</td>
<td style="text-align:right;">
0.51
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
72000
</td>
<td style="text-align:right;">
0.72
</td>
</tr>
<tr>
<td style="text-align:left;">
P_Yellow
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
93000
</td>
<td style="text-align:right;">
0.62
</td>
</tr>
<tr>
<td style="text-align:left;">
Max
</td>
<td style="text-align:right;">
61200.00
</td>
<td style="text-align:right;">
82800.00
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Maximize} &amp; \ y = \sum_{i=1}^{N} p_i \cdot x_{i} \\
\textbf{subject to}\\
    &amp; \sum_{i=1}^{N} x_{i} \cdot a_{i,j} \le Max_j, \ \ j \in M \\
    &amp; \sum_{i=1}^{N} x_{i} \le D_i \\
    &amp; x_{i} \ge 0, \ x \in \mathbb{Z} \\
    
\textbf{Where} \\

&amp; i = \text{Type of product in N} \\
&amp; j = \text{Production stage in M} \\
&amp; p_i = \text{Profit for product i} \\
&amp; a_{i,j} = \text{Time requirement for product i in stage j} \\
&amp; Max_j = \text{Restriction of production time} \\
&amp; D_i = \text{Demand for product} \\
&amp; x_{i} = \text{Quantity of product} \\

\end{align*}\]</span>
$$</p>
<p>In this exercise, you’re willing to maximize profit given the demand. You don’t have to fulfill all of the demand, that’s why the $ <em>{i=1}^{N} x</em>{i} D_i$ constraint.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="ctlsc0x-supply-chain-analytics.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span></code></pre></div>
<pre><code>## Warning in rm(x): objeto &#39;x&#39; não encontrado</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="ctlsc0x-supply-chain-analytics.html#cb81-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of products</span></span>
<span id="cb81-2"><a href="ctlsc0x-supply-chain-analytics.html#cb81-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of components</span></span>
<span id="cb81-3"><a href="ctlsc0x-supply-chain-analytics.html#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="ctlsc0x-supply-chain-analytics.html#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb81-5"><a href="ctlsc0x-supply-chain-analytics.html#cb81-5" aria-hidden="true" tabindex="-1"></a>D <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb81-6"><a href="ctlsc0x-supply-chain-analytics.html#cb81-6" aria-hidden="true" tabindex="-1"></a>max <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb81-7"><a href="ctlsc0x-supply-chain-analytics.html#cb81-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb81-8"><a href="ctlsc0x-supply-chain-analytics.html#cb81-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span>])</span>
<span id="cb81-9"><a href="ctlsc0x-supply-chain-analytics.html#cb81-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-10"><a href="ctlsc0x-supply-chain-analytics.html#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="ctlsc0x-supply-chain-analytics.html#cb81-11" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb81-12"><a href="ctlsc0x-supply-chain-analytics.html#cb81-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of profit</span></span>
<span id="cb81-13"><a href="ctlsc0x-supply-chain-analytics.html#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-14"><a href="ctlsc0x-supply-chain-analytics.html#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="ctlsc0x-supply-chain-analytics.html#cb81-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb81-16"><a href="ctlsc0x-supply-chain-analytics.html#cb81-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(p[i] <span class="sc">*</span> x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-17"><a href="ctlsc0x-supply-chain-analytics.html#cb81-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-18"><a href="ctlsc0x-supply-chain-analytics.html#cb81-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Don&#39;t produce something you don&#39;t have demand for</span></span>
<span id="cb81-19"><a href="ctlsc0x-supply-chain-analytics.html#cb81-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(x[i] <span class="sc">&lt;=</span> D[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb81-20"><a href="ctlsc0x-supply-chain-analytics.html#cb81-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-21"><a href="ctlsc0x-supply-chain-analytics.html#cb81-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Dont exceed maximum required</span></span>
<span id="cb81-22"><a href="ctlsc0x-supply-chain-analytics.html#cb81-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> max[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb81-23"><a href="ctlsc0x-supply-chain-analytics.html#cb81-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-24"><a href="ctlsc0x-supply-chain-analytics.html#cb81-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb81-25"><a href="ctlsc0x-supply-chain-analytics.html#cb81-25" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>, <span class="at">verbose =</span> F))</span>
<span id="cb81-26"><a href="ctlsc0x-supply-chain-analytics.html#cb81-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-27"><a href="ctlsc0x-supply-chain-analytics.html#cb81-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb81-28"><a href="ctlsc0x-supply-chain-analytics.html#cb81-28" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 85221.72</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="ctlsc0x-supply-chain-analytics.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb83-2"><a href="ctlsc0x-supply-chain-analytics.html#cb83-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>##  x[1]  x[2]  x[3] 
## 55641 71996     0</code></pre>
</div>
<div id="pasteur-cheese-factory" class="section level4" number="1.1.2.11">
<h4><span class="header-section-number">1.1.2.11</span> Pasteur Cheese Factory</h4>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="ctlsc0x-supply-chain-analytics.html#cb85-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;P_Original&quot;</span>,<span class="st">&quot;P_Cheddar&quot;</span>,<span class="st">&quot;P_Wasabi&quot;</span>,<span class="st">&quot;Max&quot;</span>,<span class="st">&quot;Cost&quot;</span>),</span>
<span id="cb85-2"><a href="ctlsc0x-supply-chain-analytics.html#cb85-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">X_Ray  =</span> <span class="fu">c</span>(<span class="fl">8.6</span>,<span class="fl">2.2</span>,<span class="fl">5.1</span>,<span class="dv">8</span><span class="sc">*</span><span class="dv">60</span>,<span class="fl">0.11</span>), <span class="at">Checkweigher =</span> <span class="fu">c</span>(<span class="fl">7.0</span>,<span class="fl">6.8</span>,<span class="fl">9.8</span>,<span class="dv">9</span><span class="sc">*</span><span class="dv">60</span>,<span class="fl">0.22</span>),</span>
<span id="cb85-3"><a href="ctlsc0x-supply-chain-analytics.html#cb85-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Profit =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">15</span>,<span class="dv">17</span>,<span class="cn">NA</span>,<span class="cn">NA</span>))</span>
<span id="cb85-4"><a href="ctlsc0x-supply-chain-analytics.html#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="ctlsc0x-supply-chain-analytics.html#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Pasteur Cheese Factory&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-28">Table 1.9: </span>Pasteur Cheese Factory
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
X_Ray
</th>
<th style="text-align:right;">
Checkweigher
</th>
<th style="text-align:right;">
Profit
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P_Original
</td>
<td style="text-align:right;">
8.60
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:right;">
20
</td>
</tr>
<tr>
<td style="text-align:left;">
P_Cheddar
</td>
<td style="text-align:right;">
2.20
</td>
<td style="text-align:right;">
6.80
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
P_Wasabi
</td>
<td style="text-align:right;">
5.10
</td>
<td style="text-align:right;">
9.80
</td>
<td style="text-align:right;">
17
</td>
</tr>
<tr>
<td style="text-align:left;">
Max
</td>
<td style="text-align:right;">
480.00
</td>
<td style="text-align:right;">
540.00
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Cost
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Maximize} &amp; \ y = \sum_{i=1}^{N} x_{i} \cdot \left( p_i - \sum_{j=1}^{M} c_{i,j} \right) \\
\textbf{subject to}\\
    &amp; \sum_{i=1}^{N} x_{i} \cdot a_{i,j} \le Max_j, \ \ j \in M \\
    &amp; x_{i} \ge 0, \ x \in \mathbb{Z} \\
    
\textbf{Where} \\

&amp; i = \text{Type of product in N} \\
&amp; j = \text{Production stage in M} \\
&amp; p_i = \text{Profit for product i} \\
&amp; c_{i,j} = \text{Cost for product i in stage j} \\
&amp; a_{i,j} = \text{Time requirement for product i in stage j} \\
&amp; Max_j = \text{Restriction of production time} \\
&amp; D_i = \text{Demand for product} \\
&amp; x_{i} = \text{Quantity of product} \\

\end{align*}\]</span>
$$</p>
<p>In this exercise, you’re willing to maximize profit given the cost of production.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="ctlsc0x-supply-chain-analytics.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span></code></pre></div>
<pre><code>## Warning in rm(x): objeto &#39;x&#39; não encontrado</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="ctlsc0x-supply-chain-analytics.html#cb88-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of products</span></span>
<span id="cb88-2"><a href="ctlsc0x-supply-chain-analytics.html#cb88-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of components</span></span>
<span id="cb88-3"><a href="ctlsc0x-supply-chain-analytics.html#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="ctlsc0x-supply-chain-analytics.html#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb88-5"><a href="ctlsc0x-supply-chain-analytics.html#cb88-5" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fu">as.vector</span>(data[<span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]) <span class="co">#This cost will be changed</span></span>
<span id="cb88-6"><a href="ctlsc0x-supply-chain-analytics.html#cb88-6" aria-hidden="true" tabindex="-1"></a>max <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb88-7"><a href="ctlsc0x-supply-chain-analytics.html#cb88-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb88-8"><a href="ctlsc0x-supply-chain-analytics.html#cb88-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb88-9"><a href="ctlsc0x-supply-chain-analytics.html#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="ctlsc0x-supply-chain-analytics.html#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Multiply all rows of j column of a[i,j] to c[i], in r for this to happen you have to change the vector to a square matrix</span></span>
<span id="cb88-11"><a href="ctlsc0x-supply-chain-analytics.html#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">diag</span>(c), <span class="at">caption =</span> <span class="st">&quot;As is&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-29">Table 1.10: </span>As is
</caption>
<tbody>
<tr>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.22
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="ctlsc0x-supply-chain-analytics.html#cb89-1" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> a <span class="sc">%*%</span> <span class="fu">diag</span>(c)</span>
<span id="cb89-2"><a href="ctlsc0x-supply-chain-analytics.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co">#It becomes:</span></span>
<span id="cb89-3"><a href="ctlsc0x-supply-chain-analytics.html#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(c,  <span class="at">caption =</span> <span class="st">&quot;It becomes&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-29">Table 1.10: </span>It becomes
</caption>
<tbody>
<tr>
<td style="text-align:right;">
0.946
</td>
<td style="text-align:right;">
1.540
</td>
</tr>
<tr>
<td style="text-align:right;">
0.242
</td>
<td style="text-align:right;">
1.496
</td>
</tr>
<tr>
<td style="text-align:right;">
0.561
</td>
<td style="text-align:right;">
2.156
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="ctlsc0x-supply-chain-analytics.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb90-2"><a href="ctlsc0x-supply-chain-analytics.html#cb90-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="ctlsc0x-supply-chain-analytics.html#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of productW</span></span>
<span id="cb90-4"><a href="ctlsc0x-supply-chain-analytics.html#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-5"><a href="ctlsc0x-supply-chain-analytics.html#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="ctlsc0x-supply-chain-analytics.html#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb90-7"><a href="ctlsc0x-supply-chain-analytics.html#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>(p[i] <span class="sc">-</span> <span class="fu">sum_expr</span>(c[i,j],<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m)), <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-8"><a href="ctlsc0x-supply-chain-analytics.html#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="ctlsc0x-supply-chain-analytics.html#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Dont exceed maximum required</span></span>
<span id="cb90-10"><a href="ctlsc0x-supply-chain-analytics.html#cb90-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> max[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb90-11"><a href="ctlsc0x-supply-chain-analytics.html#cb90-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-12"><a href="ctlsc0x-supply-chain-analytics.html#cb90-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-13"><a href="ctlsc0x-supply-chain-analytics.html#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb90-14"><a href="ctlsc0x-supply-chain-analytics.html#cb90-14" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>, <span class="at">verbose =</span> F))</span>
<span id="cb90-15"><a href="ctlsc0x-supply-chain-analytics.html#cb90-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-16"><a href="ctlsc0x-supply-chain-analytics.html#cb90-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb90-17"><a href="ctlsc0x-supply-chain-analytics.html#cb90-17" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 1238.532</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="ctlsc0x-supply-chain-analytics.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb92-2"><a href="ctlsc0x-supply-chain-analytics.html#cb92-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] x[3] 
##   48   30    0</code></pre>
</div>
</div>
</div>
<div id="week3---ips-milps-network-design" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Week3 - IPs, MILPs &amp; Network Design</h2>
<div id="lesson-1---ips-milps" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Lesson 1 - IPs &amp; MILPs</h3>
<div id="banner-chemicals-ll" class="section level4" number="1.2.1.1">
<h4><span class="header-section-number">1.2.1.1</span> Banner Chemicals ll</h4>
<p>Question <a href="Info:assuming" class="uri">Info:assuming</a> you can only produce in lots of 10 barrels.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="ctlsc0x-supply-chain-analytics.html#cb94-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;high&quot;</span>,<span class="st">&quot;Supreme&quot;</span>,<span class="st">&quot;Max&quot;</span>),</span>
<span id="cb94-2"><a href="ctlsc0x-supply-chain-analytics.html#cb94-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Additive_1  =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">300</span>), <span class="at">Additive_2 =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">280</span>),</span>
<span id="cb94-3"><a href="ctlsc0x-supply-chain-analytics.html#cb94-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Profit =</span> <span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">200</span>,<span class="cn">NA</span>))</span>
<span id="cb94-4"><a href="ctlsc0x-supply-chain-analytics.html#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="ctlsc0x-supply-chain-analytics.html#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Banner Chemicals ll&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-30">Table 1.11: </span>Banner Chemicals ll
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Additive_1
</th>
<th style="text-align:right;">
Additive_2
</th>
<th style="text-align:right;">
Profit
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
80
</td>
</tr>
<tr>
<td style="text-align:left;">
Supreme
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
200
</td>
</tr>
<tr>
<td style="text-align:left;">
Max
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
280
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Maximize} &amp; \ y = \sum_{i=1}^{N} \frac{x_{i} \cdot p_{i}}{Q} \\
\textbf{subject to}\\
    &amp; \sum_{i=1}^{N} x_{i} \le \frac{P_i}{Q} \\
    &amp; \sum_{i=1}^{N} x_{i} \cdot a_{i,j} \le \frac{Max_j}{Q}, \ \ j \in M \\
    &amp; x_{i} \ge 0, \ x \in \mathbb{Z} \\
    
\textbf{Where} \\

&amp; i = \text{Type of product in N} \\
&amp; j = \text{Product component in M} \\
&amp; p_i = \text{Profit for product i} \\
&amp; a_{i,j} = \text{Product requirement for stage j} \\
&amp; P_i = \text{Capacity for Plant} \\
&amp; Max_j = \text{Capacity for components} \\
&amp; Q = \text{Lot} \\
&amp; x_{i} = \text{Quantity of product} \\

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="ctlsc0x-supply-chain-analytics.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span></code></pre></div>
<pre><code>## Warning in rm(x): objeto &#39;x&#39; não encontrado</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="ctlsc0x-supply-chain-analytics.html#cb97-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of products</span></span>
<span id="cb97-2"><a href="ctlsc0x-supply-chain-analytics.html#cb97-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of components</span></span>
<span id="cb97-3"><a href="ctlsc0x-supply-chain-analytics.html#cb97-3" aria-hidden="true" tabindex="-1"></a>P <span class="ot">=</span> <span class="dv">110</span> <span class="co">#Plant Capacity</span></span>
<span id="cb97-4"><a href="ctlsc0x-supply-chain-analytics.html#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="ctlsc0x-supply-chain-analytics.html#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb97-6"><a href="ctlsc0x-supply-chain-analytics.html#cb97-6" aria-hidden="true" tabindex="-1"></a>max <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb97-7"><a href="ctlsc0x-supply-chain-analytics.html#cb97-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb97-8"><a href="ctlsc0x-supply-chain-analytics.html#cb97-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">4</span>])</span>
<span id="cb97-9"><a href="ctlsc0x-supply-chain-analytics.html#cb97-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-10"><a href="ctlsc0x-supply-chain-analytics.html#cb97-10" aria-hidden="true" tabindex="-1"></a>Model <span class="ot">&lt;-</span> <span class="cf">function</span>(Q){</span>
<span id="cb97-11"><a href="ctlsc0x-supply-chain-analytics.html#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="ctlsc0x-supply-chain-analytics.html#cb97-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb97-13"><a href="ctlsc0x-supply-chain-analytics.html#cb97-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of profit</span></span>
<span id="cb97-14"><a href="ctlsc0x-supply-chain-analytics.html#cb97-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-15"><a href="ctlsc0x-supply-chain-analytics.html#cb97-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-16"><a href="ctlsc0x-supply-chain-analytics.html#cb97-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb97-17"><a href="ctlsc0x-supply-chain-analytics.html#cb97-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>((p[i] <span class="sc">*</span> x[i])<span class="sc">/</span>Q, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb97-18"><a href="ctlsc0x-supply-chain-analytics.html#cb97-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-19"><a href="ctlsc0x-supply-chain-analytics.html#cb97-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Don&#39;t produce something you don&#39;t have demand for</span></span>
<span id="cb97-20"><a href="ctlsc0x-supply-chain-analytics.html#cb97-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> P<span class="sc">/</span>Q) <span class="sc">%&gt;%</span></span>
<span id="cb97-21"><a href="ctlsc0x-supply-chain-analytics.html#cb97-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-22"><a href="ctlsc0x-supply-chain-analytics.html#cb97-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Dont exceed maximum required</span></span>
<span id="cb97-23"><a href="ctlsc0x-supply-chain-analytics.html#cb97-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> max[j]<span class="sc">/</span>Q, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb97-24"><a href="ctlsc0x-supply-chain-analytics.html#cb97-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-25"><a href="ctlsc0x-supply-chain-analytics.html#cb97-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb97-26"><a href="ctlsc0x-supply-chain-analytics.html#cb97-26" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>, <span class="at">verbose =</span> F))</span>
<span id="cb97-27"><a href="ctlsc0x-supply-chain-analytics.html#cb97-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-28"><a href="ctlsc0x-supply-chain-analytics.html#cb97-28" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Objective =</span> result<span class="sc">$</span>objective_value<span class="sc">*</span>Q<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb97-29"><a href="ctlsc0x-supply-chain-analytics.html#cb97-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">Variables =</span> result<span class="sc">$</span>solution<span class="sc">*</span>Q))</span>
<span id="cb97-30"><a href="ctlsc0x-supply-chain-analytics.html#cb97-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-31"><a href="ctlsc0x-supply-chain-analytics.html#cb97-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-32"><a href="ctlsc0x-supply-chain-analytics.html#cb97-32" aria-hidden="true" tabindex="-1"></a><span class="co">#Question 1: Result when Lot = 10</span></span>
<span id="cb97-33"><a href="ctlsc0x-supply-chain-analytics.html#cb97-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-34"><a href="ctlsc0x-supply-chain-analytics.html#cb97-34" aria-hidden="true" tabindex="-1"></a><span class="fu">Model</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## $Objective
## [1] 18800
## 
## $Variables
## x[1] x[2] 
##   10   90</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="ctlsc0x-supply-chain-analytics.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Question 2: Result when Lot = 5</span></span>
<span id="cb99-2"><a href="ctlsc0x-supply-chain-analytics.html#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="ctlsc0x-supply-chain-analytics.html#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Model</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## $Objective
## [1] 19000
## 
## $Variables
## x[1] x[2] 
##   25   85</code></pre>
</div>
<div id="gonuts" class="section level4" number="1.2.1.2">
<h4><span class="header-section-number">1.2.1.2</span> GOnuts</h4>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="ctlsc0x-supply-chain-analytics.html#cb101-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;C_Ethiopia&quot;</span>,<span class="st">&quot;C_Tanzania&quot;</span>,<span class="st">&quot;C_Nigeria&quot;</span>,<span class="st">&quot;Demand&quot;</span>),</span>
<span id="cb101-2"><a href="ctlsc0x-supply-chain-analytics.html#cb101-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Ginko  =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="fl">22.5</span>,<span class="dv">23</span>,<span class="dv">550</span>), <span class="at">Kola =</span> <span class="fu">c</span>(<span class="fl">22.5</span>,<span class="fl">24.5</span>,<span class="fl">25.5</span>,<span class="dv">450</span>),</span>
<span id="cb101-3"><a href="ctlsc0x-supply-chain-analytics.html#cb101-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Capacity =</span> <span class="fu">c</span>(<span class="dv">425</span>,<span class="dv">400</span>,<span class="dv">750</span>,<span class="cn">NA</span>))</span>
<span id="cb101-4"><a href="ctlsc0x-supply-chain-analytics.html#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;GOnuts&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-32">Table 1.12: </span>GOnuts
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Ginko
</th>
<th style="text-align:right;">
Kola
</th>
<th style="text-align:right;">
Capacity
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
C_Ethiopia
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
22.5
</td>
<td style="text-align:right;">
425
</td>
</tr>
<tr>
<td style="text-align:left;">
C_Tanzania
</td>
<td style="text-align:right;">
22.5
</td>
<td style="text-align:right;">
24.5
</td>
<td style="text-align:right;">
400
</td>
</tr>
<tr>
<td style="text-align:left;">
C_Nigeria
</td>
<td style="text-align:right;">
23.0
</td>
<td style="text-align:right;">
25.5
</td>
<td style="text-align:right;">
750
</td>
</tr>
<tr>
<td style="text-align:left;">
Demand
</td>
<td style="text-align:right;">
550.0
</td>
<td style="text-align:right;">
450.0
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Minimize} &amp; \ y = \sum_{i=1}^{N} \sum_{j=1}^{M} c_{i,j} \cdot x_{i,j} \\
\textbf{subject to}\\
    &amp; \sum_{i=1}^{N} x_{i} \le C_j, \ \ j \in M \\
    &amp; \sum_{i=1}^{N} x_{i} \cdot a_{i,j} \ge D_i, \ \ j \in M \\
    &amp; x_{i} \ge 0, \ x \in \mathbb{Z} \\
    
\textbf{Where} \\

&amp; i = \text{Type of product in N} \\
&amp; j = \text{Product component in M} \\
&amp; p_i = \text{Profit for product i} \\
&amp; a_{i,j} = \text{Product requirement for stage j} \\
&amp; P_i = \text{Capacity for Plant} \\

&amp; x_{i} = \text{Quantity of product} \\

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="ctlsc0x-supply-chain-analytics.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span></code></pre></div>
<pre><code>## Warning in rm(x): objeto &#39;x&#39; não encontrado</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="ctlsc0x-supply-chain-analytics.html#cb104-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of products</span></span>
<span id="cb104-2"><a href="ctlsc0x-supply-chain-analytics.html#cb104-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of components</span></span>
<span id="cb104-3"><a href="ctlsc0x-supply-chain-analytics.html#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="ctlsc0x-supply-chain-analytics.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb104-5"><a href="ctlsc0x-supply-chain-analytics.html#cb104-5" aria-hidden="true" tabindex="-1"></a>D <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb104-6"><a href="ctlsc0x-supply-chain-analytics.html#cb104-6" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb104-7"><a href="ctlsc0x-supply-chain-analytics.html#cb104-7" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb104-8"><a href="ctlsc0x-supply-chain-analytics.html#cb104-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-9"><a href="ctlsc0x-supply-chain-analytics.html#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Modeling for Lesson and question, z is for the exercise, by changing the capacity of plant&#39;s constraint</span></span>
<span id="cb104-10"><a href="ctlsc0x-supply-chain-analytics.html#cb104-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-11"><a href="ctlsc0x-supply-chain-analytics.html#cb104-11" aria-hidden="true" tabindex="-1"></a>Model <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">z =</span> <span class="cn">NA</span>){</span>
<span id="cb104-12"><a href="ctlsc0x-supply-chain-analytics.html#cb104-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-13"><a href="ctlsc0x-supply-chain-analytics.html#cb104-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(z)) {</span>
<span id="cb104-14"><a href="ctlsc0x-supply-chain-analytics.html#cb104-14" aria-hidden="true" tabindex="-1"></a>   z <span class="ot">=</span> C</span>
<span id="cb104-15"><a href="ctlsc0x-supply-chain-analytics.html#cb104-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb104-16"><a href="ctlsc0x-supply-chain-analytics.html#cb104-16" aria-hidden="true" tabindex="-1"></a>   z <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">replicate</span>(<span class="at">n =</span> n, z))</span>
<span id="cb104-17"><a href="ctlsc0x-supply-chain-analytics.html#cb104-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb104-18"><a href="ctlsc0x-supply-chain-analytics.html#cb104-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-19"><a href="ctlsc0x-supply-chain-analytics.html#cb104-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Get back to model</span></span>
<span id="cb104-20"><a href="ctlsc0x-supply-chain-analytics.html#cb104-20" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb104-21"><a href="ctlsc0x-supply-chain-analytics.html#cb104-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of productW</span></span>
<span id="cb104-22"><a href="ctlsc0x-supply-chain-analytics.html#cb104-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-23"><a href="ctlsc0x-supply-chain-analytics.html#cb104-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-24"><a href="ctlsc0x-supply-chain-analytics.html#cb104-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb104-25"><a href="ctlsc0x-supply-chain-analytics.html#cb104-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i,j]<span class="sc">*</span>a[i,j] ,<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;min&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb104-26"><a href="ctlsc0x-supply-chain-analytics.html#cb104-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-27"><a href="ctlsc0x-supply-chain-analytics.html#cb104-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb104-28"><a href="ctlsc0x-supply-chain-analytics.html#cb104-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> D[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">%&gt;%</span></span>
<span id="cb104-29"><a href="ctlsc0x-supply-chain-analytics.html#cb104-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-30"><a href="ctlsc0x-supply-chain-analytics.html#cb104-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb104-31"><a href="ctlsc0x-supply-chain-analytics.html#cb104-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">&lt;=</span> z[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb104-32"><a href="ctlsc0x-supply-chain-analytics.html#cb104-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-33"><a href="ctlsc0x-supply-chain-analytics.html#cb104-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb104-34"><a href="ctlsc0x-supply-chain-analytics.html#cb104-34" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>))</span>
<span id="cb104-35"><a href="ctlsc0x-supply-chain-analytics.html#cb104-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-36"><a href="ctlsc0x-supply-chain-analytics.html#cb104-36" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Obj_value =</span> result<span class="sc">$</span>objective_value,</span>
<span id="cb104-37"><a href="ctlsc0x-supply-chain-analytics.html#cb104-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">Solution =</span> result<span class="sc">$</span>solution))</span>
<span id="cb104-38"><a href="ctlsc0x-supply-chain-analytics.html#cb104-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-39"><a href="ctlsc0x-supply-chain-analytics.html#cb104-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb104-40"><a href="ctlsc0x-supply-chain-analytics.html#cb104-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-41"><a href="ctlsc0x-supply-chain-analytics.html#cb104-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Question 1: Using the capacity of the lesson</span></span>
<span id="cb104-42"><a href="ctlsc0x-supply-chain-analytics.html#cb104-42" aria-hidden="true" tabindex="-1"></a><span class="fu">Model</span>()</span></code></pre></div>
<pre><code>## $Obj_value
## [1] 22637.5
## 
## $Solution
## x[1,1] x[2,1] x[3,1] x[1,2] x[2,2] x[3,2] 
##      0    375    175    425     25      0</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="ctlsc0x-supply-chain-analytics.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Question 2: All plants capacity are 350</span></span>
<span id="cb106-2"><a href="ctlsc0x-supply-chain-analytics.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Model</span>(<span class="dv">350</span>)</span></code></pre></div>
<pre><code>## $Obj_value
## [1] 22850
## 
## $Solution
## x[1,1] x[2,1] x[3,1] x[1,2] x[2,2] x[3,2] 
##      0    250    300    350    100      0</code></pre>
</div>
<div id="qq4---two-simple-ilps" class="section level4" number="1.2.1.3">
<h4><span class="header-section-number">1.2.1.3</span> QQ4 - Two Simple ILPs</h4>
<div id="part-l" class="section level5" number="1.2.1.3.1">
<h5><span class="header-section-number">1.2.1.3.1</span> Part l</h5>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="ctlsc0x-supply-chain-analytics.html#cb108-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;Maximize&quot;</span>, <span class="st">&quot;C_1&quot;</span>,<span class="st">&quot;C_2&quot;</span>),</span>
<span id="cb108-2"><a href="ctlsc0x-supply-chain-analytics.html#cb108-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Var_1 =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>), <span class="at">Var_2  =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">10</span>), <span class="at">RH =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">8</span>,<span class="dv">63</span>))</span>
<span id="cb108-3"><a href="ctlsc0x-supply-chain-analytics.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Var_1
</th>
<th style="text-align:right;">
Var_2
</th>
<th style="text-align:right;">
RH
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Maximize
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
C_1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-3
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
C_2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
63
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="ctlsc0x-supply-chain-analytics.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span></code></pre></div>
<pre><code>## Warning in rm(x): objeto &#39;x&#39; não encontrado</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="ctlsc0x-supply-chain-analytics.html#cb111-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of Variables &amp; constraints</span></span>
<span id="cb111-2"><a href="ctlsc0x-supply-chain-analytics.html#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="ctlsc0x-supply-chain-analytics.html#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb111-4"><a href="ctlsc0x-supply-chain-analytics.html#cb111-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb111-5"><a href="ctlsc0x-supply-chain-analytics.html#cb111-5" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb111-6"><a href="ctlsc0x-supply-chain-analytics.html#cb111-6" aria-hidden="true" tabindex="-1"></a>RH <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb111-7"><a href="ctlsc0x-supply-chain-analytics.html#cb111-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-8"><a href="ctlsc0x-supply-chain-analytics.html#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb111-9"><a href="ctlsc0x-supply-chain-analytics.html#cb111-9" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb111-10"><a href="ctlsc0x-supply-chain-analytics.html#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb111-11"><a href="ctlsc0x-supply-chain-analytics.html#cb111-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-12"><a href="ctlsc0x-supply-chain-analytics.html#cb111-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-13"><a href="ctlsc0x-supply-chain-analytics.html#cb111-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb111-14"><a href="ctlsc0x-supply-chain-analytics.html#cb111-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-15"><a href="ctlsc0x-supply-chain-analytics.html#cb111-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-16"><a href="ctlsc0x-supply-chain-analytics.html#cb111-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb111-17"><a href="ctlsc0x-supply-chain-analytics.html#cb111-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>c[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> RH[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb111-18"><a href="ctlsc0x-supply-chain-analytics.html#cb111-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-19"><a href="ctlsc0x-supply-chain-analytics.html#cb111-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb111-20"><a href="ctlsc0x-supply-chain-analytics.html#cb111-20" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb111-21"><a href="ctlsc0x-supply-chain-analytics.html#cb111-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-22"><a href="ctlsc0x-supply-chain-analytics.html#cb111-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb111-23"><a href="ctlsc0x-supply-chain-analytics.html#cb111-23" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 28</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="ctlsc0x-supply-chain-analytics.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb113-2"><a href="ctlsc0x-supply-chain-analytics.html#cb113-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] 
##    4    4</code></pre>
</div>
<div id="part-2" class="section level5" number="1.2.1.3.2">
<h5><span class="header-section-number">1.2.1.3.2</span> Part 2</h5>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="ctlsc0x-supply-chain-analytics.html#cb115-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;Maximize&quot;</span>, <span class="st">&quot;C_1&quot;</span>,<span class="st">&quot;C_2&quot;</span>,<span class="st">&quot;C_3&quot;</span>),</span>
<span id="cb115-2"><a href="ctlsc0x-supply-chain-analytics.html#cb115-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Var_1 =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>), <span class="at">Var_2  =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2</span>),</span>
<span id="cb115-3"><a href="ctlsc0x-supply-chain-analytics.html#cb115-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">State =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="st">&quot;&lt;=&quot;</span>,<span class="st">&quot;&lt;=&quot;</span>,<span class="st">&quot;&gt;=&quot;</span>), <span class="at">RH =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb115-4"><a href="ctlsc0x-supply-chain-analytics.html#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Var_1
</th>
<th style="text-align:right;">
Var_2
</th>
<th style="text-align:left;">
State
</th>
<th style="text-align:right;">
RH
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Maximize
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
C_1
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
&lt;=
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
C_2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
&lt;=
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
C_3
</td>
<td style="text-align:right;">
-2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
&gt;=
</td>
<td style="text-align:right;">
-2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="ctlsc0x-supply-chain-analytics.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb116-2"><a href="ctlsc0x-supply-chain-analytics.html#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="ctlsc0x-supply-chain-analytics.html#cb116-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of Variables &amp; constraints</span></span>
<span id="cb116-4"><a href="ctlsc0x-supply-chain-analytics.html#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="ctlsc0x-supply-chain-analytics.html#cb116-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-6"><a href="ctlsc0x-supply-chain-analytics.html#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb116-7"><a href="ctlsc0x-supply-chain-analytics.html#cb116-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb116-8"><a href="ctlsc0x-supply-chain-analytics.html#cb116-8" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb116-9"><a href="ctlsc0x-supply-chain-analytics.html#cb116-9" aria-hidden="true" tabindex="-1"></a>RH <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">5</span>])</span>
<span id="cb116-10"><a href="ctlsc0x-supply-chain-analytics.html#cb116-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-11"><a href="ctlsc0x-supply-chain-analytics.html#cb116-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-12"><a href="ctlsc0x-supply-chain-analytics.html#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb116-13"><a href="ctlsc0x-supply-chain-analytics.html#cb116-13" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-14"><a href="ctlsc0x-supply-chain-analytics.html#cb116-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb116-15"><a href="ctlsc0x-supply-chain-analytics.html#cb116-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-16"><a href="ctlsc0x-supply-chain-analytics.html#cb116-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-17"><a href="ctlsc0x-supply-chain-analytics.html#cb116-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb116-18"><a href="ctlsc0x-supply-chain-analytics.html#cb116-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-19"><a href="ctlsc0x-supply-chain-analytics.html#cb116-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-20"><a href="ctlsc0x-supply-chain-analytics.html#cb116-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb116-21"><a href="ctlsc0x-supply-chain-analytics.html#cb116-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>c[j,i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> RH[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb116-22"><a href="ctlsc0x-supply-chain-analytics.html#cb116-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-23"><a href="ctlsc0x-supply-chain-analytics.html#cb116-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb116-24"><a href="ctlsc0x-supply-chain-analytics.html#cb116-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>c[j,i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> RH[j], <span class="at">j =</span> <span class="dv">3</span>)</span>
<span id="cb116-25"><a href="ctlsc0x-supply-chain-analytics.html#cb116-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-26"><a href="ctlsc0x-supply-chain-analytics.html#cb116-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-27"><a href="ctlsc0x-supply-chain-analytics.html#cb116-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb116-28"><a href="ctlsc0x-supply-chain-analytics.html#cb116-28" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb116-29"><a href="ctlsc0x-supply-chain-analytics.html#cb116-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-30"><a href="ctlsc0x-supply-chain-analytics.html#cb116-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb116-31"><a href="ctlsc0x-supply-chain-analytics.html#cb116-31" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 28</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="ctlsc0x-supply-chain-analytics.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb118-2"><a href="ctlsc0x-supply-chain-analytics.html#cb118-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] 
##    2    8</code></pre>
</div>
</div>
<div id="gonuts-ll" class="section level4" number="1.2.1.4">
<h4><span class="header-section-number">1.2.1.4</span> GOnuts ll</h4>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="ctlsc0x-supply-chain-analytics.html#cb120-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;C_Ethiopia&quot;</span>,<span class="st">&quot;C_Tanzania&quot;</span>,<span class="st">&quot;C_Nigeria&quot;</span>,<span class="st">&quot;Demand&quot;</span>),</span>
<span id="cb120-2"><a href="ctlsc0x-supply-chain-analytics.html#cb120-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Ginko  =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="fl">22.5</span>,<span class="dv">23</span>,<span class="dv">550</span>), <span class="at">Kola =</span> <span class="fu">c</span>(<span class="fl">22.5</span>,<span class="fl">24.5</span>,<span class="fl">25.5</span>,<span class="dv">450</span>),</span>
<span id="cb120-3"><a href="ctlsc0x-supply-chain-analytics.html#cb120-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Capacity =</span> <span class="fu">c</span>(<span class="dv">425</span>,<span class="dv">400</span>,<span class="dv">750</span>,<span class="cn">NA</span>), <span class="at">Plant_Cost =</span> <span class="fu">c</span>(<span class="dv">1500</span>,<span class="dv">2000</span>,<span class="dv">3000</span>,<span class="cn">NA</span>))</span>
<span id="cb120-4"><a href="ctlsc0x-supply-chain-analytics.html#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="ctlsc0x-supply-chain-analytics.html#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;GOnuts ll&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-38">Table 1.13: </span>GOnuts ll
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Ginko
</th>
<th style="text-align:right;">
Kola
</th>
<th style="text-align:right;">
Capacity
</th>
<th style="text-align:right;">
Plant_Cost
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
C_Ethiopia
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
22.5
</td>
<td style="text-align:right;">
425
</td>
<td style="text-align:right;">
1500
</td>
</tr>
<tr>
<td style="text-align:left;">
C_Tanzania
</td>
<td style="text-align:right;">
22.5
</td>
<td style="text-align:right;">
24.5
</td>
<td style="text-align:right;">
400
</td>
<td style="text-align:right;">
2000
</td>
</tr>
<tr>
<td style="text-align:left;">
C_Nigeria
</td>
<td style="text-align:right;">
23.0
</td>
<td style="text-align:right;">
25.5
</td>
<td style="text-align:right;">
750
</td>
<td style="text-align:right;">
3000
</td>
</tr>
<tr>
<td style="text-align:left;">
Demand
</td>
<td style="text-align:right;">
550.0
</td>
<td style="text-align:right;">
450.0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Minimize} &amp; \ z = \sum_{i=1}^{N} \sum_{j=1}^{M} c_{i,j} \cdot x_{i,j} +
                          \sum_{j=1}^{M} f_j \cdot y_j \\
                          
\textbf{subject to} \\
    &amp; \sum_{i=1}^{N} x_{i} \le C_j, \ \ j \in M \\
    &amp; \sum_{i=1}^{N} x_{i} \cdot a_{i,j} \ge D_i, \ \ j \in M \\
    &amp; \sum_{i=1}^{N} x_{i,j} -  f_j \cdot B_M \le 0\\
    &amp; x_{i} \ge 0, \ x \in \mathbb{Z} \\
    
\textbf{Where} \\

&amp; i = \text{Type of Plant in N} \\
&amp; j = \text{Demand in M} \\
&amp; p_i = \text{Profit for product i} \\
&amp; a_{i,j} = \text{Product requirement for stage j} \\
&amp; P_j = \text{Capacity for Plant} \\
&amp; B_M = \text{Big number}\\
&amp; Max_j = \text{Capacity for components} \\
&amp; x_{i} = \text{Quantity of product} \\

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="ctlsc0x-supply-chain-analytics.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span></code></pre></div>
<pre><code>## Warning in rm(x): objeto &#39;x&#39; não encontrado</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="ctlsc0x-supply-chain-analytics.html#cb123-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of products</span></span>
<span id="cb123-2"><a href="ctlsc0x-supply-chain-analytics.html#cb123-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of components</span></span>
<span id="cb123-3"><a href="ctlsc0x-supply-chain-analytics.html#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="ctlsc0x-supply-chain-analytics.html#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb123-5"><a href="ctlsc0x-supply-chain-analytics.html#cb123-5" aria-hidden="true" tabindex="-1"></a>D <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb123-6"><a href="ctlsc0x-supply-chain-analytics.html#cb123-6" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb123-7"><a href="ctlsc0x-supply-chain-analytics.html#cb123-7" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb123-8"><a href="ctlsc0x-supply-chain-analytics.html#cb123-8" aria-hidden="true" tabindex="-1"></a>Pc <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span>])</span>
<span id="cb123-9"><a href="ctlsc0x-supply-chain-analytics.html#cb123-9" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">sum</span>(D) </span>
<span id="cb123-10"><a href="ctlsc0x-supply-chain-analytics.html#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="ctlsc0x-supply-chain-analytics.html#cb123-11" aria-hidden="true" tabindex="-1"></a>Model <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">z =</span> <span class="cn">NA</span>){</span>
<span id="cb123-12"><a href="ctlsc0x-supply-chain-analytics.html#cb123-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-13"><a href="ctlsc0x-supply-chain-analytics.html#cb123-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(z)) {</span>
<span id="cb123-14"><a href="ctlsc0x-supply-chain-analytics.html#cb123-14" aria-hidden="true" tabindex="-1"></a>   z <span class="ot">=</span> C</span>
<span id="cb123-15"><a href="ctlsc0x-supply-chain-analytics.html#cb123-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb123-16"><a href="ctlsc0x-supply-chain-analytics.html#cb123-16" aria-hidden="true" tabindex="-1"></a>   z <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">replicate</span>(<span class="at">n =</span> n, z))</span>
<span id="cb123-17"><a href="ctlsc0x-supply-chain-analytics.html#cb123-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb123-18"><a href="ctlsc0x-supply-chain-analytics.html#cb123-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-19"><a href="ctlsc0x-supply-chain-analytics.html#cb123-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb123-20"><a href="ctlsc0x-supply-chain-analytics.html#cb123-20" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb123-21"><a href="ctlsc0x-supply-chain-analytics.html#cb123-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb123-22"><a href="ctlsc0x-supply-chain-analytics.html#cb123-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb123-23"><a href="ctlsc0x-supply-chain-analytics.html#cb123-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-24"><a href="ctlsc0x-supply-chain-analytics.html#cb123-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Binary Variable</span></span>
<span id="cb123-25"><a href="ctlsc0x-supply-chain-analytics.html#cb123-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(f[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;binary&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb123-26"><a href="ctlsc0x-supply-chain-analytics.html#cb123-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-27"><a href="ctlsc0x-supply-chain-analytics.html#cb123-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb123-28"><a href="ctlsc0x-supply-chain-analytics.html#cb123-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i,j]<span class="sc">*</span>a[i,j] ,<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">+</span></span>
<span id="cb123-29"><a href="ctlsc0x-supply-chain-analytics.html#cb123-29" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sum_expr</span>(f[i]<span class="sc">*</span>Pc[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;min&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb123-30"><a href="ctlsc0x-supply-chain-analytics.html#cb123-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-31"><a href="ctlsc0x-supply-chain-analytics.html#cb123-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb123-32"><a href="ctlsc0x-supply-chain-analytics.html#cb123-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> D[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">%&gt;%</span></span>
<span id="cb123-33"><a href="ctlsc0x-supply-chain-analytics.html#cb123-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-34"><a href="ctlsc0x-supply-chain-analytics.html#cb123-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb123-35"><a href="ctlsc0x-supply-chain-analytics.html#cb123-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">&lt;=</span> z[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb123-36"><a href="ctlsc0x-supply-chain-analytics.html#cb123-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-37"><a href="ctlsc0x-supply-chain-analytics.html#cb123-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb123-38"><a href="ctlsc0x-supply-chain-analytics.html#cb123-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">-</span> f[i]<span class="sc">*</span> B <span class="sc">&lt;=</span> <span class="dv">0</span>, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb123-39"><a href="ctlsc0x-supply-chain-analytics.html#cb123-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-40"><a href="ctlsc0x-supply-chain-analytics.html#cb123-40" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb123-41"><a href="ctlsc0x-supply-chain-analytics.html#cb123-41" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>))</span>
<span id="cb123-42"><a href="ctlsc0x-supply-chain-analytics.html#cb123-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-43"><a href="ctlsc0x-supply-chain-analytics.html#cb123-43" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Obj_value =</span> result<span class="sc">$</span>objective_value,</span>
<span id="cb123-44"><a href="ctlsc0x-supply-chain-analytics.html#cb123-44" aria-hidden="true" tabindex="-1"></a>            <span class="at">Solution =</span> result<span class="sc">$</span>solution))</span>
<span id="cb123-45"><a href="ctlsc0x-supply-chain-analytics.html#cb123-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-46"><a href="ctlsc0x-supply-chain-analytics.html#cb123-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb123-47"><a href="ctlsc0x-supply-chain-analytics.html#cb123-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-48"><a href="ctlsc0x-supply-chain-analytics.html#cb123-48" aria-hidden="true" tabindex="-1"></a><span class="co">#Question 1: Using the capacity of the lesson</span></span>
<span id="cb123-49"><a href="ctlsc0x-supply-chain-analytics.html#cb123-49" aria-hidden="true" tabindex="-1"></a><span class="fu">Model</span>()</span></code></pre></div>
<pre><code>## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.</code></pre>
<pre><code>## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.</code></pre>
<pre><code>## $Obj_value
## [1] 27350
## 
## $Solution
##   f[1]   f[2]   f[3] x[1,1] x[2,1] x[3,1] x[1,2] x[2,2] x[3,2] 
##      1      0      1      0      0    550    425      0     25</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="ctlsc0x-supply-chain-analytics.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Question 2: All plants capacity are 450</span></span>
<span id="cb127-2"><a href="ctlsc0x-supply-chain-analytics.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Model</span>(<span class="dv">450</span>)</span></code></pre></div>
<pre><code>## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.</code></pre>
<pre><code>## $Obj_value
## [1] 29050
## 
## $Solution
##   f[1]   f[2]   f[3] x[1,1] x[2,1] x[3,1] x[1,2] x[2,2] x[3,2] 
##      1      1      1      0    450    100    450      0      0</code></pre>
</div>
<div id="gonuts-lll" class="section level4" number="1.2.1.5">
<h4><span class="header-section-number">1.2.1.5</span> GOnuts lll</h4>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="ctlsc0x-supply-chain-analytics.html#cb130-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;C_Ethiopia&quot;</span>,<span class="st">&quot;C_Tanzania&quot;</span>,<span class="st">&quot;C_Nigeria&quot;</span>,<span class="st">&quot;Demand&quot;</span>),</span>
<span id="cb130-2"><a href="ctlsc0x-supply-chain-analytics.html#cb130-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Plant_Cost =</span> <span class="fu">c</span>(<span class="dv">1500</span>,<span class="dv">2000</span>,<span class="dv">3000</span>,<span class="cn">NA</span>),</span>
<span id="cb130-3"><a href="ctlsc0x-supply-chain-analytics.html#cb130-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Ginko  =</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="fl">22.5</span>,<span class="dv">23</span>,<span class="dv">550</span>), <span class="at">Kola =</span> <span class="fu">c</span>(<span class="fl">22.5</span>,<span class="fl">24.5</span>,<span class="fl">25.5</span>,<span class="dv">450</span>),</span>
<span id="cb130-4"><a href="ctlsc0x-supply-chain-analytics.html#cb130-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">Min_Cap =</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">250</span>,<span class="dv">600</span>,<span class="cn">NA</span>), <span class="at">Max_Cap =</span> <span class="fu">c</span>(<span class="dv">425</span>,<span class="dv">400</span>,<span class="dv">750</span>,<span class="cn">NA</span>))</span>
<span id="cb130-5"><a href="ctlsc0x-supply-chain-analytics.html#cb130-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-6"><a href="ctlsc0x-supply-chain-analytics.html#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;GOnuts lll&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-40">Table 1.14: </span>GOnuts lll
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Plant_Cost
</th>
<th style="text-align:right;">
Ginko
</th>
<th style="text-align:right;">
Kola
</th>
<th style="text-align:right;">
Min_Cap
</th>
<th style="text-align:right;">
Max_Cap
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
C_Ethiopia
</td>
<td style="text-align:right;">
1500
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
22.5
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
425
</td>
</tr>
<tr>
<td style="text-align:left;">
C_Tanzania
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
22.5
</td>
<td style="text-align:right;">
24.5
</td>
<td style="text-align:right;">
250
</td>
<td style="text-align:right;">
400
</td>
</tr>
<tr>
<td style="text-align:left;">
C_Nigeria
</td>
<td style="text-align:right;">
3000
</td>
<td style="text-align:right;">
23.0
</td>
<td style="text-align:right;">
25.5
</td>
<td style="text-align:right;">
600
</td>
<td style="text-align:right;">
750
</td>
</tr>
<tr>
<td style="text-align:left;">
Demand
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
550.0
</td>
<td style="text-align:right;">
450.0
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Minimize} &amp; \ z = \sum_{i=1}^{N} \sum_{j=1}^{M} c_{i,j} \cdot x_{i,j} +
                          \sum_{j=1}^{M} f_j \cdot y_j \\
                          
\textbf{subject to} \\
    &amp; \sum_{i=1}^{N} x_{i,j} \le C_j, \ \ j \in M \\
    &amp; \sum_{i=1}^{N} x_{i,j} \ge L_j, \ \ j \in M \\
    &amp; \sum_{i=1}^{N} x_{i,j} \cdot a_{i,j} \ge D_i, \ \ j \in M \\
    &amp; \sum_{i=1}^{N} x_{i,j} -  f_j \cdot B_M \le 0\\
    &amp; x_{i} \ge 0, \ x \in \mathbb{Z} \\
    
\textbf{Where} \\

&amp; i = \text{Type of Plant in N} \\
&amp; j = \text{Demand in M} \\
&amp; p_i = \text{Profit for product i} \\
&amp; a_{i,j} = \text{Product requirement for stage j} \\
&amp; P_j = \text{Capacity for Plant} \\
&amp; B_M = \text{Big number}\\
&amp; Max_j = \text{Capacity for components} \\
&amp; x_{i} = \text{Quantity of product} \\

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="ctlsc0x-supply-chain-analytics.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb131-2"><a href="ctlsc0x-supply-chain-analytics.html#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="ctlsc0x-supply-chain-analytics.html#cb131-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of products</span></span>
<span id="cb131-4"><a href="ctlsc0x-supply-chain-analytics.html#cb131-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of components</span></span>
<span id="cb131-5"><a href="ctlsc0x-supply-chain-analytics.html#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="ctlsc0x-supply-chain-analytics.html#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb131-7"><a href="ctlsc0x-supply-chain-analytics.html#cb131-7" aria-hidden="true" tabindex="-1"></a>D <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">4</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb131-8"><a href="ctlsc0x-supply-chain-analytics.html#cb131-8" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb131-9"><a href="ctlsc0x-supply-chain-analytics.html#cb131-9" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span>])</span>
<span id="cb131-10"><a href="ctlsc0x-supply-chain-analytics.html#cb131-10" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">6</span>])</span>
<span id="cb131-11"><a href="ctlsc0x-supply-chain-analytics.html#cb131-11" aria-hidden="true" tabindex="-1"></a>Pc <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span>])</span>
<span id="cb131-12"><a href="ctlsc0x-supply-chain-analytics.html#cb131-12" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">sum</span>(D)</span>
<span id="cb131-13"><a href="ctlsc0x-supply-chain-analytics.html#cb131-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-14"><a href="ctlsc0x-supply-chain-analytics.html#cb131-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb131-15"><a href="ctlsc0x-supply-chain-analytics.html#cb131-15" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb131-16"><a href="ctlsc0x-supply-chain-analytics.html#cb131-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb131-17"><a href="ctlsc0x-supply-chain-analytics.html#cb131-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-18"><a href="ctlsc0x-supply-chain-analytics.html#cb131-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-19"><a href="ctlsc0x-supply-chain-analytics.html#cb131-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Binary Variable</span></span>
<span id="cb131-20"><a href="ctlsc0x-supply-chain-analytics.html#cb131-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(f[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;binary&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-21"><a href="ctlsc0x-supply-chain-analytics.html#cb131-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-22"><a href="ctlsc0x-supply-chain-analytics.html#cb131-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb131-23"><a href="ctlsc0x-supply-chain-analytics.html#cb131-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i,j]<span class="sc">*</span>a[i,j] ,<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">+</span></span>
<span id="cb131-24"><a href="ctlsc0x-supply-chain-analytics.html#cb131-24" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sum_expr</span>(f[i]<span class="sc">*</span>Pc[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;min&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-25"><a href="ctlsc0x-supply-chain-analytics.html#cb131-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-26"><a href="ctlsc0x-supply-chain-analytics.html#cb131-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb131-27"><a href="ctlsc0x-supply-chain-analytics.html#cb131-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> D[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">%&gt;%</span></span>
<span id="cb131-28"><a href="ctlsc0x-supply-chain-analytics.html#cb131-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-29"><a href="ctlsc0x-supply-chain-analytics.html#cb131-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb131-30"><a href="ctlsc0x-supply-chain-analytics.html#cb131-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">&lt;=</span> C[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb131-31"><a href="ctlsc0x-supply-chain-analytics.html#cb131-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-32"><a href="ctlsc0x-supply-chain-analytics.html#cb131-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb131-33"><a href="ctlsc0x-supply-chain-analytics.html#cb131-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">&gt;=</span> L[i]<span class="sc">*</span>f[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb131-34"><a href="ctlsc0x-supply-chain-analytics.html#cb131-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-35"><a href="ctlsc0x-supply-chain-analytics.html#cb131-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb131-36"><a href="ctlsc0x-supply-chain-analytics.html#cb131-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">-</span> f[i]<span class="sc">*</span> B <span class="sc">&lt;=</span> <span class="dv">0</span>, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb131-37"><a href="ctlsc0x-supply-chain-analytics.html#cb131-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-38"><a href="ctlsc0x-supply-chain-analytics.html#cb131-38" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb131-39"><a href="ctlsc0x-supply-chain-analytics.html#cb131-39" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb131-40"><a href="ctlsc0x-supply-chain-analytics.html#cb131-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-41"><a href="ctlsc0x-supply-chain-analytics.html#cb131-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb131-42"><a href="ctlsc0x-supply-chain-analytics.html#cb131-42" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 27425</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="ctlsc0x-supply-chain-analytics.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb133-2"><a href="ctlsc0x-supply-chain-analytics.html#cb133-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>##   f[1]   f[2]   f[3] x[1,1] x[2,1] x[3,1] x[1,2] x[2,2] x[3,2] 
##      1      0      1      0      0    550    400      0     50</code></pre>
</div>
<div id="gonuts-lv" class="section level4" number="1.2.1.6">
<h4><span class="header-section-number">1.2.1.6</span> GOnuts lV</h4>
<p>Operate with 2 Plants at maximum constraint.</p>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Minimize} &amp; \ z = \sum_{i=1}^{N} \sum_{j=1}^{M} c_{i,j} \cdot x_{i,j} +
                          \sum_{j=1}^{M} f_j \cdot y_j \\
                          
\textbf{subject to} \\
    &amp; \sum_{i=1}^{N} x_{i,j} \le C_j, \ \ j \in M \\
    &amp; \sum_{i=1}^{N} x_{i,j} \ge L_j, \ \ j \in M \\
    &amp; \sum_{i=1}^{N} x_{i,j} \cdot a_{i,j} \ge D_i, \ \ j \in M \\
    &amp; \sum_{i=1}^{N} x_{i,j} -  f_j \cdot B_M \le 0\\
    &amp; \sum_{j=1}^{M} f_j \le K \\
    &amp; x_{i} \ge 0, \ x \in \mathbb{Z} \\
    
\textbf{Where} \\

&amp; i = \text{Type of Plant in N} \\
&amp; j = \text{Demand in M} \\
&amp; p_i = \text{Profit for product i} \\
&amp; a_{i,j} = \text{Product requirement for stage j} \\
&amp; P_j = \text{Capacity for Plant} \\
&amp; B_M = \text{Big number}\\
&amp; Max_j = \text{Capacity for components} \\
&amp; x_{i} = \text{Quantity of product} \\
&amp; K = \text{Maximum of Plants to be open} \\

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="ctlsc0x-supply-chain-analytics.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span></code></pre></div>
<pre><code>## Warning in rm(x): objeto &#39;x&#39; não encontrado</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="ctlsc0x-supply-chain-analytics.html#cb137-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of products</span></span>
<span id="cb137-2"><a href="ctlsc0x-supply-chain-analytics.html#cb137-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of components</span></span>
<span id="cb137-3"><a href="ctlsc0x-supply-chain-analytics.html#cb137-3" aria-hidden="true" tabindex="-1"></a>K <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb137-4"><a href="ctlsc0x-supply-chain-analytics.html#cb137-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-5"><a href="ctlsc0x-supply-chain-analytics.html#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb137-6"><a href="ctlsc0x-supply-chain-analytics.html#cb137-6" aria-hidden="true" tabindex="-1"></a>D <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">4</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb137-7"><a href="ctlsc0x-supply-chain-analytics.html#cb137-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb137-8"><a href="ctlsc0x-supply-chain-analytics.html#cb137-8" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span>])</span>
<span id="cb137-9"><a href="ctlsc0x-supply-chain-analytics.html#cb137-9" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">6</span>])</span>
<span id="cb137-10"><a href="ctlsc0x-supply-chain-analytics.html#cb137-10" aria-hidden="true" tabindex="-1"></a>Pc <span class="ot">=</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span>])</span>
<span id="cb137-11"><a href="ctlsc0x-supply-chain-analytics.html#cb137-11" aria-hidden="true" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">sum</span>(D)</span>
<span id="cb137-12"><a href="ctlsc0x-supply-chain-analytics.html#cb137-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-13"><a href="ctlsc0x-supply-chain-analytics.html#cb137-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb137-14"><a href="ctlsc0x-supply-chain-analytics.html#cb137-14" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb137-15"><a href="ctlsc0x-supply-chain-analytics.html#cb137-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb137-16"><a href="ctlsc0x-supply-chain-analytics.html#cb137-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb137-17"><a href="ctlsc0x-supply-chain-analytics.html#cb137-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb137-18"><a href="ctlsc0x-supply-chain-analytics.html#cb137-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Binary Variable</span></span>
<span id="cb137-19"><a href="ctlsc0x-supply-chain-analytics.html#cb137-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(f[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;binary&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb137-20"><a href="ctlsc0x-supply-chain-analytics.html#cb137-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-21"><a href="ctlsc0x-supply-chain-analytics.html#cb137-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb137-22"><a href="ctlsc0x-supply-chain-analytics.html#cb137-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i,j]<span class="sc">*</span>a[i,j] ,<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">+</span></span>
<span id="cb137-23"><a href="ctlsc0x-supply-chain-analytics.html#cb137-23" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sum_expr</span>(f[i]<span class="sc">*</span>Pc[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;min&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb137-24"><a href="ctlsc0x-supply-chain-analytics.html#cb137-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-25"><a href="ctlsc0x-supply-chain-analytics.html#cb137-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb137-26"><a href="ctlsc0x-supply-chain-analytics.html#cb137-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> D[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">%&gt;%</span></span>
<span id="cb137-27"><a href="ctlsc0x-supply-chain-analytics.html#cb137-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb137-28"><a href="ctlsc0x-supply-chain-analytics.html#cb137-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb137-29"><a href="ctlsc0x-supply-chain-analytics.html#cb137-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">&lt;=</span> C[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb137-30"><a href="ctlsc0x-supply-chain-analytics.html#cb137-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb137-31"><a href="ctlsc0x-supply-chain-analytics.html#cb137-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#TODO</span></span>
<span id="cb137-32"><a href="ctlsc0x-supply-chain-analytics.html#cb137-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(f[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">&lt;=</span> K) <span class="sc">%&gt;%</span></span>
<span id="cb137-33"><a href="ctlsc0x-supply-chain-analytics.html#cb137-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb137-34"><a href="ctlsc0x-supply-chain-analytics.html#cb137-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#TODO</span></span>
<span id="cb137-35"><a href="ctlsc0x-supply-chain-analytics.html#cb137-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">&gt;=</span> L[i]<span class="sc">*</span>f[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb137-36"><a href="ctlsc0x-supply-chain-analytics.html#cb137-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb137-37"><a href="ctlsc0x-supply-chain-analytics.html#cb137-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#TODO</span></span>
<span id="cb137-38"><a href="ctlsc0x-supply-chain-analytics.html#cb137-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">-</span> f[i]<span class="sc">*</span> B <span class="sc">&lt;=</span> <span class="dv">0</span>, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)</span></code></pre></div>
<pre><code>## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.</code></pre>
<pre><code>## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.

## Warning: There are variables in your environment that interfere with your
## defined model variables: f. This can lead to unexpected behaviour.</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="ctlsc0x-supply-chain-analytics.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb140-2"><a href="ctlsc0x-supply-chain-analytics.html#cb140-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb140-3"><a href="ctlsc0x-supply-chain-analytics.html#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="ctlsc0x-supply-chain-analytics.html#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb140-5"><a href="ctlsc0x-supply-chain-analytics.html#cb140-5" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 27425</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="ctlsc0x-supply-chain-analytics.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb142-2"><a href="ctlsc0x-supply-chain-analytics.html#cb142-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>##   f[1]   f[2]   f[3] x[1,1] x[2,1] x[3,1] x[1,2] x[2,2] x[3,2] 
##      1      0      1      0      0    550    400      0     50</code></pre>
</div>
</div>
<div id="recitations" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Recitations</h3>
<div id="integer-linear-programming" class="section level4" number="1.2.2.1">
<h4><span class="header-section-number">1.2.2.1</span> Integer Linear Programming</h4>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="ctlsc0x-supply-chain-analytics.html#cb144-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;Maximize&quot;</span>, <span class="st">&quot;C_1&quot;</span>,<span class="st">&quot;C_2&quot;</span>,<span class="st">&quot;C_3&quot;</span>),</span>
<span id="cb144-2"><a href="ctlsc0x-supply-chain-analytics.html#cb144-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Var_1 =</span> <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">Var_2  =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">RH =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">11</span>,<span class="dv">30</span>,<span class="dv">28</span>))</span>
<span id="cb144-3"><a href="ctlsc0x-supply-chain-analytics.html#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="ctlsc0x-supply-chain-analytics.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Var_1
</th>
<th style="text-align:right;">
Var_2
</th>
<th style="text-align:right;">
RH
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Maximize
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
C_1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
C_2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:left;">
C_3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
28
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="ctlsc0x-supply-chain-analytics.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb145-2"><a href="ctlsc0x-supply-chain-analytics.html#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="ctlsc0x-supply-chain-analytics.html#cb145-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of Variables</span></span>
<span id="cb145-4"><a href="ctlsc0x-supply-chain-analytics.html#cb145-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of constraints</span></span>
<span id="cb145-5"><a href="ctlsc0x-supply-chain-analytics.html#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="ctlsc0x-supply-chain-analytics.html#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb145-7"><a href="ctlsc0x-supply-chain-analytics.html#cb145-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb145-8"><a href="ctlsc0x-supply-chain-analytics.html#cb145-8" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb145-9"><a href="ctlsc0x-supply-chain-analytics.html#cb145-9" aria-hidden="true" tabindex="-1"></a>RH <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">4</span>])</span>
<span id="cb145-10"><a href="ctlsc0x-supply-chain-analytics.html#cb145-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-11"><a href="ctlsc0x-supply-chain-analytics.html#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb145-12"><a href="ctlsc0x-supply-chain-analytics.html#cb145-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb145-13"><a href="ctlsc0x-supply-chain-analytics.html#cb145-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb145-14"><a href="ctlsc0x-supply-chain-analytics.html#cb145-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb145-15"><a href="ctlsc0x-supply-chain-analytics.html#cb145-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-16"><a href="ctlsc0x-supply-chain-analytics.html#cb145-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb145-17"><a href="ctlsc0x-supply-chain-analytics.html#cb145-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb145-18"><a href="ctlsc0x-supply-chain-analytics.html#cb145-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-19"><a href="ctlsc0x-supply-chain-analytics.html#cb145-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb145-20"><a href="ctlsc0x-supply-chain-analytics.html#cb145-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>c[j,i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> RH[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb145-21"><a href="ctlsc0x-supply-chain-analytics.html#cb145-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-22"><a href="ctlsc0x-supply-chain-analytics.html#cb145-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb145-23"><a href="ctlsc0x-supply-chain-analytics.html#cb145-23" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb145-24"><a href="ctlsc0x-supply-chain-analytics.html#cb145-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-25"><a href="ctlsc0x-supply-chain-analytics.html#cb145-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb145-26"><a href="ctlsc0x-supply-chain-analytics.html#cb145-26" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 188</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="ctlsc0x-supply-chain-analytics.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb147-2"><a href="ctlsc0x-supply-chain-analytics.html#cb147-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] 
##    1    9</code></pre>
</div>
<div id="capital-budgeting-problem" class="section level4" number="1.2.2.2">
<h4><span class="header-section-number">1.2.2.2</span> Capital Budgeting Problem</h4>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="ctlsc0x-supply-chain-analytics.html#cb149-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Project =</span> <span class="fu">c</span>(<span class="st">&quot;P1&quot;</span>,<span class="st">&quot;P2&quot;</span>,<span class="st">&quot;P3&quot;</span>,<span class="st">&quot;P4&quot;</span>,<span class="st">&quot;P5&quot;</span>,<span class="st">&quot;Funds&quot;</span>),</span>
<span id="cb149-2"><a href="ctlsc0x-supply-chain-analytics.html#cb149-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Exp_1 =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">25</span>), <span class="at">Exp_2 =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">25</span>),</span>
<span id="cb149-3"><a href="ctlsc0x-supply-chain-analytics.html#cb149-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Exp_3 =</span> <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">25</span>), <span class="at">Returns =</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">40</span>,<span class="dv">20</span>,<span class="dv">15</span>,<span class="dv">30</span>,<span class="cn">NA</span>))</span>
<span id="cb149-4"><a href="ctlsc0x-supply-chain-analytics.html#cb149-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-5"><a href="ctlsc0x-supply-chain-analytics.html#cb149-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-6"><a href="ctlsc0x-supply-chain-analytics.html#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Capital Budgeting Problem&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-45">Table 1.15: </span>Capital Budgeting Problem
</caption>
<thead>
<tr>
<th style="text-align:left;">
Project
</th>
<th style="text-align:right;">
Exp_1
</th>
<th style="text-align:right;">
Exp_2
</th>
<th style="text-align:right;">
Exp_3
</th>
<th style="text-align:right;">
Returns
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
</tr>
<tr>
<td style="text-align:left;">
P2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
40
</td>
</tr>
<tr>
<td style="text-align:left;">
P3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
20
</td>
</tr>
<tr>
<td style="text-align:left;">
P4
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:left;">
P5
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:left;">
Funds
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="ctlsc0x-supply-chain-analytics.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb150-2"><a href="ctlsc0x-supply-chain-analytics.html#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="ctlsc0x-supply-chain-analytics.html#cb150-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">5</span> <span class="co">#Number of Projects</span></span>
<span id="cb150-4"><a href="ctlsc0x-supply-chain-analytics.html#cb150-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of Years</span></span>
<span id="cb150-5"><a href="ctlsc0x-supply-chain-analytics.html#cb150-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-6"><a href="ctlsc0x-supply-chain-analytics.html#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb150-7"><a href="ctlsc0x-supply-chain-analytics.html#cb150-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">5</span>])</span>
<span id="cb150-8"><a href="ctlsc0x-supply-chain-analytics.html#cb150-8" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb150-9"><a href="ctlsc0x-supply-chain-analytics.html#cb150-9" aria-hidden="true" tabindex="-1"></a>RH <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">6</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb150-10"><a href="ctlsc0x-supply-chain-analytics.html#cb150-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-11"><a href="ctlsc0x-supply-chain-analytics.html#cb150-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb150-12"><a href="ctlsc0x-supply-chain-analytics.html#cb150-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb150-13"><a href="ctlsc0x-supply-chain-analytics.html#cb150-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb150-14"><a href="ctlsc0x-supply-chain-analytics.html#cb150-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-15"><a href="ctlsc0x-supply-chain-analytics.html#cb150-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-16"><a href="ctlsc0x-supply-chain-analytics.html#cb150-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb150-17"><a href="ctlsc0x-supply-chain-analytics.html#cb150-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-18"><a href="ctlsc0x-supply-chain-analytics.html#cb150-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-19"><a href="ctlsc0x-supply-chain-analytics.html#cb150-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb150-20"><a href="ctlsc0x-supply-chain-analytics.html#cb150-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>c[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> RH[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb150-21"><a href="ctlsc0x-supply-chain-analytics.html#cb150-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-22"><a href="ctlsc0x-supply-chain-analytics.html#cb150-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb150-23"><a href="ctlsc0x-supply-chain-analytics.html#cb150-23" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb150-24"><a href="ctlsc0x-supply-chain-analytics.html#cb150-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-25"><a href="ctlsc0x-supply-chain-analytics.html#cb150-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb150-26"><a href="ctlsc0x-supply-chain-analytics.html#cb150-26" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 95</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="ctlsc0x-supply-chain-analytics.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb152-2"><a href="ctlsc0x-supply-chain-analytics.html#cb152-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] x[3] x[4] x[5] 
##    1    1    1    1    0</code></pre>
</div>
<div id="fixed-charge-problem" class="section level4" number="1.2.2.3">
<h4><span class="header-section-number">1.2.2.3</span> Fixed Charge Problem</h4>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="ctlsc0x-supply-chain-analytics.html#cb154-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;Shirts&quot;</span>,<span class="st">&quot;Short&quot;</span>,<span class="st">&quot;Pants&quot;</span>,<span class="st">&quot;RH&quot;</span>),</span>
<span id="cb154-2"><a href="ctlsc0x-supply-chain-analytics.html#cb154-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Labor =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">150</span>), <span class="at">Cloth =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">160</span>),</span>
<span id="cb154-3"><a href="ctlsc0x-supply-chain-analytics.html#cb154-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Sales =</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">8</span>,<span class="dv">15</span>,<span class="cn">NA</span>), <span class="at">Fix_Cost =</span> <span class="fu">c</span>(<span class="dv">200</span>,<span class="dv">150</span>,<span class="dv">100</span>,<span class="cn">NA</span>),</span>
<span id="cb154-4"><a href="ctlsc0x-supply-chain-analytics.html#cb154-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">Var_Cost =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="cn">NA</span>))</span>
<span id="cb154-5"><a href="ctlsc0x-supply-chain-analytics.html#cb154-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-6"><a href="ctlsc0x-supply-chain-analytics.html#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Fixed Charge Problem&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-47">Table 1.16: </span>Fixed Charge Problem
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Labor
</th>
<th style="text-align:right;">
Cloth
</th>
<th style="text-align:right;">
Sales
</th>
<th style="text-align:right;">
Fix_Cost
</th>
<th style="text-align:right;">
Var_Cost
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Shirts
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
Short
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Pants
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
RH
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="ctlsc0x-supply-chain-analytics.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb155-2"><a href="ctlsc0x-supply-chain-analytics.html#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="ctlsc0x-supply-chain-analytics.html#cb155-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of Products</span></span>
<span id="cb155-4"><a href="ctlsc0x-supply-chain-analytics.html#cb155-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-5"><a href="ctlsc0x-supply-chain-analytics.html#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb155-6"><a href="ctlsc0x-supply-chain-analytics.html#cb155-6" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb155-7"><a href="ctlsc0x-supply-chain-analytics.html#cb155-7" aria-hidden="true" tabindex="-1"></a>RH <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb155-8"><a href="ctlsc0x-supply-chain-analytics.html#cb155-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb155-9"><a href="ctlsc0x-supply-chain-analytics.html#cb155-9" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb155-10"><a href="ctlsc0x-supply-chain-analytics.html#cb155-10" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb155-11"><a href="ctlsc0x-supply-chain-analytics.html#cb155-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-12"><a href="ctlsc0x-supply-chain-analytics.html#cb155-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb155-13"><a href="ctlsc0x-supply-chain-analytics.html#cb155-13" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb155-14"><a href="ctlsc0x-supply-chain-analytics.html#cb155-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb155-15"><a href="ctlsc0x-supply-chain-analytics.html#cb155-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb155-16"><a href="ctlsc0x-supply-chain-analytics.html#cb155-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb155-17"><a href="ctlsc0x-supply-chain-analytics.html#cb155-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of fixed cost</span></span>
<span id="cb155-18"><a href="ctlsc0x-supply-chain-analytics.html#cb155-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(y[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb155-19"><a href="ctlsc0x-supply-chain-analytics.html#cb155-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-20"><a href="ctlsc0x-supply-chain-analytics.html#cb155-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb155-21"><a href="ctlsc0x-supply-chain-analytics.html#cb155-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>(p[i]<span class="sc">-</span>c[i,<span class="dv">2</span>]) <span class="sc">-</span> y[i]<span class="sc">*</span>c[i,<span class="dv">1</span>], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb155-22"><a href="ctlsc0x-supply-chain-analytics.html#cb155-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-23"><a href="ctlsc0x-supply-chain-analytics.html#cb155-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb155-24"><a href="ctlsc0x-supply-chain-analytics.html#cb155-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> RH[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb155-25"><a href="ctlsc0x-supply-chain-analytics.html#cb155-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb155-26"><a href="ctlsc0x-supply-chain-analytics.html#cb155-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Flow Constraint</span></span>
<span id="cb155-27"><a href="ctlsc0x-supply-chain-analytics.html#cb155-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(x[i] <span class="sc">&lt;=</span> y[i]<span class="sc">*</span>M, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb155-28"><a href="ctlsc0x-supply-chain-analytics.html#cb155-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-29"><a href="ctlsc0x-supply-chain-analytics.html#cb155-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-30"><a href="ctlsc0x-supply-chain-analytics.html#cb155-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb155-31"><a href="ctlsc0x-supply-chain-analytics.html#cb155-31" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb155-32"><a href="ctlsc0x-supply-chain-analytics.html#cb155-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-33"><a href="ctlsc0x-supply-chain-analytics.html#cb155-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb155-34"><a href="ctlsc0x-supply-chain-analytics.html#cb155-34" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 75</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="ctlsc0x-supply-chain-analytics.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb157-2"><a href="ctlsc0x-supply-chain-analytics.html#cb157-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] x[3] y[1] y[2] y[3] 
##    0    0   25    0    0    1</code></pre>
</div>
<div id="minimum-amount-problem" class="section level4" number="1.2.2.4">
<h4><span class="header-section-number">1.2.2.4</span> Minimum Amount Problem</h4>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="ctlsc0x-supply-chain-analytics.html#cb159-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;Steel&quot;</span>,<span class="st">&quot;Labor&quot;</span>,<span class="st">&quot;Profit&quot;</span>),</span>
<span id="cb159-2"><a href="ctlsc0x-supply-chain-analytics.html#cb159-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Compact =</span> <span class="fu">c</span>(<span class="fl">1.5</span>,<span class="dv">30</span>,<span class="dv">2000</span>), <span class="at">Midsize =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">25</span>,<span class="dv">3000</span>),</span>
<span id="cb159-3"><a href="ctlsc0x-supply-chain-analytics.html#cb159-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Large =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">40</span>,<span class="dv">4000</span>), <span class="at">Capacity =</span> <span class="fu">c</span>(<span class="dv">6000</span>,<span class="dv">60000</span>,<span class="cn">NA</span>))</span>
<span id="cb159-4"><a href="ctlsc0x-supply-chain-analytics.html#cb159-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-5"><a href="ctlsc0x-supply-chain-analytics.html#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Minimum Amount Problem&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-49">Table 1.17: </span>Minimum Amount Problem
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Compact
</th>
<th style="text-align:right;">
Midsize
</th>
<th style="text-align:right;">
Large
</th>
<th style="text-align:right;">
Capacity
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Steel
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6000
</td>
</tr>
<tr>
<td style="text-align:left;">
Labor
</td>
<td style="text-align:right;">
30.0
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
60000
</td>
</tr>
<tr>
<td style="text-align:left;">
Profit
</td>
<td style="text-align:right;">
2000.0
</td>
<td style="text-align:right;">
3000
</td>
<td style="text-align:right;">
4000
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="ctlsc0x-supply-chain-analytics.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb160-2"><a href="ctlsc0x-supply-chain-analytics.html#cb160-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-3"><a href="ctlsc0x-supply-chain-analytics.html#cb160-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of cars</span></span>
<span id="cb160-4"><a href="ctlsc0x-supply-chain-analytics.html#cb160-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of components (labor &amp; Steel)</span></span>
<span id="cb160-5"><a href="ctlsc0x-supply-chain-analytics.html#cb160-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-6"><a href="ctlsc0x-supply-chain-analytics.html#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb160-7"><a href="ctlsc0x-supply-chain-analytics.html#cb160-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb160-8"><a href="ctlsc0x-supply-chain-analytics.html#cb160-8" aria-hidden="true" tabindex="-1"></a>RH <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">5</span>])</span>
<span id="cb160-9"><a href="ctlsc0x-supply-chain-analytics.html#cb160-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb160-10"><a href="ctlsc0x-supply-chain-analytics.html#cb160-10" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb160-11"><a href="ctlsc0x-supply-chain-analytics.html#cb160-11" aria-hidden="true" tabindex="-1"></a>Min <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb160-12"><a href="ctlsc0x-supply-chain-analytics.html#cb160-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-13"><a href="ctlsc0x-supply-chain-analytics.html#cb160-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb160-14"><a href="ctlsc0x-supply-chain-analytics.html#cb160-14" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb160-15"><a href="ctlsc0x-supply-chain-analytics.html#cb160-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb160-16"><a href="ctlsc0x-supply-chain-analytics.html#cb160-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb160-17"><a href="ctlsc0x-supply-chain-analytics.html#cb160-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-18"><a href="ctlsc0x-supply-chain-analytics.html#cb160-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of minimum amount condition</span></span>
<span id="cb160-19"><a href="ctlsc0x-supply-chain-analytics.html#cb160-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(y[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb160-20"><a href="ctlsc0x-supply-chain-analytics.html#cb160-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-21"><a href="ctlsc0x-supply-chain-analytics.html#cb160-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb160-22"><a href="ctlsc0x-supply-chain-analytics.html#cb160-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>p[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb160-23"><a href="ctlsc0x-supply-chain-analytics.html#cb160-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-24"><a href="ctlsc0x-supply-chain-analytics.html#cb160-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb160-25"><a href="ctlsc0x-supply-chain-analytics.html#cb160-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[j,i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> RH[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">%&gt;%</span></span>
<span id="cb160-26"><a href="ctlsc0x-supply-chain-analytics.html#cb160-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-27"><a href="ctlsc0x-supply-chain-analytics.html#cb160-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Flow Constraint</span></span>
<span id="cb160-28"><a href="ctlsc0x-supply-chain-analytics.html#cb160-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(x[i] <span class="sc">&lt;=</span> M<span class="sc">*</span>y[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb160-29"><a href="ctlsc0x-supply-chain-analytics.html#cb160-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb160-30"><a href="ctlsc0x-supply-chain-analytics.html#cb160-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Min quantity</span></span>
<span id="cb160-31"><a href="ctlsc0x-supply-chain-analytics.html#cb160-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(x[i] <span class="sc">&gt;=</span> Min<span class="sc">*</span>y[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb160-32"><a href="ctlsc0x-supply-chain-analytics.html#cb160-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-33"><a href="ctlsc0x-supply-chain-analytics.html#cb160-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb160-34"><a href="ctlsc0x-supply-chain-analytics.html#cb160-34" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb160-35"><a href="ctlsc0x-supply-chain-analytics.html#cb160-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-36"><a href="ctlsc0x-supply-chain-analytics.html#cb160-36" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb160-37"><a href="ctlsc0x-supply-chain-analytics.html#cb160-37" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 6000000</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="ctlsc0x-supply-chain-analytics.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb162-2"><a href="ctlsc0x-supply-chain-analytics.html#cb162-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] x[3] y[1] y[2] y[3] 
##    0 2000    0    0    1    0</code></pre>
</div>
<div id="transportation-problem" class="section level4" number="1.2.2.5">
<h4><span class="header-section-number">1.2.2.5</span> Transportation Problem</h4>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Minimize} &amp; \ z = \sum_{i=1}^{m} \sum_{i=1}^{N} c_{i,j} \cdot x_{i,j} \\
                          
\textbf{subject to} \\
    &amp; \sum_{i=1}^{N} x_{i,j} \ge D_j, \ \ j \in M \\
    &amp; \sum_{i=1}^{M} x_{i,j} \le S_i \ \ i \in N \\
    &amp; x_{i,j} \ge 0, \ x \in \mathbb{Z} \\
    
\textbf{Where} \\

&amp; i = \text{Type of Plant in N} \\
&amp; j = \text{Demand in M} \\
&amp; c_{i,j} = \text{Transportation cost from Plant to Demand} \\
&amp; x_{i,j} = \text{Quantity of product} \\
&amp; D_j = \text{Demand of cities} \\
&amp; S_j = \text{Plant Capacity}

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="ctlsc0x-supply-chain-analytics.html#cb164-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">From =</span> <span class="fu">c</span>(<span class="st">&quot;Plant 1&quot;</span>,<span class="st">&quot;Plant 2&quot;</span>,<span class="st">&quot;Plant 3&quot;</span>, <span class="st">&quot;Demand&quot;</span>),</span>
<span id="cb164-2"><a href="ctlsc0x-supply-chain-analytics.html#cb164-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">City_1 =</span> <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">14</span>,<span class="dv">45</span>), <span class="at">City_2 =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">20</span>),</span>
<span id="cb164-3"><a href="ctlsc0x-supply-chain-analytics.html#cb164-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">City_3 =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">30</span>), <span class="at">City_4 =</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">30</span>),</span>
<span id="cb164-4"><a href="ctlsc0x-supply-chain-analytics.html#cb164-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">Supply =</span> <span class="fu">c</span>(<span class="dv">35</span>,<span class="dv">50</span>,<span class="dv">40</span>,<span class="cn">NA</span>))</span>
<span id="cb164-5"><a href="ctlsc0x-supply-chain-analytics.html#cb164-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-6"><a href="ctlsc0x-supply-chain-analytics.html#cb164-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Transportation Problem&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-51">Table 1.18: </span>Transportation Problem
</caption>
<thead>
<tr>
<th style="text-align:left;">
From
</th>
<th style="text-align:right;">
City_1
</th>
<th style="text-align:right;">
City_2
</th>
<th style="text-align:right;">
City_3
</th>
<th style="text-align:right;">
City_4
</th>
<th style="text-align:right;">
Supply
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Plant 1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:left;">
Plant 2
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Plant 3
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
40
</td>
</tr>
<tr>
<td style="text-align:left;">
Demand
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="ctlsc0x-supply-chain-analytics.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb165-2"><a href="ctlsc0x-supply-chain-analytics.html#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="ctlsc0x-supply-chain-analytics.html#cb165-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of Plants</span></span>
<span id="cb165-4"><a href="ctlsc0x-supply-chain-analytics.html#cb165-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">4</span> <span class="co">#Number of cities</span></span>
<span id="cb165-5"><a href="ctlsc0x-supply-chain-analytics.html#cb165-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-6"><a href="ctlsc0x-supply-chain-analytics.html#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb165-7"><a href="ctlsc0x-supply-chain-analytics.html#cb165-7" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb165-8"><a href="ctlsc0x-supply-chain-analytics.html#cb165-8" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">6</span>])</span>
<span id="cb165-9"><a href="ctlsc0x-supply-chain-analytics.html#cb165-9" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb165-10"><a href="ctlsc0x-supply-chain-analytics.html#cb165-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-11"><a href="ctlsc0x-supply-chain-analytics.html#cb165-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-12"><a href="ctlsc0x-supply-chain-analytics.html#cb165-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb165-13"><a href="ctlsc0x-supply-chain-analytics.html#cb165-13" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb165-14"><a href="ctlsc0x-supply-chain-analytics.html#cb165-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb165-15"><a href="ctlsc0x-supply-chain-analytics.html#cb165-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb165-16"><a href="ctlsc0x-supply-chain-analytics.html#cb165-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-17"><a href="ctlsc0x-supply-chain-analytics.html#cb165-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb165-18"><a href="ctlsc0x-supply-chain-analytics.html#cb165-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i,j]<span class="sc">*</span>c[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m), <span class="st">&quot;min&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb165-19"><a href="ctlsc0x-supply-chain-analytics.html#cb165-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-20"><a href="ctlsc0x-supply-chain-analytics.html#cb165-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb165-21"><a href="ctlsc0x-supply-chain-analytics.html#cb165-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> D[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">%&gt;%</span></span>
<span id="cb165-22"><a href="ctlsc0x-supply-chain-analytics.html#cb165-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-23"><a href="ctlsc0x-supply-chain-analytics.html#cb165-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Flow Constraint</span></span>
<span id="cb165-24"><a href="ctlsc0x-supply-chain-analytics.html#cb165-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">&lt;=</span> S[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb165-25"><a href="ctlsc0x-supply-chain-analytics.html#cb165-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-26"><a href="ctlsc0x-supply-chain-analytics.html#cb165-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-27"><a href="ctlsc0x-supply-chain-analytics.html#cb165-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb165-28"><a href="ctlsc0x-supply-chain-analytics.html#cb165-28" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb165-29"><a href="ctlsc0x-supply-chain-analytics.html#cb165-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-30"><a href="ctlsc0x-supply-chain-analytics.html#cb165-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-31"><a href="ctlsc0x-supply-chain-analytics.html#cb165-31" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb165-32"><a href="ctlsc0x-supply-chain-analytics.html#cb165-32" aria-hidden="true" tabindex="-1"></a>Result <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data[<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">1</span>],</span>
<span id="cb165-33"><a href="ctlsc0x-supply-chain-analytics.html#cb165-33" aria-hidden="true" tabindex="-1"></a>                <span class="fu">matrix</span>(result<span class="sc">$</span>solution, <span class="at">nrow =</span> n, <span class="at">ncol =</span> m,</span>
<span id="cb165-34"><a href="ctlsc0x-supply-chain-analytics.html#cb165-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">colnames</span>(data[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>])))) <span class="sc">%&gt;%</span></span>
<span id="cb165-35"><a href="ctlsc0x-supply-chain-analytics.html#cb165-35" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">Supplied =</span> <span class="fu">colSums</span>(data[<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">2</span><span class="sc">:</span>m]), <span class="at">Supply =</span> data<span class="sc">$</span>Supply[<span class="dv">1</span><span class="sc">:</span>n]) <span class="sc">%&gt;%</span></span>
<span id="cb165-36"><a href="ctlsc0x-supply-chain-analytics.html#cb165-36" aria-hidden="true" tabindex="-1"></a>          <span class="fu">bind_rows</span>(<span class="fu">summarise_all</span>(., <span class="fu">funs</span>(<span class="cf">if</span>(<span class="fu">is.numeric</span>(.)) <span class="fu">sum</span>(.) <span class="cf">else</span> <span class="st">&quot;Total&quot;</span>)))</span>
<span id="cb165-37"><a href="ctlsc0x-supply-chain-analytics.html#cb165-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-38"><a href="ctlsc0x-supply-chain-analytics.html#cb165-38" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Result, <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Optimal Value: &quot;</span>, result<span class="sc">$</span>objective_value))</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-52">Table 1.19: </span>Optimal Value: 1020
</caption>
<thead>
<tr>
<th style="text-align:left;">
From
</th>
<th style="text-align:right;">
City_1
</th>
<th style="text-align:right;">
City_2
</th>
<th style="text-align:right;">
City_3
</th>
<th style="text-align:right;">
City_4
</th>
<th style="text-align:right;">
Supplied
</th>
<th style="text-align:right;">
Supply
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Plant 1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:left;">
Plant 2
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Plant 3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
40
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
125
</td>
</tr>
</tbody>
</table>
</div>
<div id="transhipment-problem" class="section level4" number="1.2.2.6">
<h4><span class="header-section-number">1.2.2.6</span> Transhipment Problem</h4>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Minimize} &amp; \ z = \sum_{i=1}^{M} \sum_{i=1}^{N} c_{i,j} \cdot x_{i,j} +
                          \sum_{i=1}^{N} c_{j,k} \cdot x_{j,k} \\
                          
\textbf{subject to} \\
    &amp; \sum_{i=1}^{M} x_{i,j} \le S_i, \ \ j \forall M \\
    &amp; \sum_{i=1}^{N} x_{j,k} \ge D_j, \ \ k \forall K \\
    &amp; \sum_{i=1}^{N} x_{i,j} \le T_j, \ \ j \forall M \\
    &amp; \sum_{i=1}^{N} x_{i,j} - \sum_{j=1}^{M} x_{j,k}  = 0, \ \ k \forall K \\
    &amp; x_{i,j,k} \ge 0, \ x \in \mathbb{Z} \\
    
\textbf{Where} \\

&amp; i = \text{Type of Plant in N} \\
&amp; j = \text{Transhipment in M} \\
&amp; k = \text{Demand in K} \\
&amp; c_{i,j} = \text{Inflow Transportation cost} \\
&amp; c_{j,k} = \text{Outflow Transportation cost} \\
&amp; x_{i,j} = \text{inflow of product} \\
&amp; x_{j,k} = \text{Outflow of product} \\
&amp; D_k = \text{Demand of cities} \\
&amp; S_i = \text{Plant Capacity} \\
&amp; T_j = \text{Transhipment Capacity}

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="ctlsc0x-supply-chain-analytics.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO Might be an error on the lecture slide W3-Advanced Optimization on slide 16, the Transshipment Problem. It states the flow constraint as \sum_i x_{i,j} = \sum_i x_{j,i}. This would mean the distance from the plant to CD is the same from the CD to POS. It seems it should be \sum_i x_{i,j} = \sum_j x_{j,k} where k is the node of demand.</span></span>
<span id="cb166-2"><a href="ctlsc0x-supply-chain-analytics.html#cb166-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-3"><a href="ctlsc0x-supply-chain-analytics.html#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO This could be simpler</span></span>
<span id="cb166-4"><a href="ctlsc0x-supply-chain-analytics.html#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="ctlsc0x-supply-chain-analytics.html#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Variable Names</span></span>
<span id="cb166-6"><a href="ctlsc0x-supply-chain-analytics.html#cb166-6" aria-hidden="true" tabindex="-1"></a>Ps <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;P_1&quot;</span>,<span class="st">&quot;P_2&quot;</span>,<span class="st">&quot;P_3&quot;</span>,<span class="st">&quot;P_4&quot;</span>,<span class="st">&quot;P_5&quot;</span>)</span>
<span id="cb166-7"><a href="ctlsc0x-supply-chain-analytics.html#cb166-7" aria-hidden="true" tabindex="-1"></a>Tsn <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;TS_1&quot;</span>,<span class="st">&quot;TS_2&quot;</span>)</span>
<span id="cb166-8"><a href="ctlsc0x-supply-chain-analytics.html#cb166-8" aria-hidden="true" tabindex="-1"></a>Tso <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;TO_1&quot;</span>,<span class="st">&quot;TO_2&quot;</span>)</span>
<span id="cb166-9"><a href="ctlsc0x-supply-chain-analytics.html#cb166-9" aria-hidden="true" tabindex="-1"></a>Dn <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;D_1&quot;</span>,<span class="st">&quot;D_2&quot;</span>,<span class="st">&quot;D_3&quot;</span>,<span class="st">&quot;D_4&quot;</span>,<span class="st">&quot;D_5&quot;</span>)</span>
<span id="cb166-10"><a href="ctlsc0x-supply-chain-analytics.html#cb166-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-11"><a href="ctlsc0x-supply-chain-analytics.html#cb166-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Values</span></span>
<span id="cb166-12"><a href="ctlsc0x-supply-chain-analytics.html#cb166-12" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">200</span>,<span class="dv">300</span>,<span class="dv">100</span>,<span class="dv">150</span>,<span class="dv">220</span>), <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(Ps,<span class="st">&quot;Plant_Cap&quot;</span>))</span>
<span id="cb166-13"><a href="ctlsc0x-supply-chain-analytics.html#cb166-13" aria-hidden="true" tabindex="-1"></a>Ts <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">450</span>,<span class="dv">300</span>), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="st">&quot;Transh_Cap&quot;</span>,Tsn))</span>
<span id="cb166-14"><a href="ctlsc0x-supply-chain-analytics.html#cb166-14" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">150</span>,<span class="dv">100</span>,<span class="dv">110</span>,<span class="dv">200</span>,<span class="dv">180</span>), <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(Dn,<span class="st">&quot;Demand&quot;</span>))</span>
<span id="cb166-15"><a href="ctlsc0x-supply-chain-analytics.html#cb166-15" aria-hidden="true" tabindex="-1"></a>inc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">23</span>,<span class="dv">66</span>,<span class="dv">35</span>,<span class="dv">14</span>,<span class="dv">70</span>,<span class="dv">12</span>,<span class="dv">65</span>,<span class="dv">70</span>), <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> T,</span>
<span id="cb166-16"><a href="ctlsc0x-supply-chain-analytics.html#cb166-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">dimnames =</span> <span class="fu">list</span>(Ps,Tsn))</span>
<span id="cb166-17"><a href="ctlsc0x-supply-chain-analytics.html#cb166-17" aria-hidden="true" tabindex="-1"></a>outc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">25</span>,<span class="dv">22</span>,<span class="dv">40</span>,<span class="dv">41</span>,<span class="dv">65</span>,<span class="dv">22</span>,<span class="dv">23</span>,<span class="dv">12</span>,<span class="dv">15</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">byrow =</span> T,</span>
<span id="cb166-18"><a href="ctlsc0x-supply-chain-analytics.html#cb166-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">dimnames =</span> <span class="fu">list</span>(Tso,Dn))</span>
<span id="cb166-19"><a href="ctlsc0x-supply-chain-analytics.html#cb166-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-20"><a href="ctlsc0x-supply-chain-analytics.html#cb166-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-21"><a href="ctlsc0x-supply-chain-analytics.html#cb166-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualizing dataset</span></span>
<span id="cb166-22"><a href="ctlsc0x-supply-chain-analytics.html#cb166-22" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(S) <span class="sc">%&gt;%</span></span>
<span id="cb166-23"><a href="ctlsc0x-supply-chain-analytics.html#cb166-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cbind</span>(inc,<span class="fu">t</span>(outc),D)</span>
<span id="cb166-24"><a href="ctlsc0x-supply-chain-analytics.html#cb166-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-25"><a href="ctlsc0x-supply-chain-analytics.html#cb166-25" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Transhipment Problem&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-53">Table 1.20: </span>Transhipment Problem
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Plant_Cap
</th>
<th style="text-align:right;">
TS_1
</th>
<th style="text-align:right;">
TS_2
</th>
<th style="text-align:right;">
TO_1
</th>
<th style="text-align:right;">
TO_2
</th>
<th style="text-align:right;">
Demand
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P_1
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
150
</td>
</tr>
<tr>
<td style="text-align:left;">
P_2
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
P_3
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
110
</td>
</tr>
<tr>
<td style="text-align:left;">
P_4
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
200
</td>
</tr>
<tr>
<td style="text-align:left;">
P_5
</td>
<td style="text-align:right;">
220
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
180
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="ctlsc0x-supply-chain-analytics.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb167-2"><a href="ctlsc0x-supply-chain-analytics.html#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="ctlsc0x-supply-chain-analytics.html#cb167-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">5</span> <span class="co">#Number of Plants</span></span>
<span id="cb167-4"><a href="ctlsc0x-supply-chain-analytics.html#cb167-4" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of transhipments (CDs)</span></span>
<span id="cb167-5"><a href="ctlsc0x-supply-chain-analytics.html#cb167-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">5</span> <span class="co">#Number of cities (POS)</span></span>
<span id="cb167-6"><a href="ctlsc0x-supply-chain-analytics.html#cb167-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-7"><a href="ctlsc0x-supply-chain-analytics.html#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb167-8"><a href="ctlsc0x-supply-chain-analytics.html#cb167-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb167-9"><a href="ctlsc0x-supply-chain-analytics.html#cb167-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of inflow</span></span>
<span id="cb167-10"><a href="ctlsc0x-supply-chain-analytics.html#cb167-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb167-11"><a href="ctlsc0x-supply-chain-analytics.html#cb167-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-12"><a href="ctlsc0x-supply-chain-analytics.html#cb167-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of outflow</span></span>
<span id="cb167-13"><a href="ctlsc0x-supply-chain-analytics.html#cb167-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(u[j,k], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t, <span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>m, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb167-14"><a href="ctlsc0x-supply-chain-analytics.html#cb167-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-15"><a href="ctlsc0x-supply-chain-analytics.html#cb167-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># minimize distance cost</span></span>
<span id="cb167-16"><a href="ctlsc0x-supply-chain-analytics.html#cb167-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i,j]<span class="sc">*</span>inc[i,j],  <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t) <span class="sc">+</span> </span>
<span id="cb167-17"><a href="ctlsc0x-supply-chain-analytics.html#cb167-17" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sum_expr</span>(u[j,k]<span class="sc">*</span>outc[j,k], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t, <span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>m), <span class="st">&quot;min&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb167-18"><a href="ctlsc0x-supply-chain-analytics.html#cb167-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-19"><a href="ctlsc0x-supply-chain-analytics.html#cb167-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Supply Constraint</span></span>
<span id="cb167-20"><a href="ctlsc0x-supply-chain-analytics.html#cb167-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t) <span class="sc">&lt;=</span> S[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb167-21"><a href="ctlsc0x-supply-chain-analytics.html#cb167-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-22"><a href="ctlsc0x-supply-chain-analytics.html#cb167-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb167-23"><a href="ctlsc0x-supply-chain-analytics.html#cb167-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(u[j,k], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t) <span class="sc">&gt;=</span> D[k], <span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">%&gt;%</span></span>
<span id="cb167-24"><a href="ctlsc0x-supply-chain-analytics.html#cb167-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-25"><a href="ctlsc0x-supply-chain-analytics.html#cb167-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb167-26"><a href="ctlsc0x-supply-chain-analytics.html#cb167-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> Ts[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t) <span class="sc">%&gt;%</span></span>
<span id="cb167-27"><a href="ctlsc0x-supply-chain-analytics.html#cb167-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-28"><a href="ctlsc0x-supply-chain-analytics.html#cb167-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Flow constraint</span></span>
<span id="cb167-29"><a href="ctlsc0x-supply-chain-analytics.html#cb167-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">-</span> <span class="fu">sum_expr</span>(u[j,k], <span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb167-30"><a href="ctlsc0x-supply-chain-analytics.html#cb167-30" aria-hidden="true" tabindex="-1"></a>                 <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t)</span>
<span id="cb167-31"><a href="ctlsc0x-supply-chain-analytics.html#cb167-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-32"><a href="ctlsc0x-supply-chain-analytics.html#cb167-32" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb167-33"><a href="ctlsc0x-supply-chain-analytics.html#cb167-33" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb167-34"><a href="ctlsc0x-supply-chain-analytics.html#cb167-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-35"><a href="ctlsc0x-supply-chain-analytics.html#cb167-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-36"><a href="ctlsc0x-supply-chain-analytics.html#cb167-36" aria-hidden="true" tabindex="-1"></a><span class="co">#Result</span></span>
<span id="cb167-37"><a href="ctlsc0x-supply-chain-analytics.html#cb167-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-38"><a href="ctlsc0x-supply-chain-analytics.html#cb167-38" aria-hidden="true" tabindex="-1"></a><span class="co">#Inflow</span></span>
<span id="cb167-39"><a href="ctlsc0x-supply-chain-analytics.html#cb167-39" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(<span class="fu">matrix</span>(<span class="fu">get_solution</span>(result, x[i,j])<span class="sc">$</span>value,</span>
<span id="cb167-40"><a href="ctlsc0x-supply-chain-analytics.html#cb167-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">nrow =</span> n, <span class="at">ncol =</span> t, <span class="at">dimnames =</span> <span class="fu">list</span>(Ps,Tsn))) <span class="sc">%&gt;%</span></span>
<span id="cb167-41"><a href="ctlsc0x-supply-chain-analytics.html#cb167-41" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">Plant =</span> Ps, <span class="at">Production =</span> <span class="fu">rowSums</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb167-42"><a href="ctlsc0x-supply-chain-analytics.html#cb167-42" aria-hidden="true" tabindex="-1"></a>     <span class="fu">select</span>(Plant, <span class="sc">-</span>Production,  <span class="fu">everything</span>(), Production) <span class="sc">%&gt;%</span></span>
<span id="cb167-43"><a href="ctlsc0x-supply-chain-analytics.html#cb167-43" aria-hidden="true" tabindex="-1"></a>     <span class="fu">cbind</span>(<span class="at">Plant_Cap =</span> data<span class="sc">$</span>Plant_Cap) <span class="sc">%&gt;%</span></span>
<span id="cb167-44"><a href="ctlsc0x-supply-chain-analytics.html#cb167-44" aria-hidden="true" tabindex="-1"></a>     <span class="fu">bind_rows</span>(<span class="fu">summarise_all</span>(., <span class="fu">funs</span>(<span class="cf">if</span>(<span class="fu">is.numeric</span>(.)) <span class="fu">sum</span>(.) <span class="cf">else</span> <span class="st">&quot;Total&quot;</span>)))</span>
<span id="cb167-45"><a href="ctlsc0x-supply-chain-analytics.html#cb167-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-46"><a href="ctlsc0x-supply-chain-analytics.html#cb167-46" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(a, <span class="at">rownames =</span> F, <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Optimal Value: &quot;</span>, result<span class="sc">$</span>objective_value))</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-54">Table 1.21: </span>Optimal Value: 30700
</caption>
<thead>
<tr>
<th style="text-align:left;">
Plant
</th>
<th style="text-align:right;">
TS_1
</th>
<th style="text-align:right;">
TS_2
</th>
<th style="text-align:right;">
Production
</th>
<th style="text-align:right;">
Plant_Cap
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P_1
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
190
</td>
<td style="text-align:right;">
200
</td>
</tr>
<tr>
<td style="text-align:left;">
P_2
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
300
</td>
</tr>
<tr>
<td style="text-align:left;">
P_3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
P_4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
150
</td>
</tr>
<tr>
<td style="text-align:left;">
P_5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
220
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:right;">
440
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
740
</td>
<td style="text-align:right;">
970
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="ctlsc0x-supply-chain-analytics.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Outflow</span></span>
<span id="cb168-2"><a href="ctlsc0x-supply-chain-analytics.html#cb168-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(<span class="fu">matrix</span>(<span class="fu">get_solution</span>(result, u[j,k])<span class="sc">$</span>value, <span class="at">nrow =</span> t, <span class="at">ncol =</span> m,</span>
<span id="cb168-3"><a href="ctlsc0x-supply-chain-analytics.html#cb168-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dimnames =</span> <span class="fu">list</span>(Tso,Dn))) <span class="sc">%&gt;%</span></span>
<span id="cb168-4"><a href="ctlsc0x-supply-chain-analytics.html#cb168-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="at">DC =</span> Tso, <span class="at">demand =</span> <span class="fu">rowSums</span>(.), <span class="at">DC_Cap =</span> Ts) <span class="sc">%&gt;%</span></span>
<span id="cb168-5"><a href="ctlsc0x-supply-chain-analytics.html#cb168-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">select</span>(DC,<span class="sc">-</span>demand, <span class="fu">everything</span>(), demand) <span class="sc">%&gt;%</span></span>
<span id="cb168-6"><a href="ctlsc0x-supply-chain-analytics.html#cb168-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">bind_rows</span>(<span class="fu">summarise_all</span>(., <span class="fu">funs</span>(<span class="cf">if</span>(<span class="fu">is.numeric</span>(.)) <span class="fu">sum</span>(.) <span class="cf">else</span> <span class="st">&quot;Total&quot;</span>)))</span>
<span id="cb168-7"><a href="ctlsc0x-supply-chain-analytics.html#cb168-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-8"><a href="ctlsc0x-supply-chain-analytics.html#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(b, <span class="at">row.names =</span> F, <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Optimal Value: &quot;</span>, result<span class="sc">$</span>objective_value))</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-54">Table 1.21: </span>Optimal Value: 30700
</caption>
<thead>
<tr>
<th style="text-align:left;">
DC
</th>
<th style="text-align:right;">
D_1
</th>
<th style="text-align:right;">
D_2
</th>
<th style="text-align:right;">
D_3
</th>
<th style="text-align:right;">
D_4
</th>
<th style="text-align:right;">
D_5
</th>
<th style="text-align:right;">
demand
</th>
<th style="text-align:right;">
DC_Cap
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
TO_1
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
440
</td>
<td style="text-align:right;">
450
</td>
</tr>
<tr>
<td style="text-align:left;">
TO_2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
450
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
180
</td>
<td style="text-align:right;">
740
</td>
<td style="text-align:right;">
1500
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="practice-problems-1" class="section level3" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Practice Problems</h3>
<div id="production-scheduling" class="section level4" number="1.2.3.1">
<h4><span class="header-section-number">1.2.3.1</span> Production Scheduling</h4>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="ctlsc0x-supply-chain-analytics.html#cb169-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;Maximize&quot;</span>, <span class="st">&quot;Electrician&quot;</span>,<span class="st">&quot;Mechanic&quot;</span>),</span>
<span id="cb169-2"><a href="ctlsc0x-supply-chain-analytics.html#cb169-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Prod_X =</span> <span class="fu">c</span>(<span class="fl">1.5</span>,<span class="fl">1.2</span>,<span class="fl">0.5</span>), <span class="at">Prod_Y  =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="fl">1.6</span>), <span class="at">RH =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="fl">7.6</span>,<span class="fl">6.5</span>))</span>
<span id="cb169-3"><a href="ctlsc0x-supply-chain-analytics.html#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="ctlsc0x-supply-chain-analytics.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Production Scheduling&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-55">Table 1.22: </span>Production Scheduling
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Prod_X
</th>
<th style="text-align:right;">
Prod_Y
</th>
<th style="text-align:right;">
RH
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Maximize
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Electrician
</td>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
7.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Mechanic
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1.6
</td>
<td style="text-align:right;">
6.5
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="ctlsc0x-supply-chain-analytics.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb170-2"><a href="ctlsc0x-supply-chain-analytics.html#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="ctlsc0x-supply-chain-analytics.html#cb170-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of Products</span></span>
<span id="cb170-4"><a href="ctlsc0x-supply-chain-analytics.html#cb170-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of constraints</span></span>
<span id="cb170-5"><a href="ctlsc0x-supply-chain-analytics.html#cb170-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-6"><a href="ctlsc0x-supply-chain-analytics.html#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb170-7"><a href="ctlsc0x-supply-chain-analytics.html#cb170-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb170-8"><a href="ctlsc0x-supply-chain-analytics.html#cb170-8" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb170-9"><a href="ctlsc0x-supply-chain-analytics.html#cb170-9" aria-hidden="true" tabindex="-1"></a>RH <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb170-10"><a href="ctlsc0x-supply-chain-analytics.html#cb170-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-11"><a href="ctlsc0x-supply-chain-analytics.html#cb170-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb170-12"><a href="ctlsc0x-supply-chain-analytics.html#cb170-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb170-13"><a href="ctlsc0x-supply-chain-analytics.html#cb170-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-14"><a href="ctlsc0x-supply-chain-analytics.html#cb170-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb170-15"><a href="ctlsc0x-supply-chain-analytics.html#cb170-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb170-16"><a href="ctlsc0x-supply-chain-analytics.html#cb170-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-17"><a href="ctlsc0x-supply-chain-analytics.html#cb170-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb170-18"><a href="ctlsc0x-supply-chain-analytics.html#cb170-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb170-19"><a href="ctlsc0x-supply-chain-analytics.html#cb170-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-20"><a href="ctlsc0x-supply-chain-analytics.html#cb170-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb170-21"><a href="ctlsc0x-supply-chain-analytics.html#cb170-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>c[j,i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> RH[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb170-22"><a href="ctlsc0x-supply-chain-analytics.html#cb170-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-23"><a href="ctlsc0x-supply-chain-analytics.html#cb170-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb170-24"><a href="ctlsc0x-supply-chain-analytics.html#cb170-24" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb170-25"><a href="ctlsc0x-supply-chain-analytics.html#cb170-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-26"><a href="ctlsc0x-supply-chain-analytics.html#cb170-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb170-27"><a href="ctlsc0x-supply-chain-analytics.html#cb170-27" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 10.5</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="ctlsc0x-supply-chain-analytics.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb172-2"><a href="ctlsc0x-supply-chain-analytics.html#cb172-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] 
##    3    3</code></pre>
</div>
<div id="capital-budgeting-problem-1" class="section level4" number="1.2.3.2">
<h4><span class="header-section-number">1.2.3.2</span> Capital Budgeting Problem</h4>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="ctlsc0x-supply-chain-analytics.html#cb174-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Project =</span> <span class="fu">c</span>(<span class="st">&quot;P1&quot;</span>,<span class="st">&quot;P2&quot;</span>,<span class="st">&quot;P3&quot;</span>,<span class="st">&quot;P4&quot;</span>,<span class="st">&quot;P5&quot;</span>,<span class="st">&quot;Funds&quot;</span>),</span>
<span id="cb174-2"><a href="ctlsc0x-supply-chain-analytics.html#cb174-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Exp_1 =</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">25</span>), <span class="at">Exp_2 =</span> <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">20</span>),</span>
<span id="cb174-3"><a href="ctlsc0x-supply-chain-analytics.html#cb174-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Exp_3 =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">20</span>), <span class="at">Returns =</span> <span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">23</span>,<span class="dv">27</span>,<span class="cn">NA</span>))</span>
<span id="cb174-4"><a href="ctlsc0x-supply-chain-analytics.html#cb174-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-5"><a href="ctlsc0x-supply-chain-analytics.html#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Capital Budgeting Problem&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-57">Table 1.23: </span>Capital Budgeting Problem
</caption>
<thead>
<tr>
<th style="text-align:left;">
Project
</th>
<th style="text-align:right;">
Exp_1
</th>
<th style="text-align:right;">
Exp_2
</th>
<th style="text-align:right;">
Exp_3
</th>
<th style="text-align:right;">
Returns
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P1
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:left;">
P2
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
20
</td>
</tr>
<tr>
<td style="text-align:left;">
P3
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
25
</td>
</tr>
<tr>
<td style="text-align:left;">
P4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
23
</td>
</tr>
<tr>
<td style="text-align:left;">
P5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
27
</td>
</tr>
<tr>
<td style="text-align:left;">
Funds
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="ctlsc0x-supply-chain-analytics.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb175-2"><a href="ctlsc0x-supply-chain-analytics.html#cb175-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-3"><a href="ctlsc0x-supply-chain-analytics.html#cb175-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">5</span> <span class="co">#Number of Projects</span></span>
<span id="cb175-4"><a href="ctlsc0x-supply-chain-analytics.html#cb175-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of Years</span></span>
<span id="cb175-5"><a href="ctlsc0x-supply-chain-analytics.html#cb175-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-6"><a href="ctlsc0x-supply-chain-analytics.html#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb175-7"><a href="ctlsc0x-supply-chain-analytics.html#cb175-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">5</span>])</span>
<span id="cb175-8"><a href="ctlsc0x-supply-chain-analytics.html#cb175-8" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb175-9"><a href="ctlsc0x-supply-chain-analytics.html#cb175-9" aria-hidden="true" tabindex="-1"></a>RH <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">6</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb175-10"><a href="ctlsc0x-supply-chain-analytics.html#cb175-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-11"><a href="ctlsc0x-supply-chain-analytics.html#cb175-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb175-12"><a href="ctlsc0x-supply-chain-analytics.html#cb175-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb175-13"><a href="ctlsc0x-supply-chain-analytics.html#cb175-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb175-14"><a href="ctlsc0x-supply-chain-analytics.html#cb175-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb175-15"><a href="ctlsc0x-supply-chain-analytics.html#cb175-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-16"><a href="ctlsc0x-supply-chain-analytics.html#cb175-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb175-17"><a href="ctlsc0x-supply-chain-analytics.html#cb175-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb175-18"><a href="ctlsc0x-supply-chain-analytics.html#cb175-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-19"><a href="ctlsc0x-supply-chain-analytics.html#cb175-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb175-20"><a href="ctlsc0x-supply-chain-analytics.html#cb175-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>c[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> RH[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb175-21"><a href="ctlsc0x-supply-chain-analytics.html#cb175-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-22"><a href="ctlsc0x-supply-chain-analytics.html#cb175-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb175-23"><a href="ctlsc0x-supply-chain-analytics.html#cb175-23" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb175-24"><a href="ctlsc0x-supply-chain-analytics.html#cb175-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-25"><a href="ctlsc0x-supply-chain-analytics.html#cb175-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb175-26"><a href="ctlsc0x-supply-chain-analytics.html#cb175-26" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 82</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="ctlsc0x-supply-chain-analytics.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb177-2"><a href="ctlsc0x-supply-chain-analytics.html#cb177-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] x[3] x[4] x[5] 
##    1    0    1    0    1</code></pre>
</div>
<div id="fixed-charge-problem-1" class="section level4" number="1.2.3.3">
<h4><span class="header-section-number">1.2.3.3</span> Fixed Charge Problem</h4>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="ctlsc0x-supply-chain-analytics.html#cb179-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;Homer&quot;</span>,<span class="st">&quot;Turner&quot;</span>,<span class="st">&quot;Sargent&quot;</span>,<span class="st">&quot;RH&quot;</span>),</span>
<span id="cb179-2"><a href="ctlsc0x-supply-chain-analytics.html#cb179-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Labor =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">150</span>), <span class="at">Glass =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">160</span>),</span>
<span id="cb179-3"><a href="ctlsc0x-supply-chain-analytics.html#cb179-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Sales =</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">8</span>,<span class="dv">15</span>,<span class="cn">NA</span>), <span class="at">Fix_Cost =</span> <span class="fu">c</span>(<span class="dv">200</span>,<span class="dv">150</span>,<span class="dv">100</span>,<span class="cn">NA</span>),</span>
<span id="cb179-4"><a href="ctlsc0x-supply-chain-analytics.html#cb179-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">Var_Cost =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">8</span>,<span class="cn">NA</span>))</span>
<span id="cb179-5"><a href="ctlsc0x-supply-chain-analytics.html#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="ctlsc0x-supply-chain-analytics.html#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Fixed Charge Problem&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-59">Table 1.24: </span>Fixed Charge Problem
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Labor
</th>
<th style="text-align:right;">
Glass
</th>
<th style="text-align:right;">
Sales
</th>
<th style="text-align:right;">
Fix_Cost
</th>
<th style="text-align:right;">
Var_Cost
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Homer
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
Turner
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Sargent
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
RH
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="ctlsc0x-supply-chain-analytics.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x,y)</span>
<span id="cb180-2"><a href="ctlsc0x-supply-chain-analytics.html#cb180-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-3"><a href="ctlsc0x-supply-chain-analytics.html#cb180-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of Products</span></span>
<span id="cb180-4"><a href="ctlsc0x-supply-chain-analytics.html#cb180-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-5"><a href="ctlsc0x-supply-chain-analytics.html#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb180-6"><a href="ctlsc0x-supply-chain-analytics.html#cb180-6" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb180-7"><a href="ctlsc0x-supply-chain-analytics.html#cb180-7" aria-hidden="true" tabindex="-1"></a>RH <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb180-8"><a href="ctlsc0x-supply-chain-analytics.html#cb180-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb180-9"><a href="ctlsc0x-supply-chain-analytics.html#cb180-9" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb180-10"><a href="ctlsc0x-supply-chain-analytics.html#cb180-10" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb180-11"><a href="ctlsc0x-supply-chain-analytics.html#cb180-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-12"><a href="ctlsc0x-supply-chain-analytics.html#cb180-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb180-13"><a href="ctlsc0x-supply-chain-analytics.html#cb180-13" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb180-14"><a href="ctlsc0x-supply-chain-analytics.html#cb180-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb180-15"><a href="ctlsc0x-supply-chain-analytics.html#cb180-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb180-16"><a href="ctlsc0x-supply-chain-analytics.html#cb180-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb180-17"><a href="ctlsc0x-supply-chain-analytics.html#cb180-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of fixed cost</span></span>
<span id="cb180-18"><a href="ctlsc0x-supply-chain-analytics.html#cb180-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(y[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb180-19"><a href="ctlsc0x-supply-chain-analytics.html#cb180-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-20"><a href="ctlsc0x-supply-chain-analytics.html#cb180-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb180-21"><a href="ctlsc0x-supply-chain-analytics.html#cb180-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>(p[i]<span class="sc">-</span>c[i,<span class="dv">2</span>]) <span class="sc">-</span> y[i]<span class="sc">*</span>c[i,<span class="dv">1</span>], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb180-22"><a href="ctlsc0x-supply-chain-analytics.html#cb180-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-23"><a href="ctlsc0x-supply-chain-analytics.html#cb180-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb180-24"><a href="ctlsc0x-supply-chain-analytics.html#cb180-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> RH[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb180-25"><a href="ctlsc0x-supply-chain-analytics.html#cb180-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb180-26"><a href="ctlsc0x-supply-chain-analytics.html#cb180-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Flow Constraint</span></span>
<span id="cb180-27"><a href="ctlsc0x-supply-chain-analytics.html#cb180-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(x[i] <span class="sc">&lt;=</span> y[i]<span class="sc">*</span>M, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb180-28"><a href="ctlsc0x-supply-chain-analytics.html#cb180-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-29"><a href="ctlsc0x-supply-chain-analytics.html#cb180-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-30"><a href="ctlsc0x-supply-chain-analytics.html#cb180-30" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb180-31"><a href="ctlsc0x-supply-chain-analytics.html#cb180-31" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb180-32"><a href="ctlsc0x-supply-chain-analytics.html#cb180-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-33"><a href="ctlsc0x-supply-chain-analytics.html#cb180-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimal Value</span></span>
<span id="cb180-34"><a href="ctlsc0x-supply-chain-analytics.html#cb180-34" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 75</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="ctlsc0x-supply-chain-analytics.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb182-2"><a href="ctlsc0x-supply-chain-analytics.html#cb182-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## x[1] x[2] x[3] y[1] y[2] y[3] 
##    0    0   25    0    0    1</code></pre>
</div>
<div id="minimums-and-maximums" class="section level4" number="1.2.3.4">
<h4><span class="header-section-number">1.2.3.4</span> Minimums and Maximums</h4>
<p>This exercise has some of changing conditions that we can set as a funcion:
-Component Capacity
-Minimum Demand
-Maximum Demand
-Fixed Cost</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="ctlsc0x-supply-chain-analytics.html#cb184-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;Labor&quot;</span>,<span class="st">&quot;Balloons&quot;</span>,<span class="st">&quot;Cost&quot;</span>,<span class="st">&quot;Price&quot;</span>),</span>
<span id="cb184-2"><a href="ctlsc0x-supply-chain-analytics.html#cb184-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Standard =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">Joyful =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>),</span>
<span id="cb184-3"><a href="ctlsc0x-supply-chain-analytics.html#cb184-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Fabulous =</span> <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">7</span>))</span>
<span id="cb184-4"><a href="ctlsc0x-supply-chain-analytics.html#cb184-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-5"><a href="ctlsc0x-supply-chain-analytics.html#cb184-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-6"><a href="ctlsc0x-supply-chain-analytics.html#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Minimums and Maximums&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-61">Table 1.25: </span>Minimums and Maximums
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Standard
</th>
<th style="text-align:right;">
Joyful
</th>
<th style="text-align:right;">
Fabulous
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Labor
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
Balloons
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
Cost
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
Price
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
7
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="ctlsc0x-supply-chain-analytics.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO Resultados não estão batendo</span></span>
<span id="cb185-2"><a href="ctlsc0x-supply-chain-analytics.html#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="ctlsc0x-supply-chain-analytics.html#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb185-4"><a href="ctlsc0x-supply-chain-analytics.html#cb185-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-5"><a href="ctlsc0x-supply-chain-analytics.html#cb185-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of products</span></span>
<span id="cb185-6"><a href="ctlsc0x-supply-chain-analytics.html#cb185-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">2</span> <span class="co">#Number of components (labor &amp; Baloons)</span></span>
<span id="cb185-7"><a href="ctlsc0x-supply-chain-analytics.html#cb185-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-8"><a href="ctlsc0x-supply-chain-analytics.html#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Fixed data</span></span>
<span id="cb185-9"><a href="ctlsc0x-supply-chain-analytics.html#cb185-9" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb185-10"><a href="ctlsc0x-supply-chain-analytics.html#cb185-10" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb185-11"><a href="ctlsc0x-supply-chain-analytics.html#cb185-11" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb185-12"><a href="ctlsc0x-supply-chain-analytics.html#cb185-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-13"><a href="ctlsc0x-supply-chain-analytics.html#cb185-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-14"><a href="ctlsc0x-supply-chain-analytics.html#cb185-14" aria-hidden="true" tabindex="-1"></a><span class="co"># #Variables of questions index</span></span>
<span id="cb185-15"><a href="ctlsc0x-supply-chain-analytics.html#cb185-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Component Capacity = RH 1:m</span></span>
<span id="cb185-16"><a href="ctlsc0x-supply-chain-analytics.html#cb185-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimum Demand = Min 1:n</span></span>
<span id="cb185-17"><a href="ctlsc0x-supply-chain-analytics.html#cb185-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Maximum Demand = Max  1:n</span></span>
<span id="cb185-18"><a href="ctlsc0x-supply-chain-analytics.html#cb185-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed Cost = Fc 1:n</span></span>
<span id="cb185-19"><a href="ctlsc0x-supply-chain-analytics.html#cb185-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-20"><a href="ctlsc0x-supply-chain-analytics.html#cb185-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb185-21"><a href="ctlsc0x-supply-chain-analytics.html#cb185-21" aria-hidden="true" tabindex="-1"></a>Model <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">RH =</span> <span class="cn">NA</span>, <span class="at">Min =</span> <span class="cn">NA</span>, <span class="at">Max =</span> <span class="cn">NA</span>, <span class="at">Fc =</span> <span class="cn">NA</span> ){</span>
<span id="cb185-22"><a href="ctlsc0x-supply-chain-analytics.html#cb185-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-23"><a href="ctlsc0x-supply-chain-analytics.html#cb185-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-24"><a href="ctlsc0x-supply-chain-analytics.html#cb185-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-25"><a href="ctlsc0x-supply-chain-analytics.html#cb185-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(RH))  {RH <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">replicate</span>(<span class="at">n =</span> m, <span class="dv">9999</span>))} <span class="cf">else</span> {RH <span class="ot">=</span> <span class="fu">as.matrix</span>(RH)}</span>
<span id="cb185-26"><a href="ctlsc0x-supply-chain-analytics.html#cb185-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(Min)) {Min <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">replicate</span>(<span class="at">n =</span> n, <span class="dv">0</span>))} <span class="cf">else</span> {Min <span class="ot">=</span> <span class="fu">as.matrix</span>(Min)}</span>
<span id="cb185-27"><a href="ctlsc0x-supply-chain-analytics.html#cb185-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(Max)) {Max <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">replicate</span>(<span class="at">n =</span> n, <span class="dv">9999</span>))} <span class="cf">else</span> {Max <span class="ot">=</span> <span class="fu">as.matrix</span>(Max)}</span>
<span id="cb185-28"><a href="ctlsc0x-supply-chain-analytics.html#cb185-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(Fc))  {Fc <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">replicate</span>(<span class="at">n =</span> n, <span class="dv">0</span>))} <span class="cf">else</span> {Fc <span class="ot">=</span> <span class="fu">as.matrix</span>(Fc)}</span>
<span id="cb185-29"><a href="ctlsc0x-supply-chain-analytics.html#cb185-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-30"><a href="ctlsc0x-supply-chain-analytics.html#cb185-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-31"><a href="ctlsc0x-supply-chain-analytics.html#cb185-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-32"><a href="ctlsc0x-supply-chain-analytics.html#cb185-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-33"><a href="ctlsc0x-supply-chain-analytics.html#cb185-33" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb185-34"><a href="ctlsc0x-supply-chain-analytics.html#cb185-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-35"><a href="ctlsc0x-supply-chain-analytics.html#cb185-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Variable of production</span></span>
<span id="cb185-36"><a href="ctlsc0x-supply-chain-analytics.html#cb185-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-37"><a href="ctlsc0x-supply-chain-analytics.html#cb185-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb185-38"><a href="ctlsc0x-supply-chain-analytics.html#cb185-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Variable of minimum amount condition</span></span>
<span id="cb185-39"><a href="ctlsc0x-supply-chain-analytics.html#cb185-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_variable</span>(y[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-40"><a href="ctlsc0x-supply-chain-analytics.html#cb185-40" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb185-41"><a href="ctlsc0x-supply-chain-analytics.html#cb185-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># maximize profit</span></span>
<span id="cb185-42"><a href="ctlsc0x-supply-chain-analytics.html#cb185-42" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>(p[i]<span class="sc">-</span>c[i]) <span class="sc">-</span> y[i]<span class="sc">*</span>Fc[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n),<span class="st">&quot;max&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-43"><a href="ctlsc0x-supply-chain-analytics.html#cb185-43" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb185-44"><a href="ctlsc0x-supply-chain-analytics.html#cb185-44" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Attend all demand</span></span>
<span id="cb185-45"><a href="ctlsc0x-supply-chain-analytics.html#cb185-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>a[j,i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> RH[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">%&gt;%</span></span>
<span id="cb185-46"><a href="ctlsc0x-supply-chain-analytics.html#cb185-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb185-47"><a href="ctlsc0x-supply-chain-analytics.html#cb185-47" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Min quantity</span></span>
<span id="cb185-48"><a href="ctlsc0x-supply-chain-analytics.html#cb185-48" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_constraint</span>(x[i] <span class="sc">&gt;=</span> Min[i]<span class="sc">*</span>y[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb185-49"><a href="ctlsc0x-supply-chain-analytics.html#cb185-49" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb185-50"><a href="ctlsc0x-supply-chain-analytics.html#cb185-50" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Max quantity</span></span>
<span id="cb185-51"><a href="ctlsc0x-supply-chain-analytics.html#cb185-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_constraint</span>(x[i] <span class="sc">&lt;=</span> Max[i]<span class="sc">*</span>y[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb185-52"><a href="ctlsc0x-supply-chain-analytics.html#cb185-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-53"><a href="ctlsc0x-supply-chain-analytics.html#cb185-53" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb185-54"><a href="ctlsc0x-supply-chain-analytics.html#cb185-54" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb185-55"><a href="ctlsc0x-supply-chain-analytics.html#cb185-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-56"><a href="ctlsc0x-supply-chain-analytics.html#cb185-56" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Solution =</span> result<span class="sc">$</span>solution,</span>
<span id="cb185-57"><a href="ctlsc0x-supply-chain-analytics.html#cb185-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">Obj_Val =</span> result<span class="sc">$</span>objective_value))</span>
<span id="cb185-58"><a href="ctlsc0x-supply-chain-analytics.html#cb185-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-59"><a href="ctlsc0x-supply-chain-analytics.html#cb185-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb185-60"><a href="ctlsc0x-supply-chain-analytics.html#cb185-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-61"><a href="ctlsc0x-supply-chain-analytics.html#cb185-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-62"><a href="ctlsc0x-supply-chain-analytics.html#cb185-62" aria-hidden="true" tabindex="-1"></a><span class="fu">Model</span>(<span class="fu">c</span>(<span class="dv">325</span>,<span class="dv">400</span>))</span></code></pre></div>
<pre><code>## $Solution
## x[1] x[2] x[3] y[1] y[2] y[3] 
##    0   65    0    0    1    0 
## 
## $Obj_Val
## [1] 130</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="ctlsc0x-supply-chain-analytics.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Model</span>(<span class="at">RH =</span> <span class="fu">c</span>(<span class="dv">350</span>,<span class="dv">400</span>),<span class="at">Min =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">10</span>))</span></code></pre></div>
<pre><code>## $Solution
## x[1] x[2] x[3] y[1] y[2] y[3] 
##    0   70    0    0    1    0 
## 
## $Obj_Val
## [1] 140</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="ctlsc0x-supply-chain-analytics.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Model</span>(<span class="at">RH =</span> <span class="fu">c</span>(<span class="dv">350</span>,<span class="dv">400</span>),<span class="at">Min =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">10</span>), <span class="at">Max =</span> <span class="fu">c</span>(<span class="dv">40</span>,<span class="dv">40</span>,<span class="dv">40</span>))</span></code></pre></div>
<pre><code>## $Solution
## x[1] x[2] x[3] y[1] y[2] y[3] 
##    0   38   20    0    1    1 
## 
## $Obj_Val
## [1] 136</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="ctlsc0x-supply-chain-analytics.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Model</span>(<span class="at">RH =</span> <span class="fu">c</span>(<span class="dv">350</span>,<span class="dv">400</span>),<span class="at">Min =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">10</span>), <span class="at">Max =</span> <span class="fu">c</span>(<span class="dv">40</span>,<span class="dv">40</span>,<span class="dv">40</span>), <span class="at">Fc =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## $Solution
## x[1] x[2] x[3] y[1] y[2] y[3] 
##    0   38   20    0    1    1 
## 
## $Obj_Val
## [1] 130</code></pre>
</div>
<div id="transportation-problem-1" class="section level4" number="1.2.3.5">
<h4><span class="header-section-number">1.2.3.5</span> Transportation Problem</h4>
<p>Formulation already seen on Recitations</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="ctlsc0x-supply-chain-analytics.html#cb193-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">From =</span> <span class="fu">c</span>(<span class="st">&quot;Chicago&quot;</span>,<span class="st">&quot;Atlanta&quot;</span>,<span class="st">&quot;Denver&quot;</span>, <span class="st">&quot;Demand&quot;</span>),</span>
<span id="cb193-2"><a href="ctlsc0x-supply-chain-analytics.html#cb193-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Boston =</span> <span class="fu">c</span>(<span class="fl">1.04</span>,<span class="fl">1.23</span>,<span class="fl">1.92</span>,<span class="dv">11000</span>), <span class="at">Seattle =</span> <span class="fu">c</span>(<span class="fl">1.27</span>,<span class="fl">1.93</span>,<span class="fl">0.94</span>,<span class="dv">6300</span>),</span>
<span id="cb193-3"><a href="ctlsc0x-supply-chain-analytics.html#cb193-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Tampa =</span> <span class="fu">c</span>(<span class="fl">1.22</span>,<span class="fl">0.60</span>,<span class="fl">1.03</span>,<span class="dv">7400</span>), <span class="at">Supply =</span> <span class="fu">c</span>(<span class="dv">10000</span>,<span class="dv">10000</span>,<span class="dv">10000</span>, <span class="cn">NA</span>))</span>
<span id="cb193-4"><a href="ctlsc0x-supply-chain-analytics.html#cb193-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-5"><a href="ctlsc0x-supply-chain-analytics.html#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Transportation Problem&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-63">Table 1.26: </span>Transportation Problem
</caption>
<thead>
<tr>
<th style="text-align:left;">
From
</th>
<th style="text-align:right;">
Boston
</th>
<th style="text-align:right;">
Seattle
</th>
<th style="text-align:right;">
Tampa
</th>
<th style="text-align:right;">
Supply
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Chicago
</td>
<td style="text-align:right;">
1.04
</td>
<td style="text-align:right;">
1.27
</td>
<td style="text-align:right;">
1.22
</td>
<td style="text-align:right;">
10000
</td>
</tr>
<tr>
<td style="text-align:left;">
Atlanta
</td>
<td style="text-align:right;">
1.23
</td>
<td style="text-align:right;">
1.93
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
10000
</td>
</tr>
<tr>
<td style="text-align:left;">
Denver
</td>
<td style="text-align:right;">
1.92
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;">
1.03
</td>
<td style="text-align:right;">
10000
</td>
</tr>
<tr>
<td style="text-align:left;">
Demand
</td>
<td style="text-align:right;">
11000.00
</td>
<td style="text-align:right;">
6300.00
</td>
<td style="text-align:right;">
7400.00
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="ctlsc0x-supply-chain-analytics.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb194-2"><a href="ctlsc0x-supply-chain-analytics.html#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="ctlsc0x-supply-chain-analytics.html#cb194-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of Plants</span></span>
<span id="cb194-4"><a href="ctlsc0x-supply-chain-analytics.html#cb194-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">3</span> <span class="co">#Number of cities</span></span>
<span id="cb194-5"><a href="ctlsc0x-supply-chain-analytics.html#cb194-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-6"><a href="ctlsc0x-supply-chain-analytics.html#cb194-6" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb194-7"><a href="ctlsc0x-supply-chain-analytics.html#cb194-7" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb194-8"><a href="ctlsc0x-supply-chain-analytics.html#cb194-8" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span>])</span>
<span id="cb194-9"><a href="ctlsc0x-supply-chain-analytics.html#cb194-9" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="dv">4</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb194-10"><a href="ctlsc0x-supply-chain-analytics.html#cb194-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-11"><a href="ctlsc0x-supply-chain-analytics.html#cb194-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-12"><a href="ctlsc0x-supply-chain-analytics.html#cb194-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb194-13"><a href="ctlsc0x-supply-chain-analytics.html#cb194-13" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb194-14"><a href="ctlsc0x-supply-chain-analytics.html#cb194-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of production</span></span>
<span id="cb194-15"><a href="ctlsc0x-supply-chain-analytics.html#cb194-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-16"><a href="ctlsc0x-supply-chain-analytics.html#cb194-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-17"><a href="ctlsc0x-supply-chain-analytics.html#cb194-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># maximize profit</span></span>
<span id="cb194-18"><a href="ctlsc0x-supply-chain-analytics.html#cb194-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i,j]<span class="sc">*</span>c[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m), <span class="st">&quot;min&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-19"><a href="ctlsc0x-supply-chain-analytics.html#cb194-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-20"><a href="ctlsc0x-supply-chain-analytics.html#cb194-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb194-21"><a href="ctlsc0x-supply-chain-analytics.html#cb194-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&gt;=</span> D[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">%&gt;%</span></span>
<span id="cb194-22"><a href="ctlsc0x-supply-chain-analytics.html#cb194-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb194-23"><a href="ctlsc0x-supply-chain-analytics.html#cb194-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Flow Constraint</span></span>
<span id="cb194-24"><a href="ctlsc0x-supply-chain-analytics.html#cb194-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">&lt;=</span> S[i],  <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb194-25"><a href="ctlsc0x-supply-chain-analytics.html#cb194-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-26"><a href="ctlsc0x-supply-chain-analytics.html#cb194-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-27"><a href="ctlsc0x-supply-chain-analytics.html#cb194-27" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb194-28"><a href="ctlsc0x-supply-chain-analytics.html#cb194-28" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb194-29"><a href="ctlsc0x-supply-chain-analytics.html#cb194-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-30"><a href="ctlsc0x-supply-chain-analytics.html#cb194-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-31"><a href="ctlsc0x-supply-chain-analytics.html#cb194-31" aria-hidden="true" tabindex="-1"></a><span class="co">#result solution</span></span>
<span id="cb194-32"><a href="ctlsc0x-supply-chain-analytics.html#cb194-32" aria-hidden="true" tabindex="-1"></a>Result <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data[<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">1</span>],</span>
<span id="cb194-33"><a href="ctlsc0x-supply-chain-analytics.html#cb194-33" aria-hidden="true" tabindex="-1"></a>                <span class="fu">matrix</span>(result<span class="sc">$</span>solution, <span class="at">nrow =</span> n, <span class="at">ncol =</span> m,</span>
<span id="cb194-34"><a href="ctlsc0x-supply-chain-analytics.html#cb194-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">colnames</span>(data[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])))) <span class="sc">%&gt;%</span></span>
<span id="cb194-35"><a href="ctlsc0x-supply-chain-analytics.html#cb194-35" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">Supplied =</span> <span class="fu">colSums</span>(data[<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]), <span class="at">Supply =</span> data<span class="sc">$</span>Supply[<span class="dv">1</span><span class="sc">:</span>n]) <span class="sc">%&gt;%</span></span>
<span id="cb194-36"><a href="ctlsc0x-supply-chain-analytics.html#cb194-36" aria-hidden="true" tabindex="-1"></a>          <span class="fu">bind_rows</span>(<span class="fu">summarise_all</span>(., <span class="fu">funs</span>(<span class="cf">if</span>(<span class="fu">is.numeric</span>(.)) <span class="fu">sum</span>(.) <span class="cf">else</span> <span class="st">&quot;Total&quot;</span>)))</span>
<span id="cb194-37"><a href="ctlsc0x-supply-chain-analytics.html#cb194-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-38"><a href="ctlsc0x-supply-chain-analytics.html#cb194-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-39"><a href="ctlsc0x-supply-chain-analytics.html#cb194-39" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Result, <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Optimal Value: &quot;</span>, result<span class="sc">$</span>objective_value))</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-64">Table 1.27: </span>Optimal Value: 21992
</caption>
<thead>
<tr>
<th style="text-align:left;">
From
</th>
<th style="text-align:right;">
Boston
</th>
<th style="text-align:right;">
Seattle
</th>
<th style="text-align:right;">
Tampa
</th>
<th style="text-align:right;">
Supplied
</th>
<th style="text-align:right;">
Supply
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Chicago
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4.19
</td>
<td style="text-align:right;">
10000
</td>
</tr>
<tr>
<td style="text-align:left;">
Atlanta
</td>
<td style="text-align:right;">
1000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7400
</td>
<td style="text-align:right;">
4.14
</td>
<td style="text-align:right;">
10000
</td>
</tr>
<tr>
<td style="text-align:left;">
Denver
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6300
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2.85
</td>
<td style="text-align:right;">
10000
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:right;">
11000
</td>
<td style="text-align:right;">
6300
</td>
<td style="text-align:right;">
7400
</td>
<td style="text-align:right;">
11.18
</td>
<td style="text-align:right;">
30000
</td>
</tr>
</tbody>
</table>
</div>
<div id="transshipment-problem" class="section level4" number="1.2.3.6">
<h4><span class="header-section-number">1.2.3.6</span> Transshipment Problem</h4>
<p>Exercise exactly the same as the one on Recitations</p>
</div>
<div id="facility-problem" class="section level4" number="1.2.3.7">
<h4><span class="header-section-number">1.2.3.7</span> Facility Problem</h4>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Minimize} &amp; \ z = \sum_{i=1}^{N} \sum_{j=1}^{M} c_{i} \cdot x_{i} \\
                          
\textbf{subject to} \\
    &amp; \sum_{i=1}^{N} x_i = 2 \\
    &amp; x_{i} \ge 0, \ x \in \mathbb{B} \\
    
\textbf{Where} \\

&amp; i = \text{Type of Plant in N} \\
&amp; x_{i} = \text{Binary decision} \\
&amp; c_i = \text{Cost to transport materials} \\

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="ctlsc0x-supply-chain-analytics.html#cb195-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Type =</span> <span class="fu">c</span>(<span class="st">&quot;WH1&quot;</span>,<span class="st">&quot;WH2&quot;</span>,<span class="st">&quot;WH3&quot;</span>,<span class="st">&quot;WH4&quot;</span>,<span class="st">&quot;WH5&quot;</span>),</span>
<span id="cb195-2"><a href="ctlsc0x-supply-chain-analytics.html#cb195-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Total_cost =</span> <span class="fu">c</span>(<span class="dv">116200</span>,<span class="dv">98400</span>,<span class="dv">107800</span>,<span class="dv">86000</span>,<span class="dv">104800</span>))</span>
<span id="cb195-3"><a href="ctlsc0x-supply-chain-analytics.html#cb195-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-4"><a href="ctlsc0x-supply-chain-analytics.html#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Facility Problem&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-65">Table 1.28: </span>Facility Problem
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Total_cost
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
WH1
</td>
<td style="text-align:right;">
116200
</td>
</tr>
<tr>
<td style="text-align:left;">
WH2
</td>
<td style="text-align:right;">
98400
</td>
</tr>
<tr>
<td style="text-align:left;">
WH3
</td>
<td style="text-align:right;">
107800
</td>
</tr>
<tr>
<td style="text-align:left;">
WH4
</td>
<td style="text-align:right;">
86000
</td>
</tr>
<tr>
<td style="text-align:left;">
WH5
</td>
<td style="text-align:right;">
104800
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="ctlsc0x-supply-chain-analytics.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x)</span>
<span id="cb196-2"><a href="ctlsc0x-supply-chain-analytics.html#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="ctlsc0x-supply-chain-analytics.html#cb196-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">5</span> <span class="co">#Number of WH</span></span>
<span id="cb196-4"><a href="ctlsc0x-supply-chain-analytics.html#cb196-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-5"><a href="ctlsc0x-supply-chain-analytics.html#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="co">#subsetting data to R</span></span>
<span id="cb196-6"><a href="ctlsc0x-supply-chain-analytics.html#cb196-6" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fu">as.matrix</span>(data[,<span class="dv">2</span>])</span>
<span id="cb196-7"><a href="ctlsc0x-supply-chain-analytics.html#cb196-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-8"><a href="ctlsc0x-supply-chain-analytics.html#cb196-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-9"><a href="ctlsc0x-supply-chain-analytics.html#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb196-10"><a href="ctlsc0x-supply-chain-analytics.html#cb196-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb196-11"><a href="ctlsc0x-supply-chain-analytics.html#cb196-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-12"><a href="ctlsc0x-supply-chain-analytics.html#cb196-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Variable of production</span></span>
<span id="cb196-13"><a href="ctlsc0x-supply-chain-analytics.html#cb196-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_variable</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">type =</span> <span class="st">&quot;binary&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb196-14"><a href="ctlsc0x-supply-chain-analytics.html#cb196-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb196-15"><a href="ctlsc0x-supply-chain-analytics.html#cb196-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># maximize profit</span></span>
<span id="cb196-16"><a href="ctlsc0x-supply-chain-analytics.html#cb196-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i]<span class="sc">*</span>c[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n), <span class="st">&quot;min&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb196-17"><a href="ctlsc0x-supply-chain-analytics.html#cb196-17" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb196-18"><a href="ctlsc0x-supply-chain-analytics.html#cb196-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Open only 2 WH</span></span>
<span id="cb196-19"><a href="ctlsc0x-supply-chain-analytics.html#cb196-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb196-20"><a href="ctlsc0x-supply-chain-analytics.html#cb196-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-21"><a href="ctlsc0x-supply-chain-analytics.html#cb196-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb196-22"><a href="ctlsc0x-supply-chain-analytics.html#cb196-22" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>))</span>
<span id="cb196-23"><a href="ctlsc0x-supply-chain-analytics.html#cb196-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-24"><a href="ctlsc0x-supply-chain-analytics.html#cb196-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-25"><a href="ctlsc0x-supply-chain-analytics.html#cb196-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Results</span></span>
<span id="cb196-26"><a href="ctlsc0x-supply-chain-analytics.html#cb196-26" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>objective_value</span></code></pre></div>
<pre><code>## [1] 184400</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="ctlsc0x-supply-chain-analytics.html#cb198-1" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>solution<span class="do">### Transhipment Problem</span></span></code></pre></div>
<pre><code>## x[1] x[2] x[3] x[4] x[5] 
##    0    1    0    1    0</code></pre>
<p>This problem was called as facilty location problem, but the problem is mainly based on transhipment without CD capacity, so the lowest total cost CD will be choosen</p>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Minimize} &amp; \ z = \sum_{i=1}^{M} \sum_{i=1}^{N} c_{i,j} \cdot x_{i,j} +
                          \sum_{j=1}^{N} \sum_{k=1}^{K} c_{j,k} \cdot x_{j,k}  + 
                          \sum_{i=1}^{N} y_j \cdot f_y \\
                          
\textbf{subject to} \\
    &amp; \sum_{i=1}^{M} x_{i,j} \le S_i, \ \ j \forall M \\
    &amp; \sum_{i=1}^{N} x_{j,k} \ge D_j, \ \ k \forall K \\
    &amp; \sum_{i=1}^{N} x_{i,j} \le T_j, \ \ j \forall M \\
    &amp; \sum_{i=1}^{N} x_{i,j} - \sum_{j=1}^{M} x_{j,k}  = 0, \ \ k \forall K \\
    &amp; x_{i,j,k} \ge 0, \ x \in \mathbb{Z} \\
    
\textbf{Where} \\

&amp; i = \text{Type of Plant in N} \\
&amp; j = \text{Transhipment in M} \\
&amp; k = \text{Demand in K} \\
&amp; c_{i,j} = \text{Inflow Transportation cost} \\
&amp; c_{j,k} = \text{Outflow Transportation cost} \\
&amp; x_{i,j} = \text{inflow of product} \\
&amp; x_{j,k} = \text{Outflow of product} \\
&amp; D_k = \text{Demand of cities} \\
&amp; S_i = \text{Plant Capacity} \\
&amp; T_j = \text{Transhipment Capacity}

\end{align*}\]</span>
$$</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="ctlsc0x-supply-chain-analytics.html#cb200-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> WH_Cst <span class="sc">%&gt;%</span></span>
<span id="cb200-2"><a href="ctlsc0x-supply-chain-analytics.html#cb200-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">inner_join</span>(INB_Cost, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;OUT tsp&quot;</span> <span class="ot">=</span> <span class="st">&quot;INB tsp&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb200-3"><a href="ctlsc0x-supply-chain-analytics.html#cb200-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">inner_join</span>(Out_cost, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;OUT tsp&quot;</span> <span class="ot">=</span> <span class="st">&quot;OUT tsp&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb200-4"><a href="ctlsc0x-supply-chain-analytics.html#cb200-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">bind_rows</span>(Demand) <span class="sc">%&gt;%</span></span>
<span id="cb200-5"><a href="ctlsc0x-supply-chain-analytics.html#cb200-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="st">`</span><span class="at">OUT tsp</span><span class="st">`</span><span class="ot">=</span><span class="fu">replace</span>(<span class="st">`</span><span class="at">OUT tsp</span><span class="st">`</span>, <span class="fu">is.na</span>(<span class="st">`</span><span class="at">OUT tsp</span><span class="st">`</span>), <span class="st">&quot;Demand&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb200-6"><a href="ctlsc0x-supply-chain-analytics.html#cb200-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rename</span>(<span class="st">&quot;Type&quot;</span> <span class="ot">=</span> <span class="st">`</span><span class="at">OUT tsp</span><span class="st">`</span>)</span>
<span id="cb200-7"><a href="ctlsc0x-supply-chain-analytics.html#cb200-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-8"><a href="ctlsc0x-supply-chain-analytics.html#cb200-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(INB_Cost,OUT,WH_Cst,Out_cost,Demand)</span>
<span id="cb200-9"><a href="ctlsc0x-supply-chain-analytics.html#cb200-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-10"><a href="ctlsc0x-supply-chain-analytics.html#cb200-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(data, <span class="at">caption =</span> <span class="st">&quot;Facility Location Problem&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb200-11"><a href="ctlsc0x-supply-chain-analytics.html#cb200-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span></span>
<span id="cb200-12"><a href="ctlsc0x-supply-chain-analytics.html#cb200-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-68">Table 1.29: </span>Facility Location Problem
</caption>
<thead>
<tr>
<th style="text-align:left;">
Type
</th>
<th style="text-align:right;">
Variable costs
</th>
<th style="text-align:right;">
Fixed costs
</th>
<th style="text-align:right;">
Plant 1
</th>
<th style="text-align:right;">
Plant 2
</th>
<th style="text-align:right;">
RW 1
</th>
<th style="text-align:right;">
RW 2
</th>
<th style="text-align:right;">
RW 3
</th>
<th style="text-align:right;">
RW 4
</th>
<th style="text-align:right;">
RW 5
</th>
<th style="text-align:right;">
RW 6
</th>
<th style="text-align:right;">
RW 7
</th>
<th style="text-align:right;">
RW 8
</th>
<th style="text-align:right;">
RW 9
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
CW 1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
100000
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
89
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
88
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
86
</td>
</tr>
<tr>
<td style="text-align:left;">
CW 2
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
90000
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
89
</td>
<td style="text-align:right;">
90
</td>
<td style="text-align:right;">
55
</td>
</tr>
<tr>
<td style="text-align:left;">
CW 3
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
80000
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
72
</td>
</tr>
<tr>
<td style="text-align:left;">
CW 4
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
70000
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
86
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
59
</td>
</tr>
<tr>
<td style="text-align:left;">
CW 5
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
60000
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
Demand
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
180
</td>
<td style="text-align:right;">
240
</td>
<td style="text-align:right;">
210
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
320
</td>
<td style="text-align:right;">
280
</td>
<td style="text-align:right;">
160
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="ctlsc0x-supply-chain-analytics.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Plant_Cst, <span class="at">caption =</span> <span class="st">&quot;Plant Cost&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-68">Table 1.29: </span>Plant Cost
</caption>
<thead>
<tr>
<th style="text-align:left;">
Plant
</th>
<th style="text-align:right;">
Variable costs
</th>
<th style="text-align:right;">
Capacity
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Plant 1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1500
</td>
</tr>
<tr>
<td style="text-align:left;">
Plant 2
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
500
</td>
</tr>
</tbody>
</table>
<p>Let’s set the data organized for this model, this could’ve been done before easily when the data was stratified, but it will be cool to learn a bit more of data wrangling</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="ctlsc0x-supply-chain-analytics.html#cb202-1" aria-hidden="true" tabindex="-1"></a>Plants <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;Plant*&quot;</span>, <span class="fu">names</span>(data), <span class="at">value =</span> T)</span>
<span id="cb202-2"><a href="ctlsc0x-supply-chain-analytics.html#cb202-2" aria-hidden="true" tabindex="-1"></a>Demand <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;RW*&quot;</span>, <span class="fu">names</span>(data), <span class="at">value =</span> T)</span>
<span id="cb202-3"><a href="ctlsc0x-supply-chain-analytics.html#cb202-3" aria-hidden="true" tabindex="-1"></a>CD <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;CW*&quot;</span>, data<span class="sc">$</span>Type, <span class="at">value =</span> T)</span>
<span id="cb202-4"><a href="ctlsc0x-supply-chain-analytics.html#cb202-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-5"><a href="ctlsc0x-supply-chain-analytics.html#cb202-5" aria-hidden="true" tabindex="-1"></a>var_Dc <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">as.matrix</span>(data[<span class="fu">complete.cases</span>(data),<span class="st">&quot;Variable costs&quot;</span>]))</span>
<span id="cb202-6"><a href="ctlsc0x-supply-chain-analytics.html#cb202-6" aria-hidden="true" tabindex="-1"></a>var_Pc <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Plant_Cst<span class="sc">$</span><span class="st">`</span><span class="at">Variable costs</span><span class="st">`</span>)</span>
<span id="cb202-7"><a href="ctlsc0x-supply-chain-analytics.html#cb202-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-8"><a href="ctlsc0x-supply-chain-analytics.html#cb202-8" aria-hidden="true" tabindex="-1"></a><span class="co"># inc &lt;- t(as.matrix(data[complete.cases(data),Plants])) * var_Dc</span></span>
<span id="cb202-9"><a href="ctlsc0x-supply-chain-analytics.html#cb202-9" aria-hidden="true" tabindex="-1"></a><span class="co"># outc &lt;- as.matrix(data[data$Type %in% CD,Demand]) * var_Dc</span></span>
<span id="cb202-10"><a href="ctlsc0x-supply-chain-analytics.html#cb202-10" aria-hidden="true" tabindex="-1"></a>inc <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(data[<span class="fu">complete.cases</span>(data),Plants]))</span>
<span id="cb202-11"><a href="ctlsc0x-supply-chain-analytics.html#cb202-11" aria-hidden="true" tabindex="-1"></a>outc <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[data<span class="sc">$</span>Type <span class="sc">%in%</span> CD,Demand])</span>
<span id="cb202-12"><a href="ctlsc0x-supply-chain-analytics.html#cb202-12" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Plant_Cst<span class="sc">$</span>Capacity)</span>
<span id="cb202-13"><a href="ctlsc0x-supply-chain-analytics.html#cb202-13" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[data<span class="sc">$</span>Type <span class="sc">%in%</span> <span class="st">&quot;Demand&quot;</span>,Demand])</span>
<span id="cb202-14"><a href="ctlsc0x-supply-chain-analytics.html#cb202-14" aria-hidden="true" tabindex="-1"></a>Fc <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[<span class="fu">complete.cases</span>(data),<span class="st">&quot;Fixed costs&quot;</span>])</span>
<span id="cb202-15"><a href="ctlsc0x-supply-chain-analytics.html#cb202-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-16"><a href="ctlsc0x-supply-chain-analytics.html#cb202-16" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">sum</span>(D)<span class="sc">*</span><span class="dv">5</span> <span class="co">#Big Number for flow constraint</span></span></code></pre></div>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="ctlsc0x-supply-chain-analytics.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(x,u,z)</span>
<span id="cb203-2"><a href="ctlsc0x-supply-chain-analytics.html#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="ctlsc0x-supply-chain-analytics.html#cb203-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(Plants) <span class="co">#Number of Plants</span></span>
<span id="cb203-4"><a href="ctlsc0x-supply-chain-analytics.html#cb203-4" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fu">length</span>(CD) <span class="co">#Number of transhipments (CDs)</span></span>
<span id="cb203-5"><a href="ctlsc0x-supply-chain-analytics.html#cb203-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">length</span>(Demand) <span class="co">#Number of cities (POS)</span></span>
<span id="cb203-6"><a href="ctlsc0x-supply-chain-analytics.html#cb203-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-7"><a href="ctlsc0x-supply-chain-analytics.html#cb203-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Get back to model</span></span>
<span id="cb203-8"><a href="ctlsc0x-supply-chain-analytics.html#cb203-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">MIPModel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb203-9"><a href="ctlsc0x-supply-chain-analytics.html#cb203-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb203-10"><a href="ctlsc0x-supply-chain-analytics.html#cb203-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of inflow</span></span>
<span id="cb203-11"><a href="ctlsc0x-supply-chain-analytics.html#cb203-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb203-12"><a href="ctlsc0x-supply-chain-analytics.html#cb203-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb203-13"><a href="ctlsc0x-supply-chain-analytics.html#cb203-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variable of outflow</span></span>
<span id="cb203-14"><a href="ctlsc0x-supply-chain-analytics.html#cb203-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(u[j,k], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t, <span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>m, <span class="at">type =</span> <span class="st">&quot;integer&quot;</span>, <span class="at">lb =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb203-15"><a href="ctlsc0x-supply-chain-analytics.html#cb203-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb203-16"><a href="ctlsc0x-supply-chain-analytics.html#cb203-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Variable of DC to incur a fixed cost</span></span>
<span id="cb203-17"><a href="ctlsc0x-supply-chain-analytics.html#cb203-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_variable</span>(z[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t, <span class="at">type =</span> <span class="st">&quot;binary&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb203-18"><a href="ctlsc0x-supply-chain-analytics.html#cb203-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-19"><a href="ctlsc0x-supply-chain-analytics.html#cb203-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># minimize total cost</span></span>
<span id="cb203-20"><a href="ctlsc0x-supply-chain-analytics.html#cb203-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_objective</span>(<span class="fu">sum_expr</span>(x[i,j] <span class="sc">*</span> inc[i,j],  <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t) <span class="sc">+</span>  <span class="co">#Inbound Distance cost</span></span>
<span id="cb203-21"><a href="ctlsc0x-supply-chain-analytics.html#cb203-21" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sum_expr</span>(u[j,k] <span class="sc">*</span> outc[j,k], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t, <span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">+</span>  <span class="co">#Outbound Distance cost</span></span>
<span id="cb203-22"><a href="ctlsc0x-supply-chain-analytics.html#cb203-22" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sum_expr</span>(x[i,j] <span class="sc">*</span> var_Dc[j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t) <span class="sc">+</span>  <span class="co">#DC variable cost</span></span>
<span id="cb203-23"><a href="ctlsc0x-supply-chain-analytics.html#cb203-23" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sum_expr</span>(x[i,j] <span class="sc">*</span> var_Pc[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t) <span class="sc">+</span>  <span class="co">#Plant variable cost</span></span>
<span id="cb203-24"><a href="ctlsc0x-supply-chain-analytics.html#cb203-24" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sum_expr</span>(z[j] <span class="sc">*</span> Fc[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t), <span class="st">&quot;min&quot;</span>) <span class="sc">%&gt;%</span>       <span class="co">#Plant Fixed cost</span></span>
<span id="cb203-25"><a href="ctlsc0x-supply-chain-analytics.html#cb203-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb203-26"><a href="ctlsc0x-supply-chain-analytics.html#cb203-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Plant Capacity</span></span>
<span id="cb203-27"><a href="ctlsc0x-supply-chain-analytics.html#cb203-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t) <span class="sc">&lt;=</span> S[i], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">%&gt;%</span></span>
<span id="cb203-28"><a href="ctlsc0x-supply-chain-analytics.html#cb203-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb203-29"><a href="ctlsc0x-supply-chain-analytics.html#cb203-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Attend all demand</span></span>
<span id="cb203-30"><a href="ctlsc0x-supply-chain-analytics.html#cb203-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(u[j,k], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t) <span class="sc">&gt;=</span> D[k], <span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">%&gt;%</span></span>
<span id="cb203-31"><a href="ctlsc0x-supply-chain-analytics.html#cb203-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb203-32"><a href="ctlsc0x-supply-chain-analytics.html#cb203-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Binary flow constraint</span></span>
<span id="cb203-33"><a href="ctlsc0x-supply-chain-analytics.html#cb203-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">&lt;=</span> z[j]<span class="sc">*</span>M, <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t) <span class="sc">%&gt;%</span></span>
<span id="cb203-34"><a href="ctlsc0x-supply-chain-analytics.html#cb203-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb203-35"><a href="ctlsc0x-supply-chain-analytics.html#cb203-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Only one DC</span></span>
<span id="cb203-36"><a href="ctlsc0x-supply-chain-analytics.html#cb203-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(z[j], <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t) <span class="sc">&lt;=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb203-37"><a href="ctlsc0x-supply-chain-analytics.html#cb203-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb203-38"><a href="ctlsc0x-supply-chain-analytics.html#cb203-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Flow constraint</span></span>
<span id="cb203-39"><a href="ctlsc0x-supply-chain-analytics.html#cb203-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_constraint</span>(<span class="fu">sum_expr</span>(x[i,j], <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>n) <span class="sc">-</span> <span class="fu">sum_expr</span>(u[j,k], <span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span>m) <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb203-40"><a href="ctlsc0x-supply-chain-analytics.html#cb203-40" aria-hidden="true" tabindex="-1"></a>                 <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>t)</span>
<span id="cb203-41"><a href="ctlsc0x-supply-chain-analytics.html#cb203-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-42"><a href="ctlsc0x-supply-chain-analytics.html#cb203-42" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve</span></span>
<span id="cb203-43"><a href="ctlsc0x-supply-chain-analytics.html#cb203-43" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">solve_model</span>(model, <span class="fu">with_ROI</span>(<span class="at">solver =</span> <span class="st">&quot;glpk&quot;</span>))</span>
<span id="cb203-44"><a href="ctlsc0x-supply-chain-analytics.html#cb203-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-45"><a href="ctlsc0x-supply-chain-analytics.html#cb203-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-46"><a href="ctlsc0x-supply-chain-analytics.html#cb203-46" aria-hidden="true" tabindex="-1"></a><span class="co"># #Which central warehouse minimizes all cost?</span></span>
<span id="cb203-47"><a href="ctlsc0x-supply-chain-analytics.html#cb203-47" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">matrix</span>(<span class="fu">get_solution</span>(result, x[i,j])<span class="sc">$</span>value, <span class="at">nrow =</span> n, <span class="at">ncol =</span> n, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>,Plants)))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
Plant 1
</th>
<th style="text-align:right;">
Plant 2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1335
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
500
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="ctlsc0x-supply-chain-analytics.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">matrix</span>(<span class="fu">get_solution</span>(result, u[j,k])<span class="sc">$</span>value, <span class="at">nrow =</span> t, <span class="at">ncol =</span> m, <span class="at">dimnames =</span> <span class="fu">list</span>(CD,Demand)),</span>
<span id="cb204-2"><a href="ctlsc0x-supply-chain-analytics.html#cb204-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="fu">paste0</span>(<span class="st">&quot;Optimal Value: &quot;</span>, result<span class="sc">$</span>objective_value))</span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-70">Table 1.30: </span>Optimal Value: 349490
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
RW 1
</th>
<th style="text-align:right;">
RW 2
</th>
<th style="text-align:right;">
RW 3
</th>
<th style="text-align:right;">
RW 4
</th>
<th style="text-align:right;">
RW 5
</th>
<th style="text-align:right;">
RW 6
</th>
<th style="text-align:right;">
RW 7
</th>
<th style="text-align:right;">
RW 8
</th>
<th style="text-align:right;">
RW 9
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
CW 1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
CW 2
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
180
</td>
<td style="text-align:right;">
240
</td>
<td style="text-align:right;">
210
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
320
</td>
<td style="text-align:right;">
280
</td>
<td style="text-align:right;">
160
</td>
</tr>
<tr>
<td style="text-align:left;">
CW 3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
CW 4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
CW 5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="week4---algorithms-approximations" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Week4 - Algorithms &amp; Approximations</h2>
<div id="lesson-1---algorithms" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Lesson 1 - Algorithms</h3>
<div id="shortest-path-problem" class="section level4" number="1.3.1.1">
<h4><span class="header-section-number">1.3.1.1</span> Shortest Path Problem</h4>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="ctlsc0x-supply-chain-analytics.html#cb205-1" aria-hidden="true" tabindex="-1"></a>Relations <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb205-2"><a href="ctlsc0x-supply-chain-analytics.html#cb205-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="st">&quot;</span></span>
<span id="cb205-3"><a href="ctlsc0x-supply-chain-analytics.html#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="st">From To weight</span></span>
<span id="cb205-4"><a href="ctlsc0x-supply-chain-analytics.html#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="st">SL CH 300</span></span>
<span id="cb205-5"><a href="ctlsc0x-supply-chain-analytics.html#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="st">SL IN 245</span></span>
<span id="cb205-6"><a href="ctlsc0x-supply-chain-analytics.html#cb205-6" aria-hidden="true" tabindex="-1"></a><span class="st">SL LV 263</span></span>
<span id="cb205-7"><a href="ctlsc0x-supply-chain-analytics.html#cb205-7" aria-hidden="true" tabindex="-1"></a><span class="st">SL NV 312</span></span>
<span id="cb205-8"><a href="ctlsc0x-supply-chain-analytics.html#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="st">CH CL 362</span></span>
<span id="cb205-9"><a href="ctlsc0x-supply-chain-analytics.html#cb205-9" aria-hidden="true" tabindex="-1"></a><span class="st">CH IN 201</span></span>
<span id="cb205-10"><a href="ctlsc0x-supply-chain-analytics.html#cb205-10" aria-hidden="true" tabindex="-1"></a><span class="st">IN CO 176</span></span>
<span id="cb205-11"><a href="ctlsc0x-supply-chain-analytics.html#cb205-11" aria-hidden="true" tabindex="-1"></a><span class="st">IN CI 112</span></span>
<span id="cb205-12"><a href="ctlsc0x-supply-chain-analytics.html#cb205-12" aria-hidden="true" tabindex="-1"></a><span class="st">IN LV 114</span></span>
<span id="cb205-13"><a href="ctlsc0x-supply-chain-analytics.html#cb205-13" aria-hidden="true" tabindex="-1"></a><span class="st">LV LX 86</span></span>
<span id="cb205-14"><a href="ctlsc0x-supply-chain-analytics.html#cb205-14" aria-hidden="true" tabindex="-1"></a><span class="st">LV NV 175</span></span>
<span id="cb205-15"><a href="ctlsc0x-supply-chain-analytics.html#cb205-15" aria-hidden="true" tabindex="-1"></a><span class="st">CL CO 142</span></span>
<span id="cb205-16"><a href="ctlsc0x-supply-chain-analytics.html#cb205-16" aria-hidden="true" tabindex="-1"></a><span class="st">CL HB 322</span></span>
<span id="cb205-17"><a href="ctlsc0x-supply-chain-analytics.html#cb205-17" aria-hidden="true" tabindex="-1"></a><span class="st">CL MT 201</span></span>
<span id="cb205-18"><a href="ctlsc0x-supply-chain-analytics.html#cb205-18" aria-hidden="true" tabindex="-1"></a><span class="st">CL CN 251</span></span>
<span id="cb205-19"><a href="ctlsc0x-supply-chain-analytics.html#cb205-19" aria-hidden="true" tabindex="-1"></a><span class="st">CO CI 105</span></span>
<span id="cb205-20"><a href="ctlsc0x-supply-chain-analytics.html#cb205-20" aria-hidden="true" tabindex="-1"></a><span class="st">CI LX 95</span></span>
<span id="cb205-21"><a href="ctlsc0x-supply-chain-analytics.html#cb205-21" aria-hidden="true" tabindex="-1"></a><span class="st">CI CN 204</span></span>
<span id="cb205-22"><a href="ctlsc0x-supply-chain-analytics.html#cb205-22" aria-hidden="true" tabindex="-1"></a><span class="st">LX CN 177</span></span>
<span id="cb205-23"><a href="ctlsc0x-supply-chain-analytics.html#cb205-23" aria-hidden="true" tabindex="-1"></a><span class="st">LX KV 170</span></span>
<span id="cb205-24"><a href="ctlsc0x-supply-chain-analytics.html#cb205-24" aria-hidden="true" tabindex="-1"></a><span class="st">KV GR 299</span></span>
<span id="cb205-25"><a href="ctlsc0x-supply-chain-analytics.html#cb205-25" aria-hidden="true" tabindex="-1"></a><span class="st">CN MT 157</span></span>
<span id="cb205-26"><a href="ctlsc0x-supply-chain-analytics.html#cb205-26" aria-hidden="true" tabindex="-1"></a><span class="st">CN GR 244</span></span>
<span id="cb205-27"><a href="ctlsc0x-supply-chain-analytics.html#cb205-27" aria-hidden="true" tabindex="-1"></a><span class="st">CN RI 318</span></span>
<span id="cb205-28"><a href="ctlsc0x-supply-chain-analytics.html#cb205-28" aria-hidden="true" tabindex="-1"></a><span class="st">MT HB 213</span></span>
<span id="cb205-29"><a href="ctlsc0x-supply-chain-analytics.html#cb205-29" aria-hidden="true" tabindex="-1"></a><span class="st">MT WA 209</span></span>
<span id="cb205-30"><a href="ctlsc0x-supply-chain-analytics.html#cb205-30" aria-hidden="true" tabindex="-1"></a><span class="st">GR RI 205</span></span>
<span id="cb205-31"><a href="ctlsc0x-supply-chain-analytics.html#cb205-31" aria-hidden="true" tabindex="-1"></a><span class="st">HB WA 120</span></span>
<span id="cb205-32"><a href="ctlsc0x-supply-chain-analytics.html#cb205-32" aria-hidden="true" tabindex="-1"></a><span class="st">WA RI 111</span></span>
<span id="cb205-33"><a href="ctlsc0x-supply-chain-analytics.html#cb205-33" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>, <span class="at">header =</span>T)</span></code></pre></div>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="ctlsc0x-supply-chain-analytics.html#cb206-1" aria-hidden="true" tabindex="-1"></a>net <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(Relations, <span class="at">directed=</span>F)</span>
<span id="cb206-2"><a href="ctlsc0x-supply-chain-analytics.html#cb206-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-3"><a href="ctlsc0x-supply-chain-analytics.html#cb206-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-4"><a href="ctlsc0x-supply-chain-analytics.html#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO Erro no pacote</span></span>
<span id="cb206-5"><a href="ctlsc0x-supply-chain-analytics.html#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(net,vertex.label.cex = 0.8 , vertex.color=Relations$From, edge.label=Relations$weight,</span></span>
<span id="cb206-6"><a href="ctlsc0x-supply-chain-analytics.html#cb206-6" aria-hidden="true" tabindex="-1"></a><span class="co">#      edge.label.cex = 0.8, edge.color = &quot;gray70&quot;, edge.label.color = &quot;black&quot;)</span></span>
<span id="cb206-7"><a href="ctlsc0x-supply-chain-analytics.html#cb206-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-8"><a href="ctlsc0x-supply-chain-analytics.html#cb206-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-9"><a href="ctlsc0x-supply-chain-analytics.html#cb206-9" aria-hidden="true" tabindex="-1"></a><span class="co"># as_edgelist(net, names=T)</span></span>
<span id="cb206-10"><a href="ctlsc0x-supply-chain-analytics.html#cb206-10" aria-hidden="true" tabindex="-1"></a><span class="co"># as_adjacency_matrix(net, attr=&quot;weight&quot;)</span></span>
<span id="cb206-11"><a href="ctlsc0x-supply-chain-analytics.html#cb206-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb206-12"><a href="ctlsc0x-supply-chain-analytics.html#cb206-12" aria-hidden="true" tabindex="-1"></a><span class="co"># as_data_frame(net)</span></span>
<span id="cb206-13"><a href="ctlsc0x-supply-chain-analytics.html#cb206-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-14"><a href="ctlsc0x-supply-chain-analytics.html#cb206-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the degree distribution for our network:</span></span>
<span id="cb206-15"><a href="ctlsc0x-supply-chain-analytics.html#cb206-15" aria-hidden="true" tabindex="-1"></a>deg <span class="ot">&lt;-</span> <span class="fu">degree</span>(net, <span class="at">mode=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb206-16"><a href="ctlsc0x-supply-chain-analytics.html#cb206-16" aria-hidden="true" tabindex="-1"></a>deg.dist <span class="ot">&lt;-</span> <span class="fu">degree_distribution</span>(net, <span class="at">cumulative=</span>T, <span class="at">mode=</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb206-17"><a href="ctlsc0x-supply-chain-analytics.html#cb206-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(deg), <span class="at">y=</span><span class="dv">1</span><span class="sc">-</span>deg.dist, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, </span>
<span id="cb206-18"><a href="ctlsc0x-supply-chain-analytics.html#cb206-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab=</span><span class="st">&quot;Degree&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Cumulative Frequency&quot;</span>)</span></code></pre></div>
<p><img src="01-CTLSC0x_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="ctlsc0x-supply-chain-analytics.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Shortest Path</span></span>
<span id="cb207-2"><a href="ctlsc0x-supply-chain-analytics.html#cb207-2" aria-hidden="true" tabindex="-1"></a>sPath <span class="ot">&lt;-</span> <span class="cf">function</span>(net, from, to){</span>
<span id="cb207-3"><a href="ctlsc0x-supply-chain-analytics.html#cb207-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-4"><a href="ctlsc0x-supply-chain-analytics.html#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Function created based on https://kateto.net/tutorials/  </span></span>
<span id="cb207-5"><a href="ctlsc0x-supply-chain-analytics.html#cb207-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb207-6"><a href="ctlsc0x-supply-chain-analytics.html#cb207-6" aria-hidden="true" tabindex="-1"></a>Path <span class="ot">&lt;-</span> <span class="fu">shortest_paths</span>(net, <span class="at">from =</span> from, <span class="at">to =</span> to, <span class="at">weights =</span> <span class="fu">E</span>(net)<span class="sc">$</span>weight, <span class="at">output =</span> <span class="st">&quot;both&quot;</span>)</span>
<span id="cb207-7"><a href="ctlsc0x-supply-chain-analytics.html#cb207-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-8"><a href="ctlsc0x-supply-chain-analytics.html#cb207-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate edge color variable to plot the path:</span></span>
<span id="cb207-9"><a href="ctlsc0x-supply-chain-analytics.html#cb207-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-10"><a href="ctlsc0x-supply-chain-analytics.html#cb207-10" aria-hidden="true" tabindex="-1"></a>ecol <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;gray80&quot;</span>, <span class="fu">ecount</span>(net))</span>
<span id="cb207-11"><a href="ctlsc0x-supply-chain-analytics.html#cb207-11" aria-hidden="true" tabindex="-1"></a>ecol[<span class="fu">unlist</span>(Path<span class="sc">$</span>epath)] <span class="ot">&lt;-</span> <span class="st">&quot;orange&quot;</span></span>
<span id="cb207-12"><a href="ctlsc0x-supply-chain-analytics.html#cb207-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-13"><a href="ctlsc0x-supply-chain-analytics.html#cb207-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate edge width variable to plot the path:</span></span>
<span id="cb207-14"><a href="ctlsc0x-supply-chain-analytics.html#cb207-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-15"><a href="ctlsc0x-supply-chain-analytics.html#cb207-15" aria-hidden="true" tabindex="-1"></a>ew <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">2</span>, <span class="fu">ecount</span>(net))</span>
<span id="cb207-16"><a href="ctlsc0x-supply-chain-analytics.html#cb207-16" aria-hidden="true" tabindex="-1"></a>ew[<span class="fu">unlist</span>(Path<span class="sc">$</span>epath)] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb207-17"><a href="ctlsc0x-supply-chain-analytics.html#cb207-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-18"><a href="ctlsc0x-supply-chain-analytics.html#cb207-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate node color variable to plot the path:</span></span>
<span id="cb207-19"><a href="ctlsc0x-supply-chain-analytics.html#cb207-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-20"><a href="ctlsc0x-supply-chain-analytics.html#cb207-20" aria-hidden="true" tabindex="-1"></a>vcol <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;gray40&quot;</span>, <span class="fu">vcount</span>(net))</span>
<span id="cb207-21"><a href="ctlsc0x-supply-chain-analytics.html#cb207-21" aria-hidden="true" tabindex="-1"></a>vcol[<span class="fu">unlist</span>(Path<span class="sc">$</span>vpath)] <span class="ot">&lt;-</span> <span class="st">&quot;gold&quot;</span></span>
<span id="cb207-22"><a href="ctlsc0x-supply-chain-analytics.html#cb207-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-23"><a href="ctlsc0x-supply-chain-analytics.html#cb207-23" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb207-24"><a href="ctlsc0x-supply-chain-analytics.html#cb207-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-25"><a href="ctlsc0x-supply-chain-analytics.html#cb207-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(net, <span class="at">vertex.color=</span>vcol, <span class="at">edge.color=</span>ecol,</span>
<span id="cb207-26"><a href="ctlsc0x-supply-chain-analytics.html#cb207-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">edge.width=</span>ew, <span class="at">edge.arrow.mode=</span><span class="dv">0</span>)</span>
<span id="cb207-27"><a href="ctlsc0x-supply-chain-analytics.html#cb207-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-28"><a href="ctlsc0x-supply-chain-analytics.html#cb207-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb207-29"><a href="ctlsc0x-supply-chain-analytics.html#cb207-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-30"><a href="ctlsc0x-supply-chain-analytics.html#cb207-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-31"><a href="ctlsc0x-supply-chain-analytics.html#cb207-31" aria-hidden="true" tabindex="-1"></a><span class="fu">sPath</span>(net, <span class="at">from =</span> <span class="st">&quot;LV&quot;</span>, <span class="at">to =</span>  <span class="st">&quot;WA&quot;</span>)</span></code></pre></div>
<p><img src="01-CTLSC0x_files/figure-html/unnamed-chunk-72-2.png" width="672" /></p>
<p>All lowest distances from the model</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="ctlsc0x-supply-chain-analytics.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="do">## all vertices to all vertices</span></span>
<span id="cb208-2"><a href="ctlsc0x-supply-chain-analytics.html#cb208-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3"><a href="ctlsc0x-supply-chain-analytics.html#cb208-3" aria-hidden="true" tabindex="-1"></a>distMatrix <span class="ot">&lt;-</span> <span class="fu">shortest.paths</span>(net, <span class="at">v=</span><span class="fu">V</span>(net), <span class="at">to=</span><span class="fu">V</span>(net), <span class="at">weight =</span> net<span class="sc">$</span>weight)</span>
<span id="cb208-4"><a href="ctlsc0x-supply-chain-analytics.html#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(distMatrix, <span class="at">caption =</span> <span class="st">&quot;Lowest distance from node to node&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb208-5"><a href="ctlsc0x-supply-chain-analytics.html#cb208-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span></span>
<span id="cb208-6"><a href="ctlsc0x-supply-chain-analytics.html#cb208-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-73">Table 1.31: </span>Lowest distance from node to node
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
SL
</th>
<th style="text-align:right;">
CH
</th>
<th style="text-align:right;">
IN
</th>
<th style="text-align:right;">
LV
</th>
<th style="text-align:right;">
CL
</th>
<th style="text-align:right;">
CO
</th>
<th style="text-align:right;">
CI
</th>
<th style="text-align:right;">
LX
</th>
<th style="text-align:right;">
KV
</th>
<th style="text-align:right;">
CN
</th>
<th style="text-align:right;">
MT
</th>
<th style="text-align:right;">
GR
</th>
<th style="text-align:right;">
HB
</th>
<th style="text-align:right;">
WA
</th>
<th style="text-align:right;">
NV
</th>
<th style="text-align:right;">
RI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
SL
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
245
</td>
<td style="text-align:right;">
263
</td>
<td style="text-align:right;">
563
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
357
</td>
<td style="text-align:right;">
349
</td>
<td style="text-align:right;">
519
</td>
<td style="text-align:right;">
526
</td>
<td style="text-align:right;">
683
</td>
<td style="text-align:right;">
770
</td>
<td style="text-align:right;">
885
</td>
<td style="text-align:right;">
892
</td>
<td style="text-align:right;">
312
</td>
<td style="text-align:right;">
844
</td>
</tr>
<tr>
<td style="text-align:left;">
CH
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
315
</td>
<td style="text-align:right;">
362
</td>
<td style="text-align:right;">
377
</td>
<td style="text-align:right;">
313
</td>
<td style="text-align:right;">
401
</td>
<td style="text-align:right;">
571
</td>
<td style="text-align:right;">
517
</td>
<td style="text-align:right;">
563
</td>
<td style="text-align:right;">
761
</td>
<td style="text-align:right;">
684
</td>
<td style="text-align:right;">
772
</td>
<td style="text-align:right;">
490
</td>
<td style="text-align:right;">
835
</td>
</tr>
<tr>
<td style="text-align:left;">
IN
</td>
<td style="text-align:right;">
245
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
114
</td>
<td style="text-align:right;">
318
</td>
<td style="text-align:right;">
176
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
370
</td>
<td style="text-align:right;">
316
</td>
<td style="text-align:right;">
473
</td>
<td style="text-align:right;">
560
</td>
<td style="text-align:right;">
640
</td>
<td style="text-align:right;">
682
</td>
<td style="text-align:right;">
289
</td>
<td style="text-align:right;">
634
</td>
</tr>
<tr>
<td style="text-align:left;">
LV
</td>
<td style="text-align:right;">
263
</td>
<td style="text-align:right;">
315
</td>
<td style="text-align:right;">
114
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
428
</td>
<td style="text-align:right;">
286
</td>
<td style="text-align:right;">
181
</td>
<td style="text-align:right;">
86
</td>
<td style="text-align:right;">
256
</td>
<td style="text-align:right;">
263
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
507
</td>
<td style="text-align:right;">
633
</td>
<td style="text-align:right;">
629
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
581
</td>
</tr>
<tr>
<td style="text-align:left;">
CL
</td>
<td style="text-align:right;">
563
</td>
<td style="text-align:right;">
362
</td>
<td style="text-align:right;">
318
</td>
<td style="text-align:right;">
428
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
142
</td>
<td style="text-align:right;">
247
</td>
<td style="text-align:right;">
342
</td>
<td style="text-align:right;">
512
</td>
<td style="text-align:right;">
251
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
495
</td>
<td style="text-align:right;">
322
</td>
<td style="text-align:right;">
410
</td>
<td style="text-align:right;">
603
</td>
<td style="text-align:right;">
521
</td>
</tr>
<tr>
<td style="text-align:left;">
CO
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
377
</td>
<td style="text-align:right;">
176
</td>
<td style="text-align:right;">
286
</td>
<td style="text-align:right;">
142
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
370
</td>
<td style="text-align:right;">
309
</td>
<td style="text-align:right;">
343
</td>
<td style="text-align:right;">
553
</td>
<td style="text-align:right;">
464
</td>
<td style="text-align:right;">
552
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
627
</td>
</tr>
<tr>
<td style="text-align:left;">
CI
</td>
<td style="text-align:right;">
357
</td>
<td style="text-align:right;">
313
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
181
</td>
<td style="text-align:right;">
247
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
265
</td>
<td style="text-align:right;">
204
</td>
<td style="text-align:right;">
361
</td>
<td style="text-align:right;">
448
</td>
<td style="text-align:right;">
569
</td>
<td style="text-align:right;">
570
</td>
<td style="text-align:right;">
356
</td>
<td style="text-align:right;">
522
</td>
</tr>
<tr>
<td style="text-align:left;">
LX
</td>
<td style="text-align:right;">
349
</td>
<td style="text-align:right;">
401
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
86
</td>
<td style="text-align:right;">
342
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
170
</td>
<td style="text-align:right;">
177
</td>
<td style="text-align:right;">
334
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
547
</td>
<td style="text-align:right;">
543
</td>
<td style="text-align:right;">
261
</td>
<td style="text-align:right;">
495
</td>
</tr>
<tr>
<td style="text-align:left;">
KV
</td>
<td style="text-align:right;">
519
</td>
<td style="text-align:right;">
571
</td>
<td style="text-align:right;">
370
</td>
<td style="text-align:right;">
256
</td>
<td style="text-align:right;">
512
</td>
<td style="text-align:right;">
370
</td>
<td style="text-align:right;">
265
</td>
<td style="text-align:right;">
170
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
347
</td>
<td style="text-align:right;">
504
</td>
<td style="text-align:right;">
299
</td>
<td style="text-align:right;">
717
</td>
<td style="text-align:right;">
615
</td>
<td style="text-align:right;">
431
</td>
<td style="text-align:right;">
504
</td>
</tr>
<tr>
<td style="text-align:left;">
CN
</td>
<td style="text-align:right;">
526
</td>
<td style="text-align:right;">
517
</td>
<td style="text-align:right;">
316
</td>
<td style="text-align:right;">
263
</td>
<td style="text-align:right;">
251
</td>
<td style="text-align:right;">
309
</td>
<td style="text-align:right;">
204
</td>
<td style="text-align:right;">
177
</td>
<td style="text-align:right;">
347
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
244
</td>
<td style="text-align:right;">
370
</td>
<td style="text-align:right;">
366
</td>
<td style="text-align:right;">
438
</td>
<td style="text-align:right;">
318
</td>
</tr>
<tr>
<td style="text-align:left;">
MT
</td>
<td style="text-align:right;">
683
</td>
<td style="text-align:right;">
563
</td>
<td style="text-align:right;">
473
</td>
<td style="text-align:right;">
420
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
343
</td>
<td style="text-align:right;">
361
</td>
<td style="text-align:right;">
334
</td>
<td style="text-align:right;">
504
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
401
</td>
<td style="text-align:right;">
213
</td>
<td style="text-align:right;">
209
</td>
<td style="text-align:right;">
595
</td>
<td style="text-align:right;">
320
</td>
</tr>
<tr>
<td style="text-align:left;">
GR
</td>
<td style="text-align:right;">
770
</td>
<td style="text-align:right;">
761
</td>
<td style="text-align:right;">
560
</td>
<td style="text-align:right;">
507
</td>
<td style="text-align:right;">
495
</td>
<td style="text-align:right;">
553
</td>
<td style="text-align:right;">
448
</td>
<td style="text-align:right;">
421
</td>
<td style="text-align:right;">
299
</td>
<td style="text-align:right;">
244
</td>
<td style="text-align:right;">
401
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
436
</td>
<td style="text-align:right;">
316
</td>
<td style="text-align:right;">
682
</td>
<td style="text-align:right;">
205
</td>
</tr>
<tr>
<td style="text-align:left;">
HB
</td>
<td style="text-align:right;">
885
</td>
<td style="text-align:right;">
684
</td>
<td style="text-align:right;">
640
</td>
<td style="text-align:right;">
633
</td>
<td style="text-align:right;">
322
</td>
<td style="text-align:right;">
464
</td>
<td style="text-align:right;">
569
</td>
<td style="text-align:right;">
547
</td>
<td style="text-align:right;">
717
</td>
<td style="text-align:right;">
370
</td>
<td style="text-align:right;">
213
</td>
<td style="text-align:right;">
436
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
808
</td>
<td style="text-align:right;">
231
</td>
</tr>
<tr>
<td style="text-align:left;">
WA
</td>
<td style="text-align:right;">
892
</td>
<td style="text-align:right;">
772
</td>
<td style="text-align:right;">
682
</td>
<td style="text-align:right;">
629
</td>
<td style="text-align:right;">
410
</td>
<td style="text-align:right;">
552
</td>
<td style="text-align:right;">
570
</td>
<td style="text-align:right;">
543
</td>
<td style="text-align:right;">
615
</td>
<td style="text-align:right;">
366
</td>
<td style="text-align:right;">
209
</td>
<td style="text-align:right;">
316
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
804
</td>
<td style="text-align:right;">
111
</td>
</tr>
<tr>
<td style="text-align:left;">
NV
</td>
<td style="text-align:right;">
312
</td>
<td style="text-align:right;">
490
</td>
<td style="text-align:right;">
289
</td>
<td style="text-align:right;">
175
</td>
<td style="text-align:right;">
603
</td>
<td style="text-align:right;">
461
</td>
<td style="text-align:right;">
356
</td>
<td style="text-align:right;">
261
</td>
<td style="text-align:right;">
431
</td>
<td style="text-align:right;">
438
</td>
<td style="text-align:right;">
595
</td>
<td style="text-align:right;">
682
</td>
<td style="text-align:right;">
808
</td>
<td style="text-align:right;">
804
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
756
</td>
</tr>
<tr>
<td style="text-align:left;">
RI
</td>
<td style="text-align:right;">
844
</td>
<td style="text-align:right;">
835
</td>
<td style="text-align:right;">
634
</td>
<td style="text-align:right;">
581
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
627
</td>
<td style="text-align:right;">
522
</td>
<td style="text-align:right;">
495
</td>
<td style="text-align:right;">
504
</td>
<td style="text-align:right;">
318
</td>
<td style="text-align:right;">
320
</td>
<td style="text-align:right;">
205
</td>
<td style="text-align:right;">
231
</td>
<td style="text-align:right;">
111
</td>
<td style="text-align:right;">
756
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<div id="dijkstras-algorithm" class="section level5" number="1.3.1.1.1">
<h5><span class="header-section-number">1.3.1.1.1</span> Dijkstra’s Algorithm</h5>
<ul>
<li><p>Inputs:
n Connected graph with nodes and arcs with positive costs, d(ij)
n Source (s) and Terminal (t) nodes</p></li>
<li><p>Algorithm:</p></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>for all nodes in graph, set L()=∞, P()=Null, S()=0</p></li>
<li><p>set s to i, S(i)=1, and L(i)=0</p></li>
<li><p>For all nodes, j, directly connected (adjacent) to node i, if L(j) &gt; L(i) + d(ij), then set L(j) = L(i) + d(ij) and P(j)=i</p></li>
<li><p>For all nodes where S()=0, select the node with lowest L() and set it to i, set S(i)=1</p></li>
<li><p>Is this node t, the terminal node? If so, go to end
If not, go to step 3</p></li>
<li><p>end – return L(t)</p></li>
</ol>
<p>The shortest_path and shortest.path function already solves it by default with dijkstra’s model when the weights have only positive values.</p>
<p>But let’s mimic the algorithm and try to get the results.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="ctlsc0x-supply-chain-analytics.html#cb209-1" aria-hidden="true" tabindex="-1"></a>Djikstraz <span class="ot">&lt;-</span> <span class="cf">function</span>(net, source, terminal){</span>
<span id="cb209-2"><a href="ctlsc0x-supply-chain-analytics.html#cb209-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-3"><a href="ctlsc0x-supply-chain-analytics.html#cb209-3" aria-hidden="true" tabindex="-1"></a>source <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb209-4"><a href="ctlsc0x-supply-chain-analytics.html#cb209-4" aria-hidden="true" tabindex="-1"></a>terminal <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb209-5"><a href="ctlsc0x-supply-chain-analytics.html#cb209-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb209-6"><a href="ctlsc0x-supply-chain-analytics.html#cb209-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(net, <span class="at">attr=</span><span class="st">&quot;weight&quot;</span>))</span>
<span id="cb209-7"><a href="ctlsc0x-supply-chain-analytics.html#cb209-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-8"><a href="ctlsc0x-supply-chain-analytics.html#cb209-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(data)</span>
<span id="cb209-9"><a href="ctlsc0x-supply-chain-analytics.html#cb209-9" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="dv">10000000</span> </span>
<span id="cb209-10"><a href="ctlsc0x-supply-chain-analytics.html#cb209-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-11"><a href="ctlsc0x-supply-chain-analytics.html#cb209-11" aria-hidden="true" tabindex="-1"></a>iMin <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb209-12"><a href="ctlsc0x-supply-chain-analytics.html#cb209-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-13"><a href="ctlsc0x-supply-chain-analytics.html#cb209-13" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data, <span class="at">L =</span> M)</span>
<span id="cb209-14"><a href="ctlsc0x-supply-chain-analytics.html#cb209-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data, <span class="at">P =</span> <span class="dv">0</span>)</span>
<span id="cb209-15"><a href="ctlsc0x-supply-chain-analytics.html#cb209-15" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data, <span class="at">S =</span> <span class="dv">0</span>)</span>
<span id="cb209-16"><a href="ctlsc0x-supply-chain-analytics.html#cb209-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-17"><a href="ctlsc0x-supply-chain-analytics.html#cb209-17" aria-hidden="true" tabindex="-1"></a>data[source, <span class="st">&quot;S&quot;</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb209-18"><a href="ctlsc0x-supply-chain-analytics.html#cb209-18" aria-hidden="true" tabindex="-1"></a>data[source, <span class="st">&quot;L&quot;</span>] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb209-19"><a href="ctlsc0x-supply-chain-analytics.html#cb209-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-20"><a href="ctlsc0x-supply-chain-analytics.html#cb209-20" aria-hidden="true" tabindex="-1"></a>i <span class="ot">=</span> source</span>
<span id="cb209-21"><a href="ctlsc0x-supply-chain-analytics.html#cb209-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-22"><a href="ctlsc0x-supply-chain-analytics.html#cb209-22" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (i <span class="sc">!=</span> terminal) {</span>
<span id="cb209-23"><a href="ctlsc0x-supply-chain-analytics.html#cb209-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(i,terminal)</span>
<span id="cb209-24"><a href="ctlsc0x-supply-chain-analytics.html#cb209-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb209-25"><a href="ctlsc0x-supply-chain-analytics.html#cb209-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;j = &quot;</span>,j))</span>
<span id="cb209-26"><a href="ctlsc0x-supply-chain-analytics.html#cb209-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (data[j, <span class="st">&quot;L&quot;</span>] <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb209-27"><a href="ctlsc0x-supply-chain-analytics.html#cb209-27" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (data[j, <span class="st">&quot;L&quot;</span>] <span class="sc">==</span> data[i, <span class="st">&quot;L&quot;</span>] <span class="sc">+</span> data[i, j]) {</span>
<span id="cb209-28"><a href="ctlsc0x-supply-chain-analytics.html#cb209-28" aria-hidden="true" tabindex="-1"></a>              data[j, <span class="st">&quot;L&quot;</span>] <span class="ot">&lt;-</span> data[i, <span class="st">&quot;L&quot;</span>] <span class="sc">+</span> data[i, j]</span>
<span id="cb209-29"><a href="ctlsc0x-supply-chain-analytics.html#cb209-29" aria-hidden="true" tabindex="-1"></a>              data[j, <span class="st">&quot;P&quot;</span>] <span class="ot">&lt;-</span> i</span>
<span id="cb209-30"><a href="ctlsc0x-supply-chain-analytics.html#cb209-30" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb209-31"><a href="ctlsc0x-supply-chain-analytics.html#cb209-31" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb209-32"><a href="ctlsc0x-supply-chain-analytics.html#cb209-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb209-33"><a href="ctlsc0x-supply-chain-analytics.html#cb209-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb209-34"><a href="ctlsc0x-supply-chain-analytics.html#cb209-34" aria-hidden="true" tabindex="-1"></a>  Min <span class="ot">&lt;-</span> M</span>
<span id="cb209-35"><a href="ctlsc0x-supply-chain-analytics.html#cb209-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb209-36"><a href="ctlsc0x-supply-chain-analytics.html#cb209-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb209-37"><a href="ctlsc0x-supply-chain-analytics.html#cb209-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (data[i, <span class="st">&quot;S&quot;</span>] <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb209-38"><a href="ctlsc0x-supply-chain-analytics.html#cb209-38" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (data[i, <span class="st">&quot;L&quot;</span>] <span class="sc">&lt;</span> Min) {</span>
<span id="cb209-39"><a href="ctlsc0x-supply-chain-analytics.html#cb209-39" aria-hidden="true" tabindex="-1"></a>        Min <span class="ot">&lt;-</span> data[i, <span class="st">&quot;L&quot;</span>]</span>
<span id="cb209-40"><a href="ctlsc0x-supply-chain-analytics.html#cb209-40" aria-hidden="true" tabindex="-1"></a>        iMin <span class="ot">&lt;-</span> i</span>
<span id="cb209-41"><a href="ctlsc0x-supply-chain-analytics.html#cb209-41" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb209-42"><a href="ctlsc0x-supply-chain-analytics.html#cb209-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb209-43"><a href="ctlsc0x-supply-chain-analytics.html#cb209-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb209-44"><a href="ctlsc0x-supply-chain-analytics.html#cb209-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb209-45"><a href="ctlsc0x-supply-chain-analytics.html#cb209-45" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> iMin</span>
<span id="cb209-46"><a href="ctlsc0x-supply-chain-analytics.html#cb209-46" aria-hidden="true" tabindex="-1"></a>  data[i, <span class="st">&quot;S&quot;</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb209-47"><a href="ctlsc0x-supply-chain-analytics.html#cb209-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-48"><a href="ctlsc0x-supply-chain-analytics.html#cb209-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb209-49"><a href="ctlsc0x-supply-chain-analytics.html#cb209-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-50"><a href="ctlsc0x-supply-chain-analytics.html#cb209-50" aria-hidden="true" tabindex="-1"></a>data</span>
<span id="cb209-51"><a href="ctlsc0x-supply-chain-analytics.html#cb209-51" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="lp" class="section level5" number="1.3.1.1.2">
<h5><span class="header-section-number">1.3.1.1.2</span> LP</h5>
<p>$$
<span class="math display">\[\begin{align*}

\textbf{Minimize} &amp; \ z = \sum_{i=1}^{N} \sum_{j=1}^{M} c_{i,j} \cdot x_{i,j} \\
                          
\textbf{subject to} \\
    &amp; \sum_{i=1}^{N} \sum_{j=1}^{M} x_{i,j} - x_{j,i} = 0, \ \forall j \neq s, \ j \neq t \\
    &amp; \sum_{i=1}^{N} x_{i,j} = 1, \ \forall j = t \\
    &amp; \sum_{i=1}^{N} x_{j,i} = 1 \  \forall j = s \\
    &amp; x_{i} \ge 0 \\
    
\textbf{Where} \\

&amp; x_{i,j} = \text{Number of units flowing on nodes} \\
&amp; c_{i,j} = \text{Cost per unit for flow} \\
&amp; s = \text{Source node} \\
&amp; t = \text{Terminal node}
\end{align*}\]</span>
$$</p>
</div>
</div>
<div id="traveling-salesman-problem" class="section level4" number="1.3.1.2">
<h4><span class="header-section-number">1.3.1.2</span> Traveling Salesman Problem</h4>
<div id="nearest-neighbor" class="section level5" number="1.3.1.2.1">
<h5><span class="header-section-number">1.3.1.2.1</span> Nearest Neighbor</h5>
</div>
<div id="opt" class="section level5" number="1.3.1.2.2">
<h5><span class="header-section-number">1.3.1.2.2</span> 2-opt</h5>
</div>
</div>
<div id="vehicle-routing-problem" class="section level4" number="1.3.1.3">
<h4><span class="header-section-number">1.3.1.3</span> Vehicle Routing Problem</h4>
<div id="sweep-heuristic" class="section level5" number="1.3.1.3.1">
<h5><span class="header-section-number">1.3.1.3.1</span> Sweep Heuristic</h5>
</div>
<div id="clark-wright" class="section level5" number="1.3.1.3.2">
<h5><span class="header-section-number">1.3.1.3.2</span> Clark-Wright</h5>
<p>Cool way to create the clusters based on the distance weights, clustering based on the lowest interconnected nodes distance. This is cool because we don’t have to define the number of clusters, it will define it by the distance parameter</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="ctlsc0x-supply-chain-analytics.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="do">## edge betweenness</span></span>
<span id="cb210-2"><a href="ctlsc0x-supply-chain-analytics.html#cb210-2" aria-hidden="true" tabindex="-1"></a>ceb <span class="ot">&lt;-</span> <span class="fu">cluster_edge_betweenness</span>(net, <span class="at">weights =</span> Relations<span class="sc">$</span>weight)</span>
<span id="cb210-3"><a href="ctlsc0x-supply-chain-analytics.html#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="ctlsc0x-supply-chain-analytics.html#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Dendogram</span></span>
<span id="cb210-5"><a href="ctlsc0x-supply-chain-analytics.html#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dendPlot</span>(ceb, <span class="at">mode=</span><span class="st">&quot;hclust&quot;</span>)</span></code></pre></div>
<p><img src="01-CTLSC0x_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="ctlsc0x-supply-chain-analytics.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Graph Plot</span></span>
<span id="cb211-2"><a href="ctlsc0x-supply-chain-analytics.html#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ceb, net, <span class="at">main =</span> <span class="st">&quot;CLusters&quot;</span>) </span></code></pre></div>
<p><img src="01-CTLSC0x_files/figure-html/unnamed-chunk-75-2.png" width="672" /></p>
</div>
<div id="milp" class="section level5" number="1.3.1.3.3">
<h5><span class="header-section-number">1.3.1.3.3</span> MILP</h5>

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
